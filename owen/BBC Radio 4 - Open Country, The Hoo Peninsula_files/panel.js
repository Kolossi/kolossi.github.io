var onAirPanel=onAirPanel||{};onAirPanel.initalised=false;onAirPanel.isScrolling=false;onAirPanel.isTabletDevice=false;onAirPanel.updateUrl="";onAirPanel.updateErrorCount=0;onAirPanel.requestTimeout=10000;onAirPanel.minInterval=30000;onAirPanel.maxInterval=40000;onAirPanel.panelFlagStatus="GREEN";onAirPanel.panelFlagOrangeModifier=2;onAirPanel.state="normal";onAirPanel.sid="";onAirPanel.pid="";onAirPanel.dataType="jsonp";onAirPanel.popup={};onAirPanel.popup.watch={};onAirPanel.popup.watch.height="705";onAirPanel.popup.watch.width="679";onAirPanel.popup.watch.popName="radioconsole";onAirPanel.popup.watch.url="";onAirPanel.popup.listen={};onAirPanel.popup.listen.height="666";onAirPanel.popup.listen.width="382";onAirPanel.popup.listen.popName="UKRadioPlayerPopup";onAirPanel.popup.listen.url="";onAirPanel.init=function(a){if(typeof a==="undefined"){a=0}if(typeof window.require==="function"){window.require(["jquery-1.9","istats-1"],function(c,b){c(function(){onAirPanel.jQuery=c;onAirPanel.istats=b;onAirPanel.setup()})})}else{if(a<10){setTimeout(function(){onAirPanel.init(++a)},500)}return false}};onAirPanel.setup=function(){var a=onAirPanel.jQuery("#programmes-oap-now a").attr("href");onAirPanel.pid=a.substr(a.lastIndexOf("/")+1);onAirPanel.popup.watch.url=onAirPanel.jQuery("#programmes-oap-watch").attr("href");onAirPanel.popup.listen.url=onAirPanel.jQuery("#programmes-oap-listen").attr("href");onAirPanel.jQuery("#programmes-oap-listen").unbind("click").bind("click",function(b){b.preventDefault();onAirPanel.istats.log("click","oap_listen_link",{sid:onAirPanel.sid,pid:onAirPanel.pid});if(onAirPanel.state!=="offair"){onAirPanel.popupWindow(b,onAirPanel.popup.listen)}});onAirPanel.jQuery("#programmes-oap-watch").unbind("click").bind("click",function(b){b.preventDefault();if(onAirPanel.state!=="offair"){onAirPanel.popupWindow(b,onAirPanel.popup.watch)}});onAirPanel.istats.track("internal",{region:onAirPanel.jQuery("#programmes-oap-now"),linkLocation:"oap_current_episode_link"});onAirPanel.update();onAirPanel.scroll();onAirPanel.initalised=true};onAirPanel.update=function(){if(onAirPanel.updateUrl!==""){var a={};if(onAirPanel.isTabletDevice){a={is_tablet:onAirPanel.isTabletDevice}}onAirPanel.jQuery.ajax({cache:true,jsonp:false,ifModified:true,url:onAirPanel.updateUrl,data:a,dataType:onAirPanel.dataType,timeout:onAirPanel.requestTimeout,jsonpCallback:"onairpanelCallback",contentType:"application/javascript; charset=UTF-8"}).fail(function(b,d,c){onAirPanel.updateError()}).done(function(b){onAirPanel.updateCallback(b)})}};onAirPanel.updateCallback=function(a){if(a&&a.hasOwnProperty("html")){onAirPanel.panelFlagStatus=(a.hasOwnProperty("flag"))?a.flag:onAirPanel.panelFlagStatus;onAirPanel.state=(a.hasOwnProperty("state"))?a.state:onAirPanel.state;onAirPanel.sid=(a.hasOwnProperty("sid"))?a.sid:onAirPanel.sid;response=onAirPanel.jQuery.trim(a.html);if(onAirPanel.jQuery("#programmes-oap-listen").html()!==onAirPanel.jQuery("#programmes-oap-listen",response).html()){onAirPanel.jQuery("#programmes-oap-listen").html(onAirPanel.jQuery("#programmes-oap-listen",response).html());onAirPanel.jQuery("#programmes-oap-listen").attr("title",onAirPanel.jQuery("#programmes-oap-listen",response).attr("title"));onAirPanel.jQuery("#programmes-oap-listen").attr("href",onAirPanel.jQuery("#programmes-oap-listen",response).attr("href"));if(onAirPanel.state==="offair"){onAirPanel.jQuery("#programmes-oap-listen").addClass("fade");onAirPanel.jQuery("#programmes-oap-watch").addClass("fade")}else{onAirPanel.jQuery("#programmes-oap-listen").removeClass("fade");onAirPanel.jQuery("#programmes-oap-watch").removeClass("fade")}}if(onAirPanel.jQuery("#programmes-oap-now").html()!==onAirPanel.jQuery("#programmes-oap-now",response).html()){onAirPanel.jQuery("#programmes-oap-now").html(onAirPanel.jQuery("#programmes-oap-now",response).html());onAirPanel.jQuery("#programmes-oap-now").attr("title",onAirPanel.jQuery("#programmes-oap-now",response).attr("title"))}if(onAirPanel.jQuery("#programmes-oap-info-scroll").html()!==onAirPanel.jQuery("#programmes-oap-info-scroll",response).html()){onAirPanel.jQuery("#programmes-oap-info-scroll").html(onAirPanel.jQuery("#programmes-oap-info-scroll",response).html());onAirPanel.jQuery("#programmes-oap-info").attr("title",onAirPanel.jQuery("#programmes-oap-info",response).attr("title"));if(onAirPanel.isScrolling===false){onAirPanel.scroll()}}onAirPanel.updateErrorCount=0;if(onAirPanel.panelFlagStatus!=="RED"){setTimeout(onAirPanel.update,onAirPanel.getNextInterval())}}else{onAirPanel.updateError()}};onAirPanel.scroll=function(){if(onAirPanel.jQuery("#programmes-oap-info-scroll").width()>onAirPanel.jQuery("#programmes-oap-info").width()){onAirPanel.isScrolling=true;onAirPanel.jQuery("#programmes-oap-info-scroll").css("left",260+"px");var a={left:(-onAirPanel.jQuery("#programmes-oap-info-scroll").width())+"px"};onAirPanel.jQuery("#programmes-oap-info-scroll").animate(a,15000,"linear",function(){onAirPanel.jQuery("#programmes-oap-info-scroll").css("left","0px");setTimeout(onAirPanel.scroll,3000)})}else{onAirPanel.isScrolling=false}};onAirPanel.getNextInterval=function(){var a=(Math.floor(Math.random()*(onAirPanel.maxInterval-onAirPanel.minInterval+1))+onAirPanel.minInterval);if(onAirPanel.panelFlagStatus==="ORANGE"){a=a*onAirPanel.panelFlagOrangeModifier}return a};onAirPanel.updateError=function(){if(++onAirPanel.updateErrorCount<5){setTimeout(onAirPanel.update,(onAirPanel.getNextInterval()*onAirPanel.updateErrorCount))}};onAirPanel.popupWindow=function(c,b){if(c.preventDefault){c.preventDefault()}else{if(c.returnValue){c.returnValue=false}}var a="width="+b.width+",height="+b.height+",scrollbars=no,toolbar=no,personalbar=no,location=no,directories=no,menubar=no,status=no,resizable=no",d=null;d=window.open(b.url,b.popName,a);if(d){d.focus();return false}return true};onAirPanel.init();