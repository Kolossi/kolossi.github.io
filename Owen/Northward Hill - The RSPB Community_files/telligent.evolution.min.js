(function(b,m,h){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.administrationToolbar={get:function(){var g;g=b(".admin-bar");0<g.length||(g=b("form"),1<g.length&&(g=b("body")),g.prepend(b('<div class="admin-bar-header"></div><div class="admin-bar site"></div><div class="admin-bar-footer"></div>')),g=b(".admin-bar"));return g}}})(jQuery,window);
(function(b){var m=function(c){c.toggle=b("<a></a>").attr({href:"#"});c.element.append(c.toggle);c.toggle.evolutionToggleLink({onHtml:"<span></span>"+b.telligent.evolution.html.encode(h(c,c.settings.deleteBookmarkText)),offHtml:"<span></span>"+b.telligent.evolution.html.encode(h(c,c.settings.addBookmarkText)),processingHtml:"<span></span>"+b.telligent.evolution.html.encode(h(c,c.settings.processingText)),changeState:function(a){f(a,c)},onTitle:h(c,c.settings.deleteBookmarkText),offTitle:h(c,c.settings.addBookmarkText),
processingTitle:h(c,c.settings.processingText),onCssClass:c.settings.deleteBookmarkCssClass,offCssClass:c.settings.addBookmarkCssClass,processingCssClass:c.settings.processingCssClass,val:c.settings.initialState})},h=function(c,a){return a.replace(/\{content_type_name\}/gi,c.settings.contentTypeName)},g=function(c,a){b.telligent.evolution.messaging.publish("ui.bookmark",{contentId:c.settings.contentId,contentTypeId:c.settings.contentTypeId,typeId:c.settings.typeId,bookmarked:a})},f=function(c,a){if(c)a.settings.onBookmark(a.settings.contentId,
a.settings.contentTypeId,a.settings.typeId,function(){g(a,!0)});else a.settings.onUnbookmark(a.settings.contentId,a.settings.contentTypeId,a.settings.typeId,function(){g(a,!1)})},k=function(c){b.telligent.evolution.messaging.subscribe("ui.bookmark",function(a){a.contentId===c.settings.contentId&&a.contentTypeId===c.settings.contentTypeId&&a.typeId===c.settings.typeId&&c.toggle&&c.toggle.evolutionToggleLink("val",a.bookmarked)})};b.fn.evolutionBookmark=function(c){var a=b.extend({},b.fn.evolutionBookmark.defaults,
c||{});return this.each(function(){var d={element:b(this),toggle:null,settings:a};m(d);k(d)})};b.fn.evolutionBookmark.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,contentTypeName:"",onBookmark:function(c,a,d,e){},onUnbookmark:function(c,a,d,e){},deleteBookmarkText:"Unbookmark {content_type_name}",addBookmarkText:"Bookmark this {content_type_name}",processingText:"...",addBookmarkCssClass:"internal-link favorite-off",deleteBookmarkCssClass:"internal-link favorite-on",processingCssClass:"internal-link processing"}})(jQuery);
(function(b){var m=!b.browser.msie&&"oninput"in document.createElement("input")&&"oninput"in document.createElement("textarea");b.event.special.textinput={setup:function(){var h=b(this);if(m)h.bind("input",function(b){h.trigger("textinput",{which:b.which})});else{var g;h.bind({keydown:function(b){g=h.val()},keyup:function(b){var k=h.val();k!==g&&h.trigger("textinput",{which:b.which});g=k}})}}}})(jQuery);
(function(b){var m=function(a,d){a=b(a);var e=a.data("__COMPOSER_CONTEXT");!e&&d&&(e=h(a,d),a.data("__COMPOSER_CONTEXT",e));return e},h=function(a,d){var e=b.extend({},b.fn.evolutionComposer.defaults,d||{}),e={input:a,settings:e,plugins:b.map(e.plugins,function(a){return"string"==typeof a?b.fn.evolutionComposer.plugins[a]:a}),ranges:[],activePlugin:!1};e.pluginContext=g(e);e.input.evolutionHighlight();f(e);return e},g=function(a){return{settings:a.settings,input:a.input,data:function(d,e){return"undefined"!==
typeof e?a.input.data(d,e):a.input.data(d)},val:function(d){return"undefined"!==typeof d?a.input.val(d):a.input.val()},release:function(){a.activePlugin.onDeactivate&&a.activePlugin.onDeactivate.call(a.input,a.pluginContext);a.activePlugin=!1},caretPosition:function(){return n(a.input)},currentWord:function(l){l=b.extend({allowedWhiteSpaceBeforeCaret:0,allowedWhiteSpaceAfterCaret:0},l||{});var c=l.caretPosition||n(a.input),k="",r=b(a.input).val(),f="",g=0,h=c,m=0;if(c<r.length&&"\n"!==r[c]&&"\t"!==
r[c]){f=r.substring(c);g=d(f);0>g&&(g=f.indexOf("\n"));0>g&&(g=f.indexOf("\t"));0>g&&(g=f.length);for(m=0;m<l.allowedWhiteSpaceAfterCaret;m++)if(0<g){var u=r.substring(c+g+1);nextWhiteSpaceIndex=d(u);nextWhiteSpaceIndex=-1===nextWhiteSpaceIndex?u.length:nextWhiteSpaceIndex;if(0<nextWhiteSpaceIndex)g+=nextWhiteSpaceIndex+1;else break}0<g&&(h=0,k+=f.substring(0,g))}if(0<c&&"\n"!==r[c-1]&&"\t"!==r[c-1]){f=r.substring(0,c);g=e(f);for(m=0;m<l.allowedWhiteSpaceBeforeCaret;m++)if(0<g)if(c=e(r.substring(0,
g)),c!==g)g=c;else break;g===f.length&&(g=f.lastIndexOf("\n"));g===f.length&&(g=f.lastIndexOf("\t"));g===f.length&&(g=f.length-1);g<f.length-1&&(h=g+1,k=f.substring(h)+k)}return{value:k,start:h,stop:h+k.length}},replace:function(d,e,l){var c=a.input.val();a.input.val(c.substring(0,d)+l+c.substring(e))},clearHighlights:function(d){var e=[];b.each(a.ranges,function(a,l){d&&l.className===d||e.push(l)});a.ranges=e;a.input.evolutionHighlight({ranges:a.ranges})},addHighlight:function(d){a.ranges.push(d)},
renderHighlights:function(){a.input.evolutionHighlight({ranges:a.ranges})}}},f=function(d){d.input.bind({keypress:function(a){k(d,"onkeypress",a)},keydown:function(a){k(d,"onkeydown",a)},textinput:function(e){c(d,e);k(d,"oninput",e);a(d)}})},k=function(a,d,e){var l=!0;a.activePlugin&&a.activePlugin[d]&&(l=a.activePlugin[d].call(e.target,a.pluginContext,e));l?a[d]&&((l=a[d].call(e.target,e))||e.preventDefault()):e.preventDefault()},c=function(a,d){a.activePlugin||b.each(a.plugins,function(d,e){if(e.shouldActivate&&
!0===e.shouldActivate.call(a.input,a.pluginContext))return a.activePlugin=e,e.onActivate&&e.onActivate.call(a.input,a.pluginContext),!1})},a=function(a){b.each(a.plugins,function(d,e){e.onTransform&&e.onTransform.call(a.input,a.pluginContext)})},d=function(a){var d=[];b.each([" ","\t","\n"],function(e,l){var c=a.indexOf(l);0<=c&&d.push(c)});d.sort();return 0<d.length?d[0]:-1},e=function(a){var d=[];b.each([" ","\t","\n"],function(e,l){var c=a.lastIndexOf(l);0<=c&&d.push(c)});d.sort();return 0<d.length?
d[d.length-1]:-1},n=function(a){a=a.get(0);if(a.selectionStart)return a.selectionStart;if(document.selection){var d=document.selection.createRange();if(null===d)return 0;a=a.createTextRange();var e=a.duplicate();a.moveToBookmark(d.getBookmark());e.setEndPoint("EndToStart",a);return e.text.length}return 0},l=function(a){"undefined"!==typeof b.fn.evolutionResize&&a.input.evolutionResize().bind("evolutionResize",function(){a.input.evolutionHighlight("resize",a.input.width(),a.input.height())})},r={init:function(a){return this.filter("textarea").each(function(){var d=
b(this),e=m(d,a);l(e);null!==e&&b.each(e.plugins,function(a,l){l.init&&l.init.call(d,e.pluginContext)});setTimeout(function(){d.focus()},10)})},val:function(d){if("undefined"!==typeof d){var e=m(this);e&&(e.input.val(d),a(e))}else{var e=m(this),l="";e&&(l=e.input.val(),b.each(e.plugins,function(a,d){d.val&&(l=d.val.call(e.input,l,e.pluginContext))}));return l}return this},onkeydown:function(a){var d=m(this);d&&(d.onkeydown=a);return this},oninput:function(a){var d=m(this);d&&(d.oninput=a);return this},
resize:function(a,d){var e=m(this);e&&e.input.evolutionHighlight("resize",a,d);return this}};b.fn.evolutionComposer=function(a){if(r[a])return r[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.evolutionComposer");else return r.init.apply(this,arguments)};b.fn.evolutionComposer.defaults={plugins:[]};b.fn.evolutionComposer.plugins={}})(jQuery);
(function(b,m){var h=function(){for(var f=null,k={},c=function(a){var d=a.data("_tagged_tags");if("undefined"===typeof d||null===d)d=[],a.data("_tagged_tags",d);return d},a=function(a,e,l,n,b){var k=c(a);k[k.length]=e;if(l){var r=a.currentWord();a.replace(r.start,r.stop+1,e.decodedName+(n?" ":""))}e=r.start+(e.decodedName+(n?" ":"")).length;l=a.input.get(0);l.setSelectionRange?l.setSelectionRange(e,e):l.createTextRange&&(l=l.createTextRange(),l.collapse(!0),l.moveEnd("character",e),l.moveStart("character",
e),l.select());d(a);a.data("_hashtag_composer_active",!1);g.hide();a.input.focus();b&&a.release()},d=function(a){var d=c(a).reverse(),e=a.val();a.clearHighlights(a.settings.highlightClass||n);var l={};b.each(d,function(c,b){if(b&&null!==b.decodedName&&0<b.decodedName.length){var k=e.indexOf(b.decodedName);if(0>k||l[k])d.splice(c,1);else for(;0<=k;)a.addHighlight({start:k,stop:b.decodedName.length+k,className:a.settings.highlightClass||n}),l[k]=!0,k=e.indexOf(b.decodedName,k+1)}});a.renderHighlights()},
e=function(a){return 2<a.length&&0===a.indexOf("#")&&!f.test(a.substr(1))&&isNaN(parseInt(a[1],10))},n="composer-hashtag-highlight",l=function(){},r=null,f=RegExp("["+"-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".replace("]","\\]")+"]","i"),H=0;33>H;H++)k["-_~`!@#$%^&*()=+{[}]\\|;:'\",<.>/? ".charCodeAt(H)]=!0;return{init:function(d){l=d.settings.onTagList||b.fn.evolutionComposer.plugins.hashtags.defaults.onTagList;d.input.bind(g.selectedEventName,function(){a(d,g.selection(),!0,!0,!0)});d.input.bind("blur",
function(){setTimeout(function(){d.release()},500)})},onTransform:function(a){d(a)},shouldActivate:function(a){return e(a.currentWord().value)},onActivate:function(a){a.data("_hashtag_composer_active",!0);b(document).bind("click.ui-composer-hashtags",function(){a.release();b(document).unbind(".ui-composer-hashtags")})},onDeactivate:function(d){var l=d.currentWord();e(l.value)&&a(d,{decodedName:l.value,name:l.value,token:"[tag:"+l.value.substr(1)+"]"},!0,!1,!1);d.data("_hashtag_composer_active",!1);
g.hide();d.input.focus()},val:function(a,d){var e=c(d);b.each(e,function(d,e){a=a.replace(RegExp(b.telligent.evolution.regex.encode(e.decodedName),"g"),e.token)});return a},onkeydown:function(d,e){if(27===e.which||32===e.which)d.release();else if(13===e.which||9===e.which){var l=g.selection();if(l)return a(d,l,!0,!0,!0),!1;d.release()}else{if(38===e.which)return g.moveHighlightUp(),!1;if(40===e.which)return g.moveHighlightDown(),!1}return!0},onkeypress:function(a,d){"undefined"!==typeof k[d.which]&&
a.release();return!0},oninput:function(a,d){if(!e(a.currentWord().value))return a.release(),!0;clearTimeout(r);g.loading(a.input);r=setTimeout(function(){var d=a.currentWord().value;e(d)?2<=d.length&&l(d.substr(1),function(l){if(a.data("_hashtag_composer_active")){l&&(l=b.map(l,function(a){return{name:a.name,token:a.token,decodedName:b.telligent.evolution.html.decode(a.name)}}));var c=a.currentWord().value;c==d&&e(c)&&null!==l&&0<l.length?g.show(a.input,l,d):g.hide()}}):a.release()},500);return!0}}}(),
g=function(){var f=null,k=null,c=null,a=function(a){k=a;if(null===f){f=b('<ul class="composer-hashtag-selector"></ul>').hide().appendTo(b("body"));c=b('<li class="loading">...</li>');var d=0,r=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){d+=1;3===d&&(d=0);c.get(0).innerHTML=r[d]},175);f.delegate("li","click",function(a){null!==k&&(f.find("li.highlight").removeClass("highlight"),b(this).addClass("highlight"),
k.trigger(e.selectedEventName))})}},d=function(){if(null!==k){var a=k.offset(),d=b(k);f.css({width:d.outerWidth()-2,top:a.top+d.outerHeight()-1,left:a.left})}},e={selectedEventName:"HASHTAG_SELECTED",show:function(e,l,c){a(e);d();f.hide().empty();var k=RegExp(b.telligent.evolution.regex.encode(b.telligent.evolution.html.encode(c)),"i");b.each(l,function(a,d){var e=d.name.match(k),e=null!==e?b("<li>"+d.name.replace(k,"<strong>"+e[0]+"</strong>")+"</li>"):b("<li>"+d.name+"</li>");e.data("tagData",d);
f.append(e)});f.show()},hide:function(){null!==f&&f.hide().empty()},loading:function(e){a(e);d();f.hide().empty().append(c).show()},moveHighlightUp:function(){var a=f.find("li");if(0!==a.length){var d=a.length;b.each(a,function(a,e){b(e).hasClass("highlight")&&(d=a,b(e).removeClass("highlight"))});0>d-1&&(d=a.length);b(a.get(d-1)).addClass("highlight")}},moveHighlightDown:function(){var a=f.find("li");if(0!==a.length){var d=-1;b.each(a,function(a,e){b(e).hasClass("highlight")&&(d=a,b(e).removeClass("highlight"))});
d+1>=a.length&&(d=-1);b(a.get(d+1)).addClass("highlight")}},selection:function(){var a=f.find("li");if(0===a.length)return null;var d=a.filter("li.highlight");return null!==d&&0<d.length?d.data("tagData"):b(a.get(0)).data("tagData")}};return e}();b.fn.evolutionComposer.plugins.hashtags=h;b.fn.evolutionComposer.plugins.hashtags.defaults={onTagList:function(f,k){b.telligent.evolution.get({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/hashtags.json?IncludeFields=Token,PreviewHtml",data:{QueryText:f,
PageSize:5},cache:!1,dataType:"json",success:function(c){c.HashTags&&0<c.HashTags.length?(c=b.map(c.HashTags,function(a){return{name:a.PreviewHtml,token:a.Token}}),k(c)):k(null)}})}}})(jQuery,window);
(function(b,m){var h=function(){var f={};allowedSpacesKey="_allowed_spaces";isActiveKey="_hashtag_composer_active";caretPosition=0;getMentions=function(b){var c=b.data("_mentioned_mentionables");if("undefined"===typeof c||null===c)c=[],b.data("_mentioned_mentionables",c);return c};setCursorPosition=function(b,c){var a=b.input.get(0);a.setSelectionRange?a.setSelectionRange(c,c):a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveEnd("character",c),a.moveStart("character",c),a.select())};
mentionMentionable=function(b,c){var a=getMentions(b);a[a.length]=c;b.release();a=effectiveCurrentWord(b);b.replace(a.start,a.stop+1,c.decodedName+" ");updateHighlights(b);allowedSpaces(b,0);setCursorPosition(b,a.start+(c.decodedName+" ").length)};updateHighlights=function(k){var c=getMentions(k),a=k.val();k.clearHighlights(k.settings.highlightClass||mentionHighlightClass);b.each(c,function(d,e){if(e&&null!==e.decodedName&&0<e.decodedName.length){var b=a.indexOf(e.decodedName);if(0>b)c.splice(d,1);
else for(;0<=b;)k.addHighlight({start:b,stop:e.decodedName.length+b,className:k.settings.highlightClass||mentionHighlightClass}),b=a.indexOf(e.decodedName,b+1)}});k.renderHighlights()};mentionHighlightClass="composer-mentionable-mention-highlight";getMentionables=function(){};getMentionablesTimeout=null;allowedSpaces=function(b,c){return"undefined"!==typeof c?(b.data("_allowed_spaces",c),c):b.data("_allowed_spaces")||0};effectiveCurrentWord=function(k){var c=k.val().substring(0,caretPosition),a=null;
b.each(f,function(d,n){if(null!==n&&0<n.length&&c.match("@"+b.telligent.evolution.regex.encode(d)+"$"))return a="@"+d,!1});if(null!==a){var d=c.length-a.length;allowedSpaces(k,a.split(" ").length-1);return{value:a,start:d,stop:d+a.length}}return k.currentWord({caretPosition:caretPosition,allowedWhiteSpaceBeforeCaret:allowedSpaces(k)})};return{init:function(k){getMentionables=k.settings.onMentionableList||b.fn.evolutionComposer.plugins.mentions.defaults.onMentionableList;k.input.bind(g.selectedEventName,
function(){mentionMentionable(k,g.selection())});k.input.bind({blur:function(){setTimeout(function(){k.release()},500)},keydown:function(){caretPosition=k.caretPosition()+1}})},onTransform:function(b){updateHighlights(b)},shouldActivate:function(b){return 0===effectiveCurrentWord(b).value.indexOf("@")},onActivate:function(k){k.data(isActiveKey,!0);b(document).bind("click.mentions",function(){k.release();b(document).unbind(".mentions")})},onDeactivate:function(b){b.data(isActiveKey,!1);g.hide();b.input.focus();
allowedSpaces(b,0)},val:function(k,c){var a=getMentions(c);b.each(a,function(a,e){k=k.replace(e.decodedName,e.token)});return k},onkeydown:function(b,c){if(32===c.which)allowedSpaces(b,allowedSpaces(b)+1);else{if(27===c.which)return b.release(),!1;if(13===c.which||9===c.which){var a=g.selection();a?mentionMentionable(b,a):b.release();return!1}if(38===c.which)return g.moveHighlightUp(),!1;if(40===c.which)return g.moveHighlightDown(),!1}return!0},onkeypress:function(b,c){return!0},oninput:function(k,
c){clearTimeout(getMentionablesTimeout);g.loading(k.input);getMentionablesTimeout=setTimeout(function(){var a=effectiveCurrentWord(k).value.substring(1);if(1<a.length){var d=function(d){null!==d&&0<d.length?g.show(k.input,d,a):k.release()};"undefined"!==typeof f[a]?k.data(isActiveKey)&&d(f[a]):getMentionables(a,function(e){k.data(isActiveKey)&&(e&&(e=b.map(e,function(a){return{name:a.name,token:a.token,decodedName:b.telligent.evolution.html.decode(a.name)}})),f[a]=e,effectiveCurrentWord(k).value.substring(1)==
a&&d(e))})}else k.release()},500);return!0}}}(),g=function(){var f=null,k=null,c=null,a=function(a){k=a;if(null===f){f=b('<ul class="composer-mentionable-selector"></ul>').hide().appendTo(b("body"));c=b('<li class="loading">...</li>');var d=0,r=["<strong>&bull;</strong>&bull;&bull;","&bull;<strong>&bull;</strong>&bull;","&bull;&bull;<strong>&bull;</strong>"];setInterval(function(){d+=1;3===d&&(d=0);c.get(0).innerHTML=r[d]},175);f.delegate("li","click",function(a){null!==k&&(f.find("li.highlight").removeClass("highlight"),
b(this).addClass("highlight"),k.trigger(e.selectedEventName))})}},d=function(){if(null!==k){var a=k.offset(),d=b(k);f.css({width:d.outerWidth()-2,top:a.top+d.outerHeight()-1,left:a.left})}},e={selectedEventName:"MENTIONABLE_SELECTED",show:function(e,l,c){a(e);d();f.hide().empty();var k=RegExp(b.telligent.evolution.regex.encode(b.telligent.evolution.html.encode(c)),"i");b.each(l,function(a,d){var e=d.name.match(k),e=null!==e?b("<li>"+d.name.replace(k,"<strong>"+e[0]+"</strong>")+"</li>"):b("<li>"+
d.name+"</li>");e.data("mentionableData",d);f.append(e)});f.show()},hide:function(){null!==f&&f.hide().empty()},loading:function(e){a(e);d();f.hide().empty().append(c).show()},moveHighlightUp:function(){var a=f.find("li");if(0!==a.length){var d=a.length;b.each(a,function(a,e){b(e).hasClass("highlight")&&(d=a,b(e).removeClass("highlight"))});0>d-1&&(d=a.length);b(a.get(d-1)).addClass("highlight")}},moveHighlightDown:function(){var a=f.find("li");if(0!==a.length){var d=-1;b.each(a,function(a,e){b(e).hasClass("highlight")&&
(d=a,b(e).removeClass("highlight"))});d+1>=a.length&&(d=-1);b(a.get(d+1)).addClass("highlight")}},selection:function(){var a=f.find("li");if(0===a.length)return null;var d=a.filter("li.highlight");return null!==d&&0<d.length?d.data("mentionableData"):b(a.get(0)).data("mentionableData")}};return e}();b.fn.evolutionComposer.plugins.mentions=h;b.fn.evolutionComposer.plugins.mentions.defaults={onMentionableList:function(f,k){b.telligent.evolution.get({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/mentionables.json?IncludeFields=Token,PreviewHtml",
data:{QueryText:f,PageSize:20},cache:!1,dataType:"json",success:function(c){c.Mentionables&&0<c.Mentionables.length?(c=b.map(c.Mentionables,function(a){return{name:a.PreviewHtml,token:a.Token}}),k(c)):k(null)}})}}})(jQuery,window);
(function(b,m){var h=/(\b(http):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,g=function(){var b={init:function(k){k.highlighClassName=k.highlighClassName||b.defaults.highlighClassName},onTransform:function(b){var c;c=(b.val()||"").match(h);c=null!==c&&0<c.length?c[0]:null;if(null!==c){var a;a=b.data("_composer_urlpreview_data");if(null===a||"undefined"===typeof a)a={},b.data("_composer_urlpreview_data",a);var d=b.val().indexOf(c);if(0<=d&&"undefined"===typeof a.lastRange||a.lastRange.start!==
d||a.lastRange.stop!==d+c.length)a.lastRange={start:d,stop:d+c.length},b.clearHighlights(b.highlighClassName),b.addHighlight({start:d,stop:d+c.length,className:b.highlighClassName}),b.renderHighlights()}else b.clearHighlights(b.highlighClassName)},shouldActivate:function(b){return!1},val:function(b,c){return b},onkeydown:function(b,c){return!0},oninput:function(b,c){return!0},defaults:{highlighClassName:"composer-url-highlight",loadingText:"..."}};return b}();b.fn.evolutionComposer.plugins.urlhighlight=
g})(jQuery,window);
(function(b,m){"undefined"===typeof b.telligent&&(b.telligent={});"undefined"===typeof b.telligent.evolution&&(b.telligent.evolution={});var h={baseUrl:"",authorizationCookieName:"AuthorizationCookie",defaultErrorMessage:"An error occured while communicating with the server.",defaultMultiErrorMessagePrefix:"The following errors occured while communicating with the server:\t ",isRemote:!1,remoteUrlEncodePattern:""},g=["RecordNotFound","BadRequest","Conflict","Unauthorized","Unknown"],f=function(d,
e){d.url&&(d.data&&"string"!==typeof d.data)&&b.each(d.data,function(a,e){var l=RegExp("{"+a+"}","gim");d.url.match(l)&&(d.url=d.url.replace(l,m.encodeURIComponent(e)),delete d.data[a])});h.isRemote&&(h.remoteUrlEncodePattern&&d.url&&-1<d.url.lastIndexOf("/~/"))&&(d.url=d.url.substr(0,d.url.lastIndexOf("/~/")+3)+d.url.substr(d.url.lastIndexOf("/~/")+3).replace(RegExp(h.remoteUrlEncodePattern,"gi"),function(a,d,e){return"_"+a.substr(1)}));var c=d.beforeSend,l=d.error,k=b.extend({},h,d);b.extend(d,
{type:"GET"===e?e:"POST",beforeSend:function(d){"undefined"!==typeof c&&c(d);a(d);"PUT"!==e&&"DELETE"!==e||d.setRequestHeader("Rest-Method",e)},error:function(a,d,e){if(0!==a.readyState&&0!==a.status){d=k.defaultErrorMessage;var c=/(?:<|>)/g,n=null;try{var f=b.parseJSON(a.responseText);if(f&&f.Errors&&b.isArray(f.Errors)&&0<f.Errors.length){var h=[];b.each(f.Errors,function(a,d){var e=d.split(":",2);1===e.length?h.push(e[0].replace(c,"")):0<=b.inArray(e[0],g)&&h.push(e[1].replace(c,""))});1===h.length||
1<h.length&&"undefined"===typeof b.telligent.evolution.notifications?d=h[0]:1<h.length&&(n=h[0],d=k.defaultMultiErrorMessagePrefix,d+="<ul>",b.each(h,function(a,e){d+="<li>"+e+"</li>"}),d+="</ul>")}if(null===d||""===b.trim(d))d=k.defaultErrorMessage}catch(m){}if("undefined"!==typeof l)l(a,n||d,e);else try{b.telligent.evolution.notifications.show(d,{type:"error"})}catch(t){alert(n||d)}}}});return b.ajax(d)},k=function(){var a=(new Date).getTimezoneOffset();return function(e){var c,l=new Date;if(null===
e||""===e)return l;if(null!=(c=/\/Date\((\d+)(?:-(\d+))?\)\//.exec(e)))return new Date(parseInt(c[1],10));if(null!=(c=/(\d{4,4})\-(\d{2,2})\-(\d{2,2})(?:T(\d{2,2}):(\d{2,2}):(?:(\d{2,2})(?:\.(\d{0,3}))?))([zZ]|([+\-])(((\d\d):(\d\d))|(\d\d\d\d)))?/.exec(e))){e=[l.getFullYear(),l.getMonth()+1,l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds()];for(l=1;l<c.length&&8>l;l++)""!=c[l]&&void 0!=c[l]&&(e[l-1]=parseInt(c[l],10));e=new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5],e[6]);if(c[8]){var b,
k;"z"==c[8]||"Z"==c[8]?(b=0,k=1):c[9]&&c[12]&&c[13]?(b=60*parseInt(c[12],10)+parseInt(c[13],10),k="+"==c[9]?1:-1):c[9]&&c[10]&&(b=60*parseInt(c[10].substring(0,2),10)+parseInt(c[10].substring(2),10),k="+"==c[9]?1:-1);e=new Date(e.getTime()+-6E4*(k*b+a))}return e}throw"Invalid date format";}}(),c=function(a,e,c){for(a+="";a.length<e;)a=c+a;return a},a=function(a){var e;a:{e=h.authorizationCookieName+"=";for(var c=document.cookie.split(";"),l=0;l<c.length;l++){for(var b=c[l];" "==b.charAt(0);)b=b.substring(1,
b.length);if(0==b.indexOf(e)){e=b.substring(e.length,b.length);break a}}e=null}null!=e&&(a.setRequestHeader("Authorization-Code",e),a.setRequestHeader("Rest-Authorization-Code",e))};b.extend(b.telligent.evolution,{get:function(a){return f(a,"GET")},post:function(a){return f(a,"POST")},put:function(a){return f(a,"PUT")},del:function(a){return f(a,"DELETE")},formatDate:function(a){var e;a:{try{e=[c(a.getFullYear(),4,"0"),"-",c(a.getMonth()+1,2,"0"),"-",c(a.getDate(),2,"0"),"T",c(a.getHours(),2,"0"),
":",c(a.getMinutes(),2,"0"),":",c(a.getSeconds(),2,"0")].join("");break a}catch(b){}e=""}return e},parseDate:function(a){return k(a)},writeAuthorizationHeader:function(d){return a(d)}});b.telligent.evolution.site={configure:function(a){h=b.extend({},h,a);b.fn.glowDateTimeSelector&&b.extend(b.fn.glowDateTimeSelector.defaults,{monthNames:h.monthNames,dayNames:h.dayNames,calendarButtonImageUrl:b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DateTimeSelectorCalendar.gif"});b.glowModal&&(b.extend(b.glowModal.defaults,
{loadingHtmlUrl:"about:blank",windowCssClasses:["modal"],windowTitleCssClasses:["modal-title","modal-title-2","modal-title-3","modal-title-4"],windowCloseCssClasses:["modal-close"],windowContentCssClasses:["modal-content","modal-content-2"],windowMaskCssClasses:["modal-mask"],windowFooterCssClasses:["modal-footer","modal-footer-2","modal-footer-3"],windowResizeCssClasses:["modal-resize"],zIndex:200001}),m.Telligent_Modal={GetWindowOpener:function(a,d){return b.glowModal.opener(a,d)},IsShown:function(a){return b.glowModal.visible(a)},
Resize:function(a,d,l,c){b.glowModal.resize(a,d,l,c)},MoveTo:function(a,d,l){b.glowModal.moveTo(a,d,l)},Open:function(a,d,l,c,k,f,g,s,p){b.glowModal(a,{width:d,height:l,onClose:c,x:k,y:f,ignoreCloseAndAnimation:g,isManuallyresized:s,openerWindow:p})},Close:function(a,d){b.glowModal.close(a,d)},Refresh:function(a){b.glowModal.refresh(a)}});b.fn.glowDropDownList&&b.extend(b.fn.glowDropDownList.defaults,{buttonImageUrl:b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/DropDownListButton.gif"});
b.fn.glowColorSelector&&b.extend(b.fn.glowColorSelector.defaults,{blendImageUrl:b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorSv.png",hueBlendImageUrl:b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/ColorSelectorHue.png"});b.fn.glowMultiUpload&&b.extend(b.fn.glowMultiUpload.defaults,{swfUrl:b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:h.silverlightFileUploadEnabled?b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":
"",runtimes:h.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"});b.fn.glowUpload&&b.extend(b.fn.glowUpload.defaults,{swfUrl:b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.swf",silverlightUrl:h.silverlightFileUploadEnabled?b.telligent.evolution.site.getBaseUrl()+"utility/images/glow/Moxie.xap":"",runtimes:h.silverlightFileUploadEnabled?"html5,silverlight,flash":"html5,flash"})},getBaseUrl:function(){return h.baseUrl}}})(jQuery,window);
if("undefined"==typeof TelligentUtility)var TelligentUtility={};TelligentUtility.WriteAuthorizationHeader=function(b){$.telligent.evolution.writeAuthorizationHeader(b)};
(function(b,m,h){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});var g={},f=function(a,e,c){if(a.isSaving)if(e+1<a.widgets.length){var l=a.widgets[e+1];l.save?(l=l.save(function(){f(a,e+1,c)},function(){k(a,e+1,c)}),!1===l?k(a,e+1,c):!0===l&&f(a,e+1,c)):f(a,e+1,c)}else c.success&&(a.isSaving=!1,c.success())},k=function(a,e,c){a.isSaving&&(a.isSaving=!1,c.error&&c.error())},c=function(a,e,c){if(a.isValidating){a.widgets[e].valid=!0;var l=0;b.each(a.widgets,function(a,
d){!0!==d.valid&&l++});0==l&&(a.isValidating=!1,c.success&&c.success())}},a=function(a,e,c){a.isValidating&&(a.widgets[e].valid=!1,a.isValidating=!1,c.error&&c.error())};b.telligent.evolution.editableGroup={register:function(a,e){var c=g[a];c||(c={widgets:[],isSaving:!1,isValidating:!1},g[a]=c);c.widgets[c.widgets.length]=b.extend({},e||{},{valid:!1,saved:!1})},save:function(a,e){b.telligent.evolution.editableGroup.validate(a,{success:function(){var c=g[a];c&&0<c.widgets.length?(c.isSaving=!0,f(c,
-1,e)):e&&e.success&&e.success()},error:function(){e.error&&e.error()}})},validate:function(d,e){var k=g[d];k&&0<k.widgets.length?(b.each(k.widgets,function(a,d){d.valid=h}),k.isValidating=!0,b.each(k.widgets,function(d,b){if(b.validate){var f=b.validate(function(){c(k,d,e)},function(){a(k,d,e)});!1===f?a(k,d,e):!0===f&&c(k,d,e)}else c(k,d,e)})):e&&e.success&&e.success()}}})(jQuery,window);
(function(b){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});var m=function(h,g){0>g||(0<g&&""!=h.subscriptionId&&(""==h.context||"undefined"===h.contextId)?_showMessage(h,h.errorMessage):b.telligent.evolution.post({url:h.emailDigestUrl,data:{subscriptionId:h.subscriptionId,frequency:g,context:h.context,contextId:h.contextId},success:function(f){f=eval("("+f+")");var k=null;"create"==f.action?(h.subscriptionId=f.subscriptionId,h.frequency=g,1==g?k=h.dailyMessage:7==
g&&(k=h.weeklyMessage)):"update"==f.action?(h.frequency=g,1==g?k=h.dailyMessage:7==g&&(k=h.weeklyMessage)):"delete"==f.action&&(h.subscriptionId="",h.frequency=0,"group"==h.context&&(k=h.unsubscribeGroupMessage));f.warnings&&0<f.warnings.length?_showMessage(h,f.warnings[0],"warning"):k&&_showMessage(h,k,"success");f={subscriptionId:h.subscriptionId,frequency:h.frequency,context:h.context,contextId:h.contextId,action:f.action};b(document).trigger("emailDigestSubscriptionChange",[f])},error:function(b,
k,c){_showMessage(h,h.errorMessage,"error")}}))};_showMessage=function(h,g,f){b.telligent.evolution.notifications.show(g,{type:f,duration:5E3})};b.telligent.evolution.emailDigest={register:function(h){b("#"+h.selectPopupId).glowPopUpPanel({cssClass:"Panel",position:"updown",zIndex:100,hideOnDocumentClick:!0});b("#"+h.rollupWrapperId).click(function(){var g=b(this),f="",k="",c="";1==h.frequency?f="email-digest-selected":7==h.frequency?k="email-digest-selected":c="email-digest-selected";var a=g.outerWidth(),
d=g.outerHeight(),g=g.offset(),f="<div class='email-digest-selectWrapper' style=\"min-width: "+(a-2)+'px;"><div frequency="1" class="email-digest-selectable '+h.selectableTag+" "+f+'"><span style="display: block; white-space: nowrap;">'+h.popupDaily+'</span></div><div frequency="7" class="email-digest-selectable '+h.selectableTag+" "+k+'"><span style="display: block; white-space: nowrap;">'+h.popupWeekly+'</span></div><div frequency="0" class="email-digest-selectable '+h.selectableTag+" "+c+'"><span style="display: block; white-space: nowrap;">'+
h.popupUnsubscribe+"</span></div></div>";b("#"+h.selectPopupId).glowPopUpPanel("hide").glowPopUpPanel("html",f).glowPopUpPanel("show",g.left+4,g.top+5,a,d-10,!1)});b("."+h.selectableTag).live("click",function(){var g=b(this);g.hasClass("email-digest-selected")||(g=g.attr("frequency"),m(h,g))});b(document).bind("emailDigestSubscriptionChange",function(g,f){if(f.context==h.context&&f.contextId==h.contextId){var k="";"create"==f.action||"update"==f.action?("1"==f.frequency?k=h.rollupDaily:"7"==f.frequency&&
(k=h.rollupWeekly),h.subscriptionId=f.subscriptionId):(k=h.rollupUnsubscribed,h.subscriptionId="");h.frequency=f.frequency;b("#"+h.rollupTextId).html(k)}})}}})(jQuery);
(function(b,m){var h="onhashchange"in m&&(void 0===document.documentMode||7<document.documentMode),g=m.location.href,f=b(m),k;h||(b.event.special.hashchange={setup:function(){k||(k=setInterval(function(){m.location.href!==g&&(g=m.location.href,f.trigger("hashchange"))},b.hashChangeSettings.interval))}});b.hashChangeSettings={interval:10}})(jQuery,window);
(function(b){var m=function(a,d){var e=a.data("_HIGHLIGHTER_CONTEXT");if("undefined"===typeof e||null===e)e={selection:a.filter("textarea"),settings:b.extend({},b.fn.evolutionHighlight.defaults,d||{})},h(e),a.data("_HIGHLIGHTER_CONTEXT",e);return e},h=function(a){a.wrapper=b("<div></div>");a.mirror=b("<div></div>");var d={position:"relative",width:a.selection.outerWidth(),height:a.selection.outerHeight()};b.each(["margin-left","margin-right","margin-top","margin-bottom"],function(e,c){d[c]=a.selection.css(c);
a.selection.css(c,0)});var e={position:"absolute",top:"0px",left:"0px",zIndex:"0",borderTopColor:"transparent",borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent",backgroundColor:a.selection.css("backgroundColor"),color:"transparent",width:a.selection.width(),height:a.selection.height(),overflow:"hidden",whiteSpace:"normal"};b.each(a.settings.styles,function(d,c){e[c]=a.selection.css(c)});var c={position:"absolute",top:"0px",left:"0px",zIndex:"1",backgroundColor:"transparent",
width:a.selection.width(),height:a.selection.height()};a.wrapper.css(d).addClass("highlighter");a.mirror.css(e);a.selection.css(c);a.mirror.css("color",a.mirror.css("background-color"));a.selection.before(a.wrapper);a.wrapper.append(a.selection);a.wrapper.append(a.mirror)},g=/\s\s/gi,f=/\n/gi,k=function(a){var d={};b.each(a.settings.ranges,function(a,e){d[e.start]=d[e.start]||[];d[e.start].push(e);d[e.stop]=d[e.stop]||[];d[e.stop].push(e)});var e=b.telligent.evolution.html.encode(a.selection.val()||
"");newValue=[];for(var c=spanDepth=0;c<e.length;c++)"undefined"!==typeof d[c]&&b.each(d[c],function(a,d){d.start===c?(newValue[newValue.length]='<span class="'+d.className+'" style="white-space:normal;">',spanDepth++):(newValue[newValue.length]="</span>",spanDepth--)}),newValue[newValue.length]=e.charAt(c);0<spanDepth&&(newValue[newValue.length]="</span>");var e=newValue.join("").replace(f,"<br />").replace(g,"&nbsp; "),l=document.createElement("span");l.innerHTML=e;a.mirror.empty().get(0).appendChild(l)},
c={init:function(a){var d=m(this,a);d.settings=b.extend({},b.fn.evolutionHighlight.defaults,a||{});k(d);return this},clear:function(){var a=m(this,null);if(null!==a)return a.mirror.html(""),this},resize:function(a,d){var e=m(this,null);if(null!==e){var c={width:a,height:d};e.mirror.css(c);e.selection.css(c);e.wrapper.css({width:e.selection.outerWidth(),height:e.selection.outerHeight()});return this}},css:function(a){var d=m(this,null);if(null!==d)return d.wrapper.css(a),this}};b.fn.evolutionHighlight=
function(a){if(c[a])return c[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.evolutionHighlight");else return c.init.apply(this,arguments)};b.fn.evolutionHighlight.defaults={ranges:[],styles:"border-top-width border-top-style border-bottom-width border-bottom-style border-right-width border-right-width-value border-right-style border-right-style-value border-left-width border-left-width-value border-left-style border-left-style-value font-family font-size font-size-adjust font-stretch font-style font-variant font-weight padding-bottom padding-left padding-right padding-top letter-spacing line-height text-align text-indent word-spacing".split(" ")}})(jQuery);
(function(b,m){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.html={encode:function(h){return h?b("<div/>").text(h).html():h},decode:function(h){if(!h)return h;h=h.replace(/<[^>]*>/g," ");return b("<div/>").html(h).text()}}})(jQuery,window);
(function(b){var m={},h=function(k,c){if(k.internal.isInitialized){for(var a=c.split(/[,;]/g),d=[],e=0;e<a.length;e++){var n=b.trim(a[e]);n&&(d[d.length]=n)}k.settings.onSave(d,function(){k.settings.currentTags=d})}},g=function(k){return this.each(function(){var c={settings:b.extend({},b.fn.evolutionInlineTagEditor.defaults,k||{}),internal:{state:b(this)}};b(this).data("evolutionTagInlineEditor_context",c);b(this).html()||b(this).text(c.settings.editButtonText);f(c)})},f=function(k){var c=b("<div></div>").addClass(k.settings.editorCssClass).attr("style",
"display: none;"),a=b('<label for="tag-area"></label>').hide(),d=b('<textarea id="tag-area"></textarea>').attr("cols","40").attr("rows","2");if(k.settings.allTags&&0<k.settings.allTags.length)var e=b('<input type="button" />').val(k.settings.selectTagsText);var n=b('<input type="button" />').val(k.settings.saveTagsText),l=b('<input type="button" />').val(k.settings.cancelText),r=b('<div style="white-space: nowrap; padding-top: 4px;"><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><td align="left"></td><td align="right"></td></tr></tbody></table></div>');
r.find("td:eq(1)").append(n);r.find("td:eq(1)").append(l);e&&r.find("td:first").append(e);c.append(a);c.append(d);c.append(r);d.evolutionTagTextBox({allTags:k.settings.allTags});c.glowPopUpPanel({cssClass:k.settings.editorCssClass,position:"updown",zIndex:500,hideOnDocumentClick:!1});b(k.internal.state).bind("click.evolutionInlineTagEditor",function(a){c.glowPopUpPanel("hide").glowPopUpPanel("show",b(this));d.val(0<k.settings.currentTags.length?k.settings.currentTags.join(", "):"");return!1});n.bind("click.evolutionInlineTagEditor",
function(a){h(k,d.attr("value"));c.glowPopUpPanel("hide");return!1});l.bind("click.evolutionInlineTagEditor",function(a){c.glowPopUpPanel("hide");return!1});e&&e.bind("click.evolutionInlineTagEditor",function(a){d.evolutionTagTextBox("openTagSelector");return!1});k.internal.state.after(c);k.internal.isInitialized=!0};b.fn.evolutionInlineTagEditor=function(k){if(k in m)return m[k].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof k&&k)b.error("Method "+k+" does not exist on jQuery.fn.evolutionInlineTagEditor");
else return g.apply(this,arguments)};b.extend(b.fn.evolutionInlineTagEditor,{defaults:{allTags:[""],currentTags:[""],editorCssClass:"tags-editor",editButtonText:"Edit",selectTagsText:"Select Tags",saveTagsText:"Save",cancelText:"Cancel",onSave:function(b,c){}}})})(jQuery);"object"!==typeof JSON&&(JSON={});
(function(){function b(a){return 10>a?"0"+a:a}function m(d){f.lastIndex=0;return f.test(d)?'"'+d.replace(f,function(d){var e=a[d];return"string"===typeof e?e:"\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+d+'"'}function h(a,b){var l,r,f,g,v=k,s,p=b[a];p&&("object"===typeof p&&"function"===typeof p.toJSON)&&(p=p.toJSON(a));"function"===typeof d&&(p=d.call(b,a,p));switch(typeof p){case "string":return m(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);
case "object":if(!p)return"null";k+=c;s=[];if("[object Array]"===Object.prototype.toString.apply(p)){g=p.length;for(l=0;l<g;l+=1)s[l]=h(l,p)||"null";f=0===s.length?"[]":k?"[\n"+k+s.join(",\n"+k)+"\n"+v+"]":"["+s.join(",")+"]";k=v;return f}if(d&&"object"===typeof d)for(g=d.length,l=0;l<g;l+=1)"string"===typeof d[l]&&(r=d[l],(f=h(r,p))&&s.push(m(r)+(k?": ":":")+f));else for(r in p)Object.prototype.hasOwnProperty.call(p,r)&&(f=h(r,p))&&s.push(m(r)+(k?": ":":")+f);f=0===s.length?"{}":k?"{\n"+k+s.join(",\n"+
k)+"\n"+v+"}":"{"+s.join(",")+"}";k=v;return f}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k,c,a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},d;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,l){var r;c=k="";if("number"===typeof l)for(r=0;r<l;r+=1)c+=" ";else"string"===typeof l&&(c=l);if((d=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return h("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,d){function c(a,e){var b,k,r=a[e];if(r&&"object"===typeof r)for(b in r)Object.prototype.hasOwnProperty.call(r,b)&&(k=c(r,b),void 0!==k?r[b]=k:delete r[b]);return d.call(a,e,r)}var b;a=String(a);g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),"function"===typeof d?c({"":b},""):b;throw new SyntaxError("JSON.parse");})})();
(function(b){var m={},h=function(f,k,c){var a=m[f.toString()+"-"+k];"undefined"===typeof a?b.telligent.evolution.get({url:g.defaults.dateEndpoint,data:{date:b.telligent.evolution.formatDate(f),format:k},success:function(a){a&&(c&&"undefined"!==typeof a&&null!==a&&a.formattedDate)&&(m[f.toString()+"-"+k]=a.formattedDate,c(a.formattedDate))}}):c(a)},g={formatDate:function(b,k){h(b,"date",k)},formatDateAndTime:function(b,k){h(b,"datetime",k)},formatAgoDate:function(b,k){h(b,"agodate",k)},defaults:{dateEndpoint:""}};
b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.language=g})(jQuery);
(function(b){var m=!1,h=function(c){var a=c.settings.format;c.hasCount&&(a=a.replace(/\{count\}/gi,'<span class="like-count who-likes"></span>'));c.hasToggle&&(a=a.replace(/\{toggle\}/gi,'<span class="like-toggle"><a href="#" class="internal-link"></a></span>'));c.hasMessage&&(a=a.replace(/\{message\}/gi,'<span class="like-message"></span>'));c.element.html(a);c.hasCount&&(c.countWrapper=c.element.find("span.like-count"),c.countWrapper.html(c.settings.initialCount));c.hasToggle&&(c.toggleLink=c.element.find("span.like-toggle a"),
c.toggleLink.evolutionToggleLink({onHtml:"<span></span>"+c.settings.unlikeText,offHtml:"<span></span>"+c.settings.likeText,onTitle:"",offTitle:"",processingHtml:"<span></span>...",changeState:function(a){f(a,c)},onCssClass:"internal-link like-on",offCssClass:"internal-link like-off",processingCssClass:"internal-link processing",val:"true"===c.settings.initialState}));c.hasMessage&&(c.messageWrapper=c.element.find("span.like-message"),c.messageWrapper.html(c.settings.initialMessage))},g=function(c,
a,d){var e="";if(0<a.count){var k=0;d?1===a.count?e=c.settings.whoLikesAccessingText:2===a.count?(e=c.settings.whoLikesAccessingTwoText,k=-1):2<a.count&&(e=c.settings.whoLikesAccessingMultipleText,k=-1):1===a.count?e=c.settings.whoLikesOtherText:2===a.count?(k=-1,e=c.settings.whoLikesOtherTwoText):2<a.count&&(k=-1,e=c.settings.whoLikesOtherMultipleText);e=e.replace(/\{count\}/gi,a.count+k);e=e.replace(/\{user_profile_url\}/gi,a.latestLike.User.ProfileUrl);e=e.replace(/\{user_display_name\}/gi,a.latestLike.User.DisplayName)}b.telligent.evolution.messaging.publish("ui.like",
{contentId:c.settings.contentId,contentTypeId:c.settings.contentTypeId,typeId:c.settings.typeId,count:a.count,liked:d,message:e})},f=function(c,a){if(c)a.settings.onLike(a.settings.contentId,a.settings.contentTypeId,a.settings.typeId,function(d){g(a,d,!0)});else a.settings.onUnlike(a.settings.contentId,a.settings.contentTypeId,a.settings.typeId,function(d){g(a,d,!1)})},k=function(c){b.telligent.evolution.messaging.subscribe("ui.like",function(a){a.contentId===c.settings.contentId&&(a.contentTypeId===
c.settings.contentTypeId&&a.typeId===c.settings.typeId)&&(c.hasToggle&&c.toggleLink.evolutionToggleLink("val",a.liked),c.hasCount&&c.countWrapper.html(a.count),c.hasMessage&&c.messageWrapper.html(a.message))})};b.fn.evolutionLike=function(c){var a=b.extend({},b.fn.evolutionLike.defaults,c||{});return this.each(function(){var d={element:b(this),settings:a,hasCount:0<=a.format.indexOf("{count}"),hasToggle:0<=a.format.indexOf("{toggle}"),hasMessage:0<=a.format.indexOf("{message}")};h(d);k(d)})};b.fn.evolutionLike.delegatePopups=
function(c){if(!m){m=!0;var a=b.extend({},b.fn.evolutionLike.defaults,c||{}),d=b.telligent.evolution.template.compile(a.likersTemplate),e=b.telligent.evolution.template.compile(a.likersPopupTemplate),k=function(d,e,c){a.onList(d.contentId,d.contentTypeId,d.typeId,function(a){c(a)},d.pageSize,e)},l=function(c,l){var f=0,g=b(d(c)),s=b(e({likers:g,hasMorePages:c.hasMorePages,showMoreText:a.modalShowMoreText})),p=s.find("ul"),h=s.find(".show-more"),m=a.onOptions(b(l).closest(a.delegatedSelector));p.html(g);
h.on("click",function(a){a.preventDefault();f++;k(m,f,function(a){p.append(d(a));a.hasMorePages?h.show():h.hide();p.scrollTop(p[0].scrollHeight)})});b.glowModal({title:a.modalTitleText,html:s,width:450})};(function(){b(a.containerSelector).on("click",a.delegatedSelector+" .who-likes",function(d){var e=b(this);d=a.onOptions(b(e).closest(a.delegatedSelector));k(d,0,function(a){l(a,e)})})})()}};b.fn.evolutionLike.defaults={contentId:"",contentTypeId:"",typeId:"",initialState:!1,initialMessage:"",initialCount:0,
format:"",onLike:function(c,a,d,e){},onUnlike:function(c,a,d,e){},likeText:"Like",unlikeText:"Unlike",whoLikesOtherText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> likes this',whoLikesOtherTwoText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> <span class="who-likes">and 1 other</span> like this.',whoLikesOtherMultipleText:'<a href="{user_profile_url}" class="internal-link view-user-profile">{user_display_name}</a> and <span class="who-likes">{count} others</span> like this.',
whoLikesAccessingText:"You like this",whoLikesAccessingTwoText:'You and <span class="who-likes">1 other</span> like this',whoLikesAccessingMultipleText:'You and <span class="who-likes">{count} others</span> like this',modalTitleText:"People who like this",modalShowMoreText:"Show more",onList:function(c,a,d,e){},onOptions:function(c){},containerSelector:"",delegatedSelector:"",delay:500,likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"></div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                  </a>              </span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %></a>              </span>          </div>          <div class="full-post-footer"></div>      </li>  <% }); %> ',
likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= likers %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> '}})(jQuery);jQuery(function(b){b("textarea[maxlength]").live("keyup change",function(){var m=b(this),h=m.attr("maxlength"),g=m.val();g.length>h&&m.val(g.substr(0,h))})});
(function(b){var m=function(g,f,k){var c=b.extend({},h.defaults,k||{});g={url:g,view:f};c.width&&(g.width=c.width);c.height&&(g.height=c.height);b.telligent.evolution.get({url:c.endpoint,data:g,success:function(a){a&&c.success&&c.success(a)},error:function(a,d,e){c.error&&c.error(a,d,e)}})},h={previewHtml:function(b,f){m(b,"preview",f)},viewHtml:function(b,f){m(b,"view",f)},defaults:{endpoint:""}};b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.media=
h})(jQuery);
(function(b){var m={},h={},g=0;b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.messaging={publish:function(f,k){if(!f)throw"messageName is required when publishing a message";if(null!==f&&0!==f.length){var c=m[f];c&&b.each(c,function(a,d){if(null!==d.handler)try{d.handler.call(this,k)}catch(e){}})}},subscribe:function(b,k){if(!b)throw"messageName is required when subscribing to a message";if(null===b||0===b.length)return 0;"undefined"===typeof m[b]&&
(m[b]=[]);var c={message:b,handler:k,id:g++};m[b][m[b].length]=c;h[String(c.id)]=c;return c.id},unsubscribe:function(f){if(!f)throw"subscriptionId is required when unsubscribing a message";if("undefined"!==typeof h[String(f)]){var k=h[String(f)],c=-1,a=m[k.message];b.each(a,function(a,e){e===k&&(c=a)});0<=c&&a.splice(c,1);0===a.length&&delete m[k.message];delete h[String(f)]}}}})(jQuery);
(function(b){var m=b.telligent.evolution,h=function(b){b.settings.onReport(b.settings.contentId,b.settings.contentTypeId,function(k){m.messaging.publish("ui.reportabuse",{contentId:b.settings.contentId,contentTypeId:b.settings.contentTypeId});showNotification(b,k.Report)})},g=function(b){b.hideTimer&&(clearTimeout(b.hideTimer),b.hideTimer=null)};buildModerationLink=function(f){f.moderationLink=b(m.template.compile(f.settings.moderationLinkTemplate)({linkClassName:f.settings.linkClassName,resources:{moderateLinkText:f.settings.moderateLinkText}})).appendTo(f.element)};
buildModerationPopup=function(f){f.popup=b("<div></div>").glowPopUpPanel({cssClass:"content-moderation",position:"downleft",zIndex:1E3,hideOnDocumentClick:!0});f.popup.bind({glowPopUpPanelShown:function(b){f.moderationLink.addClass("open")},glowPopUpPanelHidden:function(b){f.moderationLink.removeClass("open")}})};buildModerationMenuContent=function(f,k){f.settings.onGetAdditionalLinks(function(c){var a=[],a=f.settings.supportsAbuse?f.settings.initialState?c.concat([{href:"#",className:"evolutionModerateFlagged",
text:f.settings.reportedLinkText}]):c.concat([{href:"#",className:"evolutionModerateFlag",text:f.settings.reportLinkText}]):c;c=b(m.template.compile(f.settings.moderationMenuTemplate)({links:a}));c.bind("mouseleave",function(a){hideMenu(f)});c.bind("mouseenter",function(a){g(f)});c.delegate("a","click",function(a){var e=b(a.target);e.hasClass("evolutionModerateFlag")?(a.preventDefault(),h(f)):e.hasClass("evolutionModerateFlagged")?a.preventDefault():("#"===e.attr("href")&&a.preventDefault(),f.element.trigger("evolutionModerateLinkClicked",
a.target))});k(c)})};showMenu=function(b){b.popup||buildModerationPopup(b);buildModerationMenuContent(b,function(k){g(b);b.popup.glowPopUpPanel("html",k).glowPopUpPanel("show",b.moderationLink)})};hideMenu=function(b){b.hideTimer||(b.hideTimer=setTimeout(function(){b.popup.glowPopUpPanel("hide");b.hideTimer=null},200))};formatNotificationMessage=function(b,k){return b.settings.reportedNotificationMessageText.replace(/\{NAME\}/gi,k&&k.AuthorUser&&k.AuthorUser.DisplayName?k.AuthorUser.DisplayName:"")};
showNotification=function(b,k){var c=m.template.compile(b.settings.notificationTemplate)({resources:{reportedNotificationMessageText:formatNotificationMessage(b,k),undoLinkText:b.settings.undoLinkText},contextId:b.contextId});m.notifications.show(c,{type:"moderation",duration:b.settings.notificationDuration,cssClass:""})};handleFlagMessages=function(b){m.messaging.subscribe("ui.reportabuse",function(k){b.settings.contentId===k.contentId&&b.settings.contentTypeId===k.contentTypeId&&(b.settings.initialState=
!0)})};init=function(f){buildModerationLink(f);f.moderationLink.bind({mouseenter:function(b){b.preventDefault();f.popup&&f.popup.glowPopUpPanel("isShown")?hideMenu(f):showMenu(f);g(f)},mouseleave:function(k){b(k.relatedTarget).is(".content-moderation")||0!==b(k.relatedTarget).closest(".content-moderation").length||hideMenu(f)}});handleFlagMessages(f)};b.fn.evolutionModerate=function(f){var k=b.extend({},b.fn.evolutionModerate.defaults,f||{});return this.each(function(){var c={element:b(this),settings:k};
init(c)})};b.fn.evolutionModerate.defaults={contentId:"",contentTypeId:"",initialState:!1,linkClassName:"",onReport:function(b,k,c){},onGetAdditionalLinks:function(b){b([])},notificationDuration:5E3,moderateLinkText:"moderate",supportsAbuse:!0,reportLinkText:"Flag as spam/abuse",reportedLinkText:"Flagged as spam/abuse",reportedNotificationMessageText:"{NAME}'s post has been flagged. <strong>Thank you for your feedback.</strong>",undoLinkText:"Undo",moderationLinkTemplate:'<a href="#" class="<%: linkClassName %>"><span></span><%= resources.moderateLinkText %></a>',
moderationMenuTemplate:'<ul class="navigation-list">   <% foreach(links, function(link){ %>       <li class="navigation-item">           <a href="<%: (link.href || "#") %>" class="<%: (link.className || "") %>"><%= link.text %></a>       </li>   <% }); %></ul>',notificationTemplate:"<p><%= resources.reportedNotificationMessageText %></p>"}})(jQuery);
(function(b,m){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});var h={message:"",enabled:!1,ignoreClick:!1},g=function(){if(!h.ignoreClick)return h.message};b.telligent.evolution.navigationConfirmation={configure:function(f){h=b.extend(h,f)},enable:function(){h.enabled||(window.onbeforeunload=g,h.enabled=!0,b(document).bind("customizepage",function(){h.ignoreClick=!0}))},register:function(f){b(f).click(function(){h.ignoreClick=!0})},ignoreClick:function(){h.ignoreClick=
!0}}})(jQuery);
(function(b,m){b.telligent=b.telligent||{};b.telligent.evolution=b.telligent.evolution||{};var h={duration:9999,width:300,type:"directions",cssClass:"menu notification notification__menu"},g=null,f=null,k=300,c=!1,a=function(){g&&g.glowPopUpPanel("isShown")&&g.glowPopUpPanel("show",(b(m).width()-k)/2,b(m).scrollTop(),k,0,!0)};b.telligent.evolution.notifications={show:function(d,e){e=b.extend({},h,e||{});g||(g=b("<div></div>").glowPopUpPanel({cssClass:e.cssClass,position:"down",zIndex:1E4,hideOnDocumentClick:!1}).bind("glowPopUpPanelMouseOver",
function(){c=!0}).bind("glowPopUpPanelMouseOut",function(){c=!1}),b(m).bind("scroll",a));m.clearTimeout(f);g.glowPopUpPanel("isShown")&&g.glowPopUpPanel("hide");k=e.width;g.glowPopUpPanel("html",'<div class="message '+e.type+'" style="width:'+e.width+'px">'+d+"</div>").glowPopUpPanel("show",(b(m).width()-e.width)/2,b(m).scrollTop(),e.width,0);f=m.setTimeout(function(){b.telligent.evolution.notifications.hide(e.callback)},e.duration)},hide:function(a){g&&(m.clearTimeout(f),c?f=m.setTimeout(function(){b.telligent.evolution.notifications.hide(a)},
249):(g.glowPopUpPanel("hide"),a&&"function"===typeof a&&a()))}}})(jQuery,window);(function(b,m){b.telligent.evolution.messaging.subscribe("socket.connected",function(){b.telligent.evolution.sockets.notifications.on("received",function(h){b.telligent.evolution.messaging.publish("notification.raised",h)})})})(jQuery,window);
(function(b){var m={},h={},g={},f=function(a){var d=[],e=a.settings,c=function(a){var d={};d[e.pageKey]=a;a={url:e.baseUrl,query:d};e.hash&&0<e.hash.length&&(a[e.hash]=e.hash);return b.telligent.evolution.url.modify(a)};0===e.totalItems||0===e.pageSize?a=0:(a=Math.floor(e.totalItems/e.pageSize),0<e.totalItems%e.pageSize&&(a+=1));if(1<a){e.showFirst&&3<=e.currentPage&&a>e.numberOfPagesToDisplay&&(d[d.length]={type:"first",selected:!1,page:1,url:c(1)});e.showPrevious&&0<e.currentPage&&(d[d.length]=
{type:"previous",selected:!1,page:e.currentPage,url:c(e.currentPage)});if(e.showIndividualPages){var k;k=a<e.numberOfPagesToDisplay||0>e.currentPage-Math.floor(e.numberOfPagesToDisplay/2)?0:e.currentPage+Math.floor(e.numberOfPagesToDisplay/2)>=a?a-e.numberOfPagesToDisplay:e.currentPage-Math.floor(e.numberOfPagesToDisplay/2);var n;n=Math.floor(e.numberOfPagesToDisplay/2);0===e.numberOfPagesToDisplay%2&&(n-=1);for(n=a<e.numberOfPagesToDisplay||e.currentPage+n>=a?a-1:0>e.currentPage-Math.floor(e.numberOfPagesToDisplay/
2)?e.numberOfPagesToDisplay-1:e.currentPage+n;k<=n;k++)d[d.length]={type:"page",selected:e.currentPage===k,page:k+1,url:c(k+1)}}e.showNext&&e.currentPage+1<a&&(d[d.length]={type:"next",selected:!1,page:e.currentPage+2,url:c(e.currentPage+2)});e.showLast&&e.currentPage+3<a&&a>e.numberOfPagesToDisplay&&(d[d.length]={type:"last",selected:!1,page:a,url:c(a)})}return d},k=function(a){var d=a.template({links:a.links});a.selection.html(d)},c=function(a){var d=parseInt(b.telligent.evolution.url.hashData()[a.settings.pageKey],
10);isNaN(d)||d===a.settings.currentPage||g[a.settings.pageKey]||(g[a.settings.pageKey]=!0,a.settings.onPage(d,function(e){a.currentPageIndex=d;n(a,d,0,e,!1)}))},a=function(a){b(a.selection).delegate("a","click",function(d){d.preventDefault();d=b(this);var e={};e[a.settings.pageKey]=d.data("page");b.telligent.evolution.url.hashData(e)})},d=function(a){m[a.settings.pageKey]||(m[a.settings.pageKey]=!0,a.currentPageIndex=parseInt(b.telligent.evolution.url.hashData()[a.settings.pageKey],10),isNaN(a.currentPageIndex)&&
(a.currentPageIndex=a.settings.currentPage),b(window).bind("hashchange",function(d){d=parseInt(b.telligent.evolution.url.hashData()[a.settings.pageKey],10);if(!isNaN(d)&&a.currentPageIndex!==d){a.newPageIndex=d;var e={currentPage:a.currentPageIndex,newPage:a.newPageIndex,container:a.settings.pagedContentContainer};b.telligent.evolution.messaging.publish(a.settings.pagedContentPagingEvent,e);a.selection.trigger("evolutionPagerPaging",e);a.currentPageIndex=d}}))},e=function(a){h[a.settings.pagedContentPagingEvent]&&
(a.currentPageIndex=parseInt(b.telligent.evolution.url.hashData()[a.settings.pageKey],10),b.telligent.evolution.messaging.unsubscribe(h[a.settings.pagedContentPagingEvent]));h[a.settings.pagedContentPagingEvent]=b.telligent.evolution.messaging.subscribe(a.settings.pagedContentPagingEvent,function(d){g[a.settings.pageKey]||(g[a.settings.pageKey]=!0,a.settings.onPage(d.newPage,function(e){a.currentPageIndex=d.newPage;n(a,d.newPage,d.currentPage,e,!0)}))})},n=function(a,d,e,c,n){var s=function(){var e=
{page:d,container:a.settings.pagedContentContainer};b.telligent.evolution.messaging.publish(a.settings.pagedContentPagedEvent,e);a.selection.trigger("evolutionPagerPaged",e)};!n||"slide"!==a.settings.transition&&"fade"!==a.settings.transition?(b(a.settings.pagedContentContainer).html(c),s(),g[a.settings.pageKey]=!1):(n="fade","slide"===a.settings.transition&&(n=d<e?"slideRight":"slideLeft"),e=b(a.settings.pagedContentContainer),c=b("<div></div>").attr("id",e.attr("id")).html(c).hide().insertAfter(a.settings.pagedContentContainer),
e.glowTransition(c,{type:n,duration:a.settings.transitionDuration,complete:function(){b(a.settings.pagedContentContainer).css({width:"",height:"",overflow:"hidden"});s();g[a.settings.pageKey]=!1}}));a.settings.currentPage=d-1;a.links=f(a);k(a)};b.fn.evolutionPager=function(l){l=b.extend({},b.fn.evolutionPager.defaults,l||{});var n={selection:this,settings:l,template:b.telligent.evolution.template.compile(l.template)};n.links=f(n);k(n);l.onPage&&(l.pagedContentContainer&&0<l.pagedContentContainer.length)&&
(e(n),d(n),a(n),c(n));return this};b.fn.evolutionPager.defaults={currentPage:0,pageSize:10,totalItems:0,showPrevious:!1,showNext:!1,showFirst:!0,showLast:!0,showIndividualPages:!0,numberOfPagesToDisplay:5,pageKey:"pi",hash:"",baseUrl:window.location.href,onPage:function(a,d){},pagedContentContainer:"",pagedContentPagingEvent:"ui.page.paging",pagedContentPagedEvent:"ui.page.paged",transition:null,transitionDuration:250,template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>     <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>     <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '}})(jQuery);
!function(b,m){function h(k,c){for(var a,d=[],e=0;e<k.length;++e){var n;if(!(n=f[k[e]]))a:{n=b;for(var l=k[e].split(/[.\/]/),r=0;r<l.length;++r){if(!n[l[r]]){n=void 0;break a}n=n[l[r]]}}if(a=n,!a)throw"module definition dependecy not found: "+k[e];d.push(a)}c.apply(null,d)}function g(b,c,a){if("string"!=typeof b)throw"invalid module definition, module id must be defined and be a string";if(c===m)throw"invalid module definition, dependencies must be specified";if(a===m)throw"invalid module definition, definition function must be specified";
h(c,function(){f[b]=a.apply(null,arguments)})}var f={};g("moxie/core/utils/Basic",[],function(){var b=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},c=function(e){return a(arguments,function(n,l){0<l&&a(n,function(a,l){void 0!==a&&(b(e[l])===b(a)&&~d(b(a),["array","object"])?c(e[l],a):e[l]=a)})}),e},a=function(a,d){var b,c;if(a){try{b=a.length}catch(k){b=void 0}if(void 0===b)for(c in a){if(a.hasOwnProperty(c)&&
!1===d(a[c],c))break}else for(c=0;b>c&&!1!==d(a[c],c);c++);}},d=function(a,d){if(d){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(d,a);for(var c=0,b=d.length;b>c;c++)if(d[c]===a)return c}return-1};return{guid:function(){var a=0;return function(d){var c=(new Date).getTime().toString(32),b;for(b=0;5>b;b++)c+=Math.floor(65535*Math.random()).toString(32);return(d||"o_")+c+(a++).toString(32)}}(),typeOf:b,extend:c,each:a,isEmptyObj:function(a){var d;if(!a||"object"!==b(a))return!0;for(d in a)return!1;
return!0},inSeries:function(a,d){function c(f){"function"===b(a[f])&&a[f](function(a){++f<r&&!a?c(f):d(a)})}var r=a.length;"function"!==b(d)&&(d=function(){});a&&a.length||d();c(0)},inParallel:function(d,c){var b=0,k=d.length,f=Array(k);a(d,function(a,d){a(function(a){if(a)return c(a);var e=[].slice.call(arguments);e.shift();f[d]=e;b++;b===k&&(f.unshift(null),c.apply(this,f))})})},inArray:d,arrayDiff:function(a,c){var l=[];"array"!==b(a)&&(a=[a]);"array"!==b(c)&&(c=[c]);for(var f in a)-1===d(a[f],
c)&&l.push(a[f]);return l.length?l:!1},arrayIntersect:function(e,c){var b=[];return a(e,function(a){-1!==d(a,c)&&b.push(a)}),b.length?b:null},toArray:function(a){var d,c=[];for(d=0;d<a.length;d++)c[d]=a[d];return c},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!=typeof a)return a;var d={t:1099511627776,g:1073741824,m:1048576,k:1024},c;return a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,
"")),c=a[2],a=+a[1],d.hasOwnProperty(c)&&(a*=d[c]),a}}});g("moxie/core/I18n",["moxie/core/utils/Basic"],function(b){var c={};return{addI18n:function(a){return b.extend(c,a)},translate:function(a){return c[a]||a},_:function(a){return this.translate(a)},sprintf:function(a){var d=[].slice.call(arguments,1);return a.replace(/%[a-z]/g,function(){var a=d.shift();return"undefined"!==b.typeOf(a)?a:""})}}});g("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(b,c){var a={mimes:{},
extensions:{},addMimeType:function(a){a=a.split(/,/);var e,c,b;for(e=0;e<a.length;e+=2){b=a[e+1].split(/ /);for(c=0;c<b.length;c++)this.mimes[b[c]]=a[e];this.extensions[a[e]]=b}},extList2mimes:function(a,c){var n,l,f,g,h=[];for(l=0;l<a.length;l++)for(n=a[l].extensions.split(/\s*,\s*/),f=0;f<n.length;f++){if("*"===n[f])return[];if(g=this.mimes[n[f]])-1===b.inArray(g,h)&&h.push(g);else{if(!c||!/^\w+$/.test(n[f]))return[];h.push("."+n[f])}}return h},mimes2exts:function(a){var c=this,n=[];return b.each(a,
function(a){if("*"===a)return n=[],!1;var d=a.match(/^(\w+)\/(\*|\w+)$/);d&&("*"===d[2]?b.each(c.extensions,function(a,b){RegExp("^"+d[1]+"/").test(b)&&[].push.apply(n,c.extensions[b])}):c.extensions[a]&&[].push.apply(n,c.extensions[a]))}),n},mimes2extList:function(a){var e=[],n=[];return"string"===b.typeOf(a)&&(a=b.trim(a).split(/\s*,\s*/)),n=this.mimes2exts(a),e.push({title:c.translate("Files"),extensions:n.length?n.join(","):"*"}),e.mimes=a,e},getFileExtension:function(a){return(a=a&&a.match(/\.([^.]+)$/))?
a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return a.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),
a});g("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(b){var c=function(a){var c={has:function(a,d){return-1!==d.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},b=function(){for(var c,b=0,e,k,l,n,f,r=arguments;b<r.length;b+=2){f=r[b];var g=r[b+1];if("undefined"===typeof c)for(l in c={},g)e=g[l],"object"===typeof e?c[e[0]]=a:c[e]=a;for(e=k=0;e<f.length;e++)if(n=f[e].exec(this.getUA())){for(l=0;l<g.length;l++)f=n[++k],e=g[l],"object"===typeof e&&0<e.length?
2==e.length?c[e[0]]="function"==typeof e[1]?e[1].call(this,f):e[1]:3==e.length?c[e[0]]="function"!==typeof e[1]||e[1].exec&&e[1].test?f?f.replace(e[1],e[2]):a:f?e[1].call(this,f,e[2]):a:4==e.length&&(c[e[0]]=f?e[3].call(this,f.replace(e[1],e[2])):a):c[e]=f?f:a;break}if(n)break}return c},l=function(b,l){for(var k in l)if("object"===typeof l[k]&&0<l[k].length)for(var n=0;n<l[k].length;n++){if(c.has(l[k][n],b))return"?"===k?a:k}else if(c.has(l[k],b))return"?"===k?a:k;return b},k={ME:"4.90","NT 3.11":"NT3.51",
"NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},f=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,
/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version",
"major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
["name",["major",l,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",l,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,
/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],g=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],
["version","name"]],h=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",l,k]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",l,k]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name",
"Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var d=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return b.apply(this,
f)};this.getEngine=function(){return b.apply(this,g)};this.getOS=function(){return b.apply(this,h)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return d};this.setUA=function(a){return d=a,this};this.setUA(d)}).getResult()}(),a={can:function(){var d={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==
b.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var d=new XMLHttpRequest;if(d.open("get","/"),"responseType"in d)return d.responseType=a,d.responseType!==a?!1:!0}}catch(c){}return!1},use_data_uri:function(){var a=new Image;return a.onload=function(){d.use_data_uri=1===a.width&&1===a.height},setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return d.use_data_uri&&("IE"!==
a.browser||9<=a.version)},use_data_uri_of:function(a){return d.use_data_uri&&33E3>a||d.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(a){var c=[].slice.call(arguments);return c.shift(),"function"===b.typeOf(d[a])?d[a].apply(this,c):!!d[a]}}(),browser:c.browser.name,version:parseFloat(c.browser.major),os:c.os.name,osVersion:c.os.version,verComp:function(a,c,b){var k=0,f=0,g=0,h={dev:-6,alpha:-5,
a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},k=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]};a=k(a);c=k(c);f=Math.max(a.length,c.length);for(k=0;f>k;k++)if(a[k]!=c[k]){if(a[k]=a[k]?isNaN(a[k])?h[a[k]]||-7:parseInt(a[k],10):0,c[k]=c[k]?isNaN(c[k])?h[c[k]]||-7:parseInt(c[k],10):0,a[k]<c[k]){g=-1;break}if(a[k]>c[k]){g=1;break}}if(!b)return g;switch(b){case ">":case "gt":return 0<g;case ">=":case "ge":return 0<=
g;case "<=":case "le":return 0>=g;case "==":case "=":case "eq":return 0===g;case "<>":case "!=":case "ne":return 0!==g;case "":case "<":case "lt":return 0>g;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return a.OS=a.os,a});g("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(b){var c=function(a,d){return a.className?RegExp("(^|\\s+)"+d+"(\\s+|$)").test(a.className):!1};return{get:function(a){return"string"!=
typeof a?a:document.getElementById(a)},hasClass:c,addClass:function(a,d){c(a,d)||(a.className=a.className?a.className.replace(/\s+$/,"")+" "+d:d)},removeClass:function(a,d){a.className&&(a.className=a.className.replace(RegExp("(^|\\s+)"+d+"(\\s+|$)"),function(a,d,c){return" "===d&&" "===c?" ":""}))},getStyle:function(a,d){return a.currentStyle?a.currentStyle[d]:window.getComputedStyle?window.getComputedStyle(a,null)[d]:void 0},getPos:function(a,d){function c(a){var d,b,e=0,k=0;return a&&(b=a.getBoundingClientRect(),
d="CSS1Compat"===g.compatMode?g.documentElement:g.body,e=b.left+d.scrollLeft,k=b.top+d.scrollTop),{x:e,y:k}}var n=0,l=0,f,g=document,h;if(d=d||g.body,a&&a.getBoundingClientRect&&"IE"===b.browser&&(!g.documentMode||8>g.documentMode))return f=c(a),h=c(d),{x:f.x-h.x,y:f.y-h.y};for(f=a;f&&f!=d&&f.nodeType;)n+=f.offsetLeft||0,l+=f.offsetTop||0,f=f.offsetParent;for(f=a.parentNode;f&&f!=d&&f.nodeType;)n-=f.scrollLeft||0,l-=f.scrollTop||0,f=f.parentNode;return{x:n,y:l}},getSize:function(a){return{w:a.offsetWidth||
a.clientWidth,h:a.offsetHeight||a.clientHeight}}}});g("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(b){function c(a,d){for(var c in a)if(a[c]===d)return c;return null}return{RuntimeError:function(){function a(a){this.code=a;this.name=c(d,a);this.message=this.name+": RuntimeError "+this.code}var d={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return b.extend(a,d),a.prototype=Error.prototype,a}(),OperationNotAllowedException:function(){function a(a){this.code=a;this.name="OperationNotAllowedException"}
return b.extend(a,{NOT_ALLOWED_ERR:1}),a.prototype=Error.prototype,a}(),ImageError:function(){function a(a){this.code=a;this.name=c(d,a);this.message=this.name+": ImageError "+this.code}var d={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return b.extend(a,d),a.prototype=Error.prototype,a}(),FileException:function(){function a(a){this.code=a;this.name=c(d,a);this.message=this.name+": FileException "+this.code}var d={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,
INVALID_STATE_ERR:7,SYNTAX_ERR:8};return b.extend(a,d),a.prototype=Error.prototype,a}(),DOMException:function(){function a(a){this.code=a;this.name=c(d,a);this.message=this.name+": DOMException "+this.code}var d={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,
INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return b.extend(a,d),a.prototype=Error.prototype,a}(),EventException:function(){function a(a){this.code=a;this.name="EventException"}return b.extend(a,{UNSPECIFIED_EVENT_TYPE_ERR:0}),a.prototype=Error.prototype,a}()}});g("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],
function(b,c){function a(){var a={};c.extend(this,{uid:null,init:function(){this.uid||(this.uid=c.guid("uid_"))},addEventListener:function(b,k,l,f){var g=this,h;return b=c.trim(b),/\s/.test(b)?void c.each(b.split(/\s+/),function(a){g.addEventListener(a,k,l,f)}):(b=b.toLowerCase(),l=parseInt(l,10)||0,h=a[this.uid]&&a[this.uid][b]||[],h.push({fn:k,priority:l,scope:f||this}),a[this.uid]||(a[this.uid]={}),void(a[this.uid][b]=h))},hasEventListener:function(c){return c?!(!a[this.uid]||!a[this.uid][c]):
!!a[this.uid]},removeEventListener:function(b,k){b=b.toLowerCase();var l=a[this.uid]&&a[this.uid][b],f;if(l){if(k)for(f=l.length-1;0<=f;f--){if(l[f].fn===k){l.splice(f,1);break}}else l=[];l.length||(delete a[this.uid][b],c.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(e){var n,l,f,g={},h=!0;if("string"!==c.typeOf(e)){if(l=e,"string"!==c.typeOf(l.type))throw new b.EventException(b.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
e=l.type;void 0!==l.total&&void 0!==l.loaded&&(g.total=l.total,g.loaded=l.loaded);g.async=l.async||!1}if(-1!==e.indexOf("::")?!function(a){n=a[0];e=a[1]}(e.split("::")):n=this.uid,e=e.toLowerCase(),l=a[n]&&a[n][e]){l.sort(function(a,d){return d.priority-a.priority});f=[].slice.call(arguments);f.shift();g.type=e;f.unshift(g);var v=[];c.each(l,function(a){f[0].target=a.scope;v.push(g.async?function(d){setTimeout(function(){d(!1===a.fn.apply(a.scope,f))},1)}:function(d){d(!1===a.fn.apply(a.scope,f))})});
v.length&&c.inSeries(v,function(a){h=!a})}return h},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var d;"array"!==c.typeOf(a)&&(a=[a]);for(var b=0;b<a.length;b++)d="on"+a[b],"function"===c.typeOf(this[d])?this.addEventListener(a[b],this[d]):
"undefined"===c.typeOf(this[d])&&(this[d]=null)}})}return a.instance=new a,a});g("moxie/core/utils/Encode",[],function(){var b=function(a){return unescape(encodeURIComponent(a))},c=function(a){return decodeURIComponent(escape(a))};return{utf8_encode:b,utf8_decode:c,atob:function(a,d){if("function"==typeof window.atob)return d?c(window.atob(a)):window.atob(a);var b,k,l,f,g,h=0,v=0,s="",p=[];if(!a)return a;a+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),
k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)),l=b<<18|k<<12|f<<6|g,b=l>>16&255,k=l>>8&255,l&=255,p[v++]=64==f?String.fromCharCode(b):64==g?String.fromCharCode(b,k):String.fromCharCode(b,k,l);while(h<a.length);return s=p.join(""),d?c(s):s},btoa:function(a,d){if(d&&b(a),
"function"==typeof window.btoa)return window.btoa(a);var c,n,l,f,g=0,h=0,v="",v=[];if(!a)return a;do c=a.charCodeAt(g++),n=a.charCodeAt(g++),l=a.charCodeAt(g++),f=c<<16|n<<8|l,c=f>>18&63,n=f>>12&63,l=f>>6&63,f&=63,v[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f);
while(g<a.length);v=v.join("");g=a.length%3;return(g?v.slice(0,g-3):v)+"===".slice(g||3)}}});g("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(b,c,a){function d(a,e,f,g,h){var s=this,p,m=b.guid(e+"_");h=h||"browser";a=a||{};n[m]=this;f=b.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,
return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},f);a.preferred_caps&&(h=d.getMode(g,a.preferred_caps,h));p=function(){var a={};return{exec:function(d,b,c,e){return p[b]&&(a[d]||(a[d]={context:this,instance:new p[b]}),a[d].instance[c])?a[d].instance[c].apply(this,e):void 0},removeInstance:function(d){delete a[d]},
removeAllInstances:function(){var d=this;b.each(a,function(a,c){"function"===b.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);d.removeInstance(c)})}}}();b.extend(this,{initialized:!1,uid:m,type:e,mode:d.getMode(g,a.required_caps,h),shimid:m+"_container",clients:0,options:a,can:function(a,c,e){e=e||f;if("string"===b.typeOf(a)&&"undefined"===b.typeOf(c)&&(a=d.parseCaps(a)),"object"===b.typeOf(a)){for(var l in a)if(!this.can(l,a[l],e))return!1;return!0}return"function"===b.typeOf(e[a])?
e[a].call(this,c):c===e[a]},getShimContainer:function(){var a,d=c.get(this.shimid);return d||(a=this.options.container?c.get(this.options.container):document.body,d=document.createElement("div"),d.id=this.shimid,d.className="moxie-shim moxie-shim-"+this.type,b.extend(d.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(d)),d},getShim:function(){return p},shimExec:function(a,d){var b=[].slice.call(arguments,2);return s.getShim().exec.call(this,
this.uid,a,d,b)},exec:function(a,d){var b=[].slice.call(arguments,2);return s[a]&&s[a][d]?s[a][d].apply(this,b):s.shimExec.apply(this,arguments)},destroy:function(){if(s){var a=c.get(this.shimid);a&&a.parentNode.removeChild(a);p&&p.removeAllInstances();this.unbindAll();delete n[this.uid];m=s=p=this.uid=null}}});this.mode&&a.required_caps&&!this.can(a.required_caps)&&(this.mode=!1)}var e={},n={};return d.order="html5,flash,silverlight,html4",d.getRuntime=function(a){return n[a]?n[a]:!1},d.addConstructor=
function(d,b){b.prototype=a.instance;e[d]=b},d.getConstructor=function(a){return e[a]||null},d.getInfo=function(a){var b=d.getRuntime(a);return b?{uid:b.uid,type:b.type,mode:b.mode,can:function(){return b.can.apply(b,arguments)}}:null},d.parseCaps=function(a){var d={};return"string"!==b.typeOf(a)?a||{}:(b.each(a.split(","),function(a){d[a]=!0}),d)},d.can=function(a,b){var c,e=d.getConstructor(a),k;return e?(c=new e({required_caps:b}),k=c.mode,c.destroy(),!!k):!1},d.thatCan=function(a,b){var c=(b||
d.order).split(/\s*,\s*/),e;for(e in c)if(d.can(c[e],a))return c[e];return null},d.getMode=function(a,d,c){var e=null;if("undefined"===b.typeOf(c)&&(c="browser"),d&&!b.isEmptyObj(a)){if(b.each(d,function(d,c){if(a.hasOwnProperty(c)){var n=a[c](d);if("string"==typeof n&&(n=[n]),e){if(!(e=b.arrayIntersect(e,n)))return e=!1}else e=n}}),e)return-1!==b.inArray(c,e)?c:e[0];if(!1===e)return!1}return c},d.capTrue=function(){return!0},d.capFalse=function(){return!1},d.capTest=function(a){return function(){return!!a}},
d});g("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(b,c,a){return function(){var d;c.extend(this,{connectRuntime:function(e){function n(c){var f,g;return c.length?(f=c.shift(),(g=a.getConstructor(f))?(d=new g(e),d.bind("Init",function(){d.initialized=!0;setTimeout(function(){d.clients++;l.trigger("RuntimeInit",d)},1)}),d.bind("Error",function(){d.destroy();n(c)}),d.mode?void d.init():void d.trigger("Error")):void n(c)):(l.trigger("RuntimeError",
new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)),void(d=null))}var l=this,f;if("string"===c.typeOf(e)?f=e:"string"===c.typeOf(e.ruid)&&(f=e.ruid),f){if(d=a.getRuntime(f))return d.clients++,d;throw new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR);}n((e.runtime_order||a.order).split(/\s*,\s*/))},getRuntime:function(){return d&&d.uid?d:(d=null,null)},disconnectRuntime:function(){d&&0>=--d.clients&&(d.destroy(),d=null)}})}});g("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],
function(b,c,a){function d(n,l){function f(a,c,l){var n,g=e[this.uid];return"string"===b.typeOf(g)&&g.length?(n=new d(null,{type:l,size:c-a}),n.detach(g.substr(a,n.size)),n):null}a.call(this);n&&this.connectRuntime(n);l?"string"===b.typeOf(l)&&(l={data:l}):l={};b.extend(this,{uid:l.uid||b.guid("uid_"),ruid:n,size:l.size||0,type:l.type||"",slice:function(a,d,b){return this.isDetached()?f.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,d,b)},getSource:function(){return e[this.uid]?
e[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null);a=a||"";var d=a.match(/^data:([^;]*);base64,/);d&&(this.type=d[1],a=c.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;e[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===b.typeOf(e[this.uid])},destroy:function(){this.detach();delete e[this.uid]}});l.data?this.detach(l.data):e[this.uid]=l}var e={};return d});g("moxie/file/File",["moxie/core/utils/Basic",
"moxie/core/utils/Mime","moxie/file/Blob"],function(b,c,a){function d(d,n){var l,f;(n||(n={}),f=n.type&&""!==n.type?n.type:c.getFileMime(n.name),n.name)?(l=n.name.replace(/\\/g,"/"),l=l.substr(l.lastIndexOf("/")+1)):(l=f.split("/")[0],l=b.guid((""!==l?l:"file")+"_"),c.extensions[f]&&(l+="."+c.extensions[f][0]));a.apply(this,arguments);b.extend(this,{type:f||"",name:l||b.guid("file_"),lastModifiedDate:n.lastModifiedDate||(new Date).toLocaleString()})}return d.prototype=a.prototype,d});g("moxie/file/FileInput",
"moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),function(b,c,a,d,e,n,l,f,g){function h(e){var p=this,m;if(-1!==b.inArray(b.typeOf(e),["string","node"])&&(e={browse_button:e}),m=a.get(e.browse_button),!m)throw new d.DOMException(d.DOMException.NOT_FOUND_ERR);m={accept:[{title:n.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,
container:m.parentNode||document.body};e=b.extend({},m,e);"string"==typeof e.required_caps&&(e.required_caps=f.parseCaps(e.required_caps));"string"==typeof e.accept&&(e.accept=c.mimes2extList(e.accept));(m=a.get(e.container))||(m=document.body);"static"===a.getStyle(m,"position")&&(m.style.position="relative");m=m=null;g.call(p);b.extend(p,{uid:b.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){p.convertEventPropsToHandlers(v);p.bind("RuntimeInit",function(d,c){p.ruid=c.uid;p.shimid=
c.shimid;p.bind("Ready",function(){p.trigger("Refresh")},999);p.bind("Change",function(){var a=c.exec.call(p,"FileInput","getFiles");p.files=[];b.each(a,function(a){return 0===a.size?!0:void p.files.push(new l(p.ruid,a))})},999);p.bind("Refresh",function(){var d,l,n,f;n=a.get(e.browse_button);f=a.get(c.shimid);n&&(d=a.getPos(n,a.get(e.container)),l=a.getSize(n),f&&b.extend(f.style,{top:d.y+"px",left:d.x+"px",width:l.w+"px",height:l.h+"px"}))});c.exec.call(p,"FileInput","init",e)});p.connectRuntime(b.extend({},
e,{required_caps:{select_file:!0}}))},disable:function(a){var d=this.getRuntime();d&&d.exec.call(this,"FileInput","disable","undefined"===b.typeOf(a)?!0:a)},refresh:function(){p.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===b.typeOf(this.files)&&b.each(this.files,function(a){a.destroy()});this.files=null}})}var v="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");return h.prototype=
e.instance,h});g("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),function(b,c,a,d,e,n,l,f){function g(a){var l=this,p;"string"==typeof a&&(a={drop_zone:a});p={accept:[{title:b.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};a="object"==typeof a?d.extend({},p,a):p;a.container=c.get(a.drop_zone)||document.body;"static"===
c.getStyle(a.container,"position")&&(a.container.style.position="relative");"string"==typeof a.accept&&(a.accept=f.mimes2extList(a.accept));n.call(l);d.extend(l,{uid:d.guid("uid_"),ruid:null,files:null,init:function(){l.convertEventPropsToHandlers(h);l.bind("RuntimeInit",function(b,c){l.ruid=c.uid;l.bind("Drop",function(){var a=c.exec.call(l,"FileDrop","getFiles");l.files=[];d.each(a,function(a){l.files.push(new e(l.ruid,a))})},999);c.exec.call(l,"FileDrop","init",a);l.dispatchEvent("ready")});l.connectRuntime(a)},
destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var h=["ready","dragenter","dragleave","drop","error"];return g.prototype=l.instance,g});g("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(b,c,a){function d(){this.uid=b.guid("uid_");c.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}return d.prototype=a.instance,d});
g("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(b,c,a,d,e,n,l){function f(){function d(b,k){function m(a){n.readyState=f.DONE;n.error=a;n.trigger("error");D()}function D(){h.destroy();h=null;n.trigger("loadend")}function t(a){h.bind("Error",function(a,b){m(b)});h.bind("Progress",function(b){n.result=a.exec.call(h,"FileReader","getResult");n.trigger(b)});
h.bind("Load",function(b){n.readyState=f.DONE;n.result=a.exec.call(h,"FileReader","getResult");n.trigger(b);D()});a.exec.call(h,"FileReader","read",b,k)}if(h=new l,this.convertEventPropsToHandlers(g),this.readyState===f.LOADING)return m(new a.DOMException(a.DOMException.INVALID_STATE_ERR));if(this.readyState=f.LOADING,this.trigger("loadstart"),k instanceof e)if(k.isDetached()){var u=k.getSource();switch(b){case "readAsText":case "readAsBinaryString":this.result=u;break;case "readAsDataURL":this.result=
"data:"+k.type+";base64,"+c.btoa(u)}this.readyState=f.DONE;this.trigger("load");D()}else t(h.connectRuntime(k.ruid));else m(new a.DOMException(a.DOMException.NOT_FOUND_ERR))}var n=this,h;b.extend(this,{uid:b.guid("uid_"),readyState:f.EMPTY,result:null,error:null,readAsBinaryString:function(a){d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){d.call(this,"readAsDataURL",a)},readAsText:function(a){d.call(this,"readAsText",a)},abort:function(){this.result=null;-1===b.inArray(this.readyState,
[f.EMPTY,f.DONE])&&(this.readyState===f.LOADING&&(this.readyState=f.DONE),h&&h.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();h&&(h.getRuntime().exec.call(this,"FileReader","destroy"),h.disconnectRuntime());n=h=null}})}var g="loadstart progress load abort error loadend".split(" ");return f.EMPTY=0,f.LOADING=1,f.DONE=2,f.prototype=d.instance,f});g("moxie/core/utils/Url",[],function(){var b=function(c,a){for(var d="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),
e=d.length,n={http:80,https:443},l={},f=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(c||"");e--;)f[e]&&(l[d[e]]=f[e]);l.scheme||(a&&"string"!=typeof a||(a=b(a||document.location.href)),l.scheme=a.scheme,l.host=a.host,l.port=a.port,d="",/^[^\/]/.test(l.path)&&(d=a.path,/(\/|\/[^\.]+)$/.test(d)?d+="/":d=d.replace(/\/[^\/]+$/,"/")),l.path=d+(l.path||""));return l.port||(l.port=n[l.scheme]||
80),l.port=parseInt(l.port,10),l.path||(l.path="/"),delete l.source,l};return{parseUrl:b,resolveUrl:function(c){c=b(c);return c.scheme+"://"+c.host+(c.port!=={http:80,https:443}[c.scheme]?":"+c.port:"")+c.path+(c.query?c.query:"")},hasSameOrigin:function(c){function a(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof c&&(c=b(c)),a(b())===a(c)}}});g("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(b,c,a){return function(){function d(b,
d){if(!d.isDetached()){var c=this.connectRuntime(d.ruid).exec.call(this,"FileReaderSync","read",b,d);return this.disconnectRuntime(),c}c=d.getSource();switch(b){case "readAsBinaryString":return c;case "readAsDataURL":return"data:"+d.type+";base64,"+a.btoa(c);case "readAsText":for(var k="",f=0,g=c.length;g>f;f++)k+=String.fromCharCode(c[f]);return k}}c.call(this);b.extend(this,{uid:b.guid("uid_"),readAsBinaryString:function(a){return d.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return d.call(this,
"readAsDataURL",a)},readAsText:function(a){return d.call(this,"readAsText",a)}})}});g("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(b,c,a){return function(){var b,e=[];c.extend(this,{append:function(k,l){var f=this,g=c.typeOf(l);l instanceof a?b={name:k,value:l}:"array"===g?(k+="[]",c.each(l,function(a){f.append(k,a)})):"object"===g?c.each(l,function(a,b){f.append(k+"["+b+"]",a)}):"null"===g||"undefined"===g||"number"===g&&isNaN(l)?f.append(k,"false"):
e.push({name:k,value:l.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return b&&b.value||null},getBlobName:function(){return b&&b.name||null},each:function(a){c.each(e,function(b){a(b.value,b.name)});b&&a(b.value,b.name)},destroy:function(){b=null;e=[]}})}});g("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),
function(b,c,a,d,e,f,l,g,h,m,v,s){function p(){this.uid=b.guid("uid_")}function q(){function a(b,d){return B.hasOwnProperty(b)?1===arguments.length?v.can("define_property")?B[b]:H[b]:void(v.can("define_property")?B[b]=d:H[b]=d):void 0}function h(d){function c(){F&&(F.destroy(),F=null);g.dispatchEvent("loadend");g=null}function e(l){F.bind("LoadStart",function(b){a("readyState",q.LOADING);g.dispatchEvent("readystatechange");g.dispatchEvent(b);M&&g.upload.dispatchEvent(b)});F.bind("Progress",function(b){a("readyState")!==
q.LOADING&&(a("readyState",q.LOADING),g.dispatchEvent("readystatechange"));g.dispatchEvent(b)});F.bind("UploadProgress",function(a){M&&g.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});F.bind("Load",function(d){a("readyState",q.DONE);a("status",Number(l.exec.call(F,"XMLHttpRequest","getStatus")||0));a("statusText",w[a("status")]||"");a("response",l.exec.call(F,"XMLHttpRequest","getResponse",a("responseType")));~b.inArray(a("responseType"),["text",""])?a("responseText",
a("response")):"document"===a("responseType")&&a("responseXML",a("response"));Q=l.exec.call(F,"XMLHttpRequest","getAllResponseHeaders");g.dispatchEvent("readystatechange");0<a("status")?(M&&g.upload.dispatchEvent(d),g.dispatchEvent(d)):(R=!0,g.dispatchEvent("error"));c()});F.bind("Abort",function(a){g.dispatchEvent(a);c()});F.bind("Error",function(b){R=!0;a("readyState",q.DONE);g.dispatchEvent("readystatechange");S=!0;g.dispatchEvent(b);c()});l.exec.call(F,"XMLHttpRequest","send",{url:x,method:C,
async:G,user:J,password:N,headers:K,mimeType:E,encoding:O,responseType:g.responseType,withCredentials:g.withCredentials,options:I},d)}var g=this;(new Date).getTime();F=new l;"string"==typeof I.required_caps&&(I.required_caps=f.parseCaps(I.required_caps));I.required_caps=b.extend({},I.required_caps,{return_response_type:g.responseType});d instanceof m&&(I.required_caps.send_multipart=!0);T||(I.required_caps.do_cors=!0);I.ruid?e(F.connectRuntime(I)):(F.bind("RuntimeInit",function(a,b){e(b)}),F.bind("RuntimeError",
function(a,b){g.dispatchEvent("RuntimeError",b)}),F.connectRuntime(I))}var H=this,B={timeout:0,readyState:q.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},G=!0,x,C,K={},J,N,O=null,E=null,L=!1,A=!1,M=!1,S=!1,R=!1,T=!1,I={},F,Q="",P;b.extend(this,B,{uid:b.guid("uid_"),upload:new p,open:function(l,f,n,g,h){var r;if(!l||!f)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(l)||d.utf8_encode(l)!==l)throw new c.DOMException(c.DOMException.SYNTAX_ERR);
if(~b.inArray(l.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(C=l.toUpperCase()),~b.inArray(C,["CONNECT","TRACE","TRACK"]))throw new c.DOMException(c.DOMException.SECURITY_ERR);if(f=d.utf8_encode(f),r=e.parseUrl(f),T=e.hasSameOrigin(r),x=e.resolveUrl(f),(g||h)&&!T)throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);if(J=g||r.user,N=h||r.pass,G=n||!0,!1===G&&(a("timeout")||a("withCredentials")||""!==a("responseType")))throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);
L=!G;A=!1;K={};a("responseText","");a("responseXML",null);a("response",null);a("status",0);a("statusText","");a("readyState",q.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(e,l){if(a("readyState")!==q.OPENED||A)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(e)||d.utf8_encode(e)!==e)throw new c.DOMException(c.DOMException.SYNTAX_ERR);return e=b.trim(e).toLowerCase(),~b.inArray(e,
"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(e)?!1:(K[e]?K[e]+=", "+l:K[e]=l,!0)},getAllResponseHeaders:function(){return Q||""},getResponseHeader:function(a){return a=a.toLowerCase(),R||~b.inArray(a,["set-cookie","set-cookie2"])?null:Q&&""!==Q&&(P||(P=
{},b.each(Q.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=b.trim(a[0]),P[a[0].toLowerCase()]={header:a[0],value:b.trim(a[1])})})),P.hasOwnProperty(a))?P[a].header+": "+P[a].value:null},overrideMimeType:function(d){var e;if(~b.inArray(a("readyState"),[q.LOADING,q.DONE]))throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(d=b.trim(d.toLowerCase()),/;/.test(d)&&(e=d.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(d=e[1]),!s.mimes[d])throw new c.DOMException(c.DOMException.SYNTAX_ERR);
},send:function(a,e){if(I="string"===b.typeOf(e)?{ruid:e}:e?e:{},this.convertEventPropsToHandlers(z),this.upload.convertEventPropsToHandlers(z),this.readyState!==q.OPENED||A)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(a instanceof g)I.ruid=a.ruid,E=a.type||"application/octet-stream";else if(a instanceof m){if(a.hasBlob()){var l=a.getBlob();I.ruid=l.ruid;E=l.type||"application/octet-stream"}}else"string"==typeof a&&(O="UTF-8",E="text/plain;charset=UTF-8",a=d.utf8_encode(a));this.withCredentials||
(this.withCredentials=I.required_caps&&I.required_caps.send_browser_cookies&&!T);M=!L&&this.upload.hasEventListener();R=!1;S=!a;L||(A=!0);h.call(this,a)},abort:function(){if(R=!0,L=!1,~b.inArray(a("readyState"),[q.UNSENT,q.OPENED,q.DONE]))a("readyState",q.UNSENT);else{if(a("readyState",q.DONE),A=!1,!F)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);F.getRuntime().exec.call(F,"XMLHttpRequest","abort",S);S=!0}},destroy:function(){F&&("function"===b.typeOf(F.destroy)&&F.destroy(),F=null);
this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var w={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",
403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",
503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};p.prototype=a.instance;var z="loadstart progress abort error load timeout loadend".split(" ");return q.UNSENT=0,q.OPENED=1,q.HEADERS_RECEIVED=2,q.LOADING=3,q.DONE=4,q.prototype=a.instance,q});g("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(b,c,
a,d){function e(){function d(a,c){var f=this;g=c;f.bind("TransportingProgress",function(a){s=a.loaded;m>s&&-1===b.inArray(f.state,[e.IDLE,e.DONE])&&l.call(f)},999);f.bind("TransportingComplete",function(){s=m;f.state=e.DONE;h=null;f.result=g.exec.call(f,"Transporter","getAsBlob",a||"")},999);f.state=e.BUSY;f.trigger("TransportingStarted");l.call(f)}function l(){var a;a=m-s;p>a&&(p=a);a=c.btoa(h.substr(s,p));g.exec.call(this,"Transporter","receive",a,m)}var f,g,h,m,s,p;a.call(this);b.extend(this,{uid:b.guid("uid_"),
state:e.IDLE,result:null,transport:function(a,c,e){var l=this;e=b.extend({chunk_size:204798},e);(f=e.chunk_size%3)&&(e.chunk_size+=3-f);p=e.chunk_size;m=s=0;h=this.result=null;if(h=a,m=a.length,"string"===b.typeOf(e)||e.ruid)d.call(l,c,this.connectRuntime(e));else{var g=function(a,b){l.unbind("RuntimeInit",g);d.call(l,c,b)};this.bind("RuntimeInit",g);this.connectRuntime(e)}},abort:function(){this.state=e.IDLE;g&&(g.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));m=s=0;h=
this.result=null},destroy:function(){this.unbindAll();g=null;this.disconnectRuntime();m=s=0;h=this.result=null}})}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=d.instance,e});g("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
function(b,c,a,d,e,f,l,g,h,m,v,s,p){function q(){function d(c){var e=b.typeOf(c);try{if(c instanceof q){if(!c.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);m.apply(this,arguments)}else if(c instanceof v){if(!~b.inArray(c.type,["image/jpeg","image/png"]))throw new a.ImageError(a.ImageError.WRONG_FORMAT);D.apply(this,arguments)}else if(-1!==b.inArray(e,["blob","file"]))d.call(this,new s(null,c),arguments[1]);else if("string"===e)/^data:[^;]*;base64,/.test(c)?d.call(this,new v(null,
{data:c}),arguments[1]):y.apply(this,arguments);else{if("node"!==e||"img"!==c.nodeName.toLowerCase())throw new a.DOMException(a.DOMException.TYPE_MISMATCH_ERR);d.call(this,c.src,arguments[1])}}catch(l){this.trigger("error",l.code)}}function m(a,d){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===b.typeOf(d)?!0:d)}function D(a,d){function c(b){e.ruid=b.uid;b.exec.call(e,"Image","loadFromBlob",a)}var e=this;e.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
function(a,b){c(b)}),d&&"string"==typeof d.required_caps&&(d.required_caps=f.parseCaps(d.required_caps)),this.connectRuntime(b.extend({required_caps:{access_image_binary:!0,resize_image:!0}},d))):c(this.connectRuntime(a.ruid))}function y(a,b){var d=this,c;c=new e;c.open("get",a);c.responseType="blob";c.onprogress=function(a){d.trigger(a)};c.onload=function(){D.call(d,c.response,!0)};c.onerror=function(a){d.trigger(a)};c.onloadend=function(){c.destroy()};c.bind("RuntimeError",function(a,b){d.trigger("RuntimeError",
b)});c.send(null,b)}l.call(this);b.extend(this,{uid:b.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a=void 0,a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(w);d.apply(this,arguments)},downsize:function(d,
c,e,l){var f={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};d="object"==typeof d?b.extend(f,d):b.extend(f,{width:d,height:c,crop:e,preserveHeaders:l});try{if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);if(this.width>q.MAX_RESIZE_WIDTH||this.height>q.MAX_RESIZE_HEIGHT)throw new a.ImageError(a.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",d.width,d.height,d.crop,d.preserveHeaders)}catch(n){this.trigger("error",n.code)}},
crop:function(a,b,d){this.downsize(a,b,!0,d)},getAsCanvas:function(){if(!h.can("create_canvas"))throw new a.RuntimeError(a.RuntimeError.NOT_SUPPORTED_ERR);return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(b,d){if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);return b||(b="image/jpeg"),"image/jpeg"!==b||d||(d=90),this.getRuntime().exec.call(this,"Image","getAsBlob",b,d)},getAsDataURL:function(b,d){if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);
return this.getRuntime().exec.call(this,"Image","getAsDataURL",b,d)},getAsBinaryString:function(a,b){var d=this.getAsDataURL(a,b);return p.atob(d.substring(d.indexOf("base64,")+7))},embed:function(d,e){function l(){if(h.can("create_canvas")){var c=n.getAsCanvas();if(c)return d.appendChild(c),c=null,n.destroy(),void f.trigger("embedded")}c=n.getAsDataURL(s,m);if(!c)throw new a.ImageError(a.ImageError.WRONG_FORMAT);if(h.can("use_data_uri_of",c.length))d.innerHTML='<img src="'+c+'" width="'+n.width+
'" height="'+n.height+'" />',n.destroy(),f.trigger("embedded");else{var e=new g;e.bind("TransportingComplete",function(){M=f.connectRuntime(this.result.ruid);f.bind("Embedded",function(){b.extend(M.getShimContainer().style,{top:"0px",left:"0px",width:n.width+"px",height:n.height+"px"});M=null},999);M.exec.call(f,"ImageView","display",this.result.uid,t,z);n.destroy()});e.transport(p.atob(c.substring(c.indexOf("base64,")+7)),s,b.extend({},D,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",
container:d}))}}var f=this,n,s,m,v,D=e||{},t=this.width,z=this.height,M;try{if(!(d=c.get(d)))throw new a.DOMException(a.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);if(this.width>q.MAX_RESIZE_WIDTH||this.height>q.MAX_RESIZE_HEIGHT)throw new a.ImageError(a.ImageError.MAX_RESOLUTION_ERR);if(s=D.type||this.type||"image/jpeg",m=D.quality||90,v="undefined"!==b.typeOf(D.crop)?D.crop:!1,D.width)t=D.width,z=D.height||t;else{var u=c.getSize(d);
u.w&&u.h&&(t=u.w,z=u.h)}return n=new q,n.bind("Resize",function(){l.call(f)}),n.bind("Load",function(){n.downsize(t,z,v,!1)}),n.clone(this,!1),n}catch(w){this.trigger("error",w.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var w=["progress","load","error","resize","embedded"];return q.MAX_RESIZE_WIDTH=6500,q.MAX_RESIZE_HEIGHT=6500,q.prototype=m.instance,q});g("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic",
"moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(b,c,a,d){var e={};return a.addConstructor("html5",function(c,l,f){var g=this,h=a.capTest,m=a.capTrue;f=b.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return g.can("access_binary")&&!!e.Image},display_media:h(d.can("create_canvas")||d.can("use_data_uri_over32kb")),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var a=
document.createElement("div");return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==d.browser||9<d.version)}()),filter_by_extension:h("Chrome"===d.browser&&28<=d.version||"IE"===d.browser&&10<=d.version),return_response_headers:m,return_response_type:function(a){return"json"===a&&window.JSON?!0:d.can("return_response_type",a)},return_status_code:m,report_upload_progress:h(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return g.can("access_binary")&&d.can("create_canvas")},
select_file:function(){return d.can("use_fileinput")&&window.File},select_folder:function(){return g.can("select_file")&&"Chrome"===d.browser&&21<=d.version},select_multiple:function(){return!(!g.can("select_file")||"Safari"===d.browser&&"Windows"===d.os||"iOS"===d.os&&d.verComp(d.osVersion,"7.0.4","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&
(new XMLHttpRequest).upload&&window.FormData)||g.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return g.can("slice_blob")&&g.can("send_multipart")},summon_file_dialog:h("Firefox"===d.browser&&4<=d.version||"Opera"===d.browser&&12<=d.version||"IE"===d.browser&&10<=d.version||!!~b.inArray(d.browser,["Chrome","Safari"])),upload_filesize:m},f);a.call(this,c,l||"html5",f);b.extend(this,{init:function(){this.trigger("Init")},
destroy:function(a){return function(){a.call(g);a=g=null}}(this.destroy)});b.extend(this.getShim(),e)}),e});g("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(b,c){return b.Blob=function(){function a(a,b,c){var l;if(!window.File.prototype.slice)return(l=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?l.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(k){return a.slice(b,c-b)}}this.slice=function(){return new c(this.getRuntime().uid,
a.apply(this,arguments))}}});g("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(b){function c(){this.returnValue=!1}function a(){this.cancelBubble=!0}var d={},e="moxie_"+b.guid(),f=function(a,c,f){var n;if(c=c.toLowerCase(),a[e]&&d[a[e]]&&d[a[e]][c]){n=d[a[e]][c];for(var g=n.length-1;0<=g&&(n[g].orig!==f&&n[g].key!==f||(a.removeEventListener?a.removeEventListener(c,n[g].func,!1):a.detachEvent&&a.detachEvent("on"+c,n[g].func),n[g].orig=null,n[g].func=null,n.splice(g,1),void 0===f));g--);
if(n.length||delete d[a[e]][c],b.isEmptyObj(d[a[e]])){delete d[a[e]];try{delete a[e]}catch(h){a[e]=void 0}}}};return{addEvent:function(l,f,n,g){var h;f=f.toLowerCase();l.addEventListener?(h=n,l.addEventListener(f,h,!1)):l.attachEvent&&(h=function(){var b=window.event;b.target||(b.target=b.srcElement);b.preventDefault=c;b.stopPropagation=a;n(b)},l.attachEvent("on"+f,h));l[e]||(l[e]=b.guid());d.hasOwnProperty(l[e])||(d[l[e]]={});l=d[l[e]];l.hasOwnProperty(f)||(l[f]=[]);l[f].push({func:h,orig:n,key:g})},
removeEvent:f,removeAllEvents:function(a,c){a&&a[e]&&b.each(d[a[e]],function(b,d){f(a,d,c)})}}});g("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(b,c,a,d,e,f){return b.FileInput=function(){var b=[],k;c.extend(this,{init:function(g){var h=this,m=h.getRuntime(),s,p,q;k=g;b=[];g=k.accept.mimes||e.extList2mimes(k.accept,m.can("filter_by_extension"));s=
m.getShimContainer();s.innerHTML='<input id="'+m.uid+'" type="file" style="font-size:999px;opacity:0;"'+(k.multiple&&m.can("select_multiple")?"multiple":"")+(k.directory&&m.can("select_folder")?"webkitdirectory directory":"")+(g?' accept="'+g.join(",")+'"':"")+" />";g=a.get(m.uid);c.extend(g.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});p=a.get(k.browse_button);m.can("summon_file_dialog")&&("static"===a.getStyle(p,"position")&&(p.style.position="relative"),q=parseInt(a.getStyle(p,
"z-index"),10)||1,p.style.zIndex=q,s.style.zIndex=q-1,d.addEvent(p,"click",function(b){var d=a.get(m.uid);d&&!d.disabled&&d.click();b.preventDefault()},h.uid));q=m.can("summon_file_dialog")?p:s;d.addEvent(q,"mouseover",function(){h.trigger("mouseenter")},h.uid);d.addEvent(q,"mouseout",function(){h.trigger("mouseleave")},h.uid);d.addEvent(q,"mousedown",function(){h.trigger("mousedown")},h.uid);d.addEvent(a.get(k.container),"mouseup",function(){h.trigger("mouseup")},h.uid);g.onchange=function z(){if(b=
[],k.directory?c.each(this.files,function(a){"."!==a.name&&b.push(a)}):b=[].slice.call(this.files),"IE"!==f.browser&&"IEMobile"!==f.browser)this.value="";else{var a=this.cloneNode(!0);this.parentNode.replaceChild(a,this);a.onchange=z}h.trigger("change")};h.trigger({type:"ready",async:!0});s=null},getFiles:function(){return b},disable:function(b){var d=this.getRuntime(),c;(c=a.get(d.uid))&&(c.disabled=!!b)},destroy:function(){var c=this.getRuntime(),e=c.getShim(),c=c.getShimContainer();d.removeAllEvents(c,
this.uid);d.removeAllEvents(k&&a.get(k.container),this.uid);d.removeAllEvents(k&&a.get(k.browse_button),this.uid);c&&(c.innerHTML="");e.removeInstance(this.uid);b=k=null}})}});g("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(b,c,a,d,e){return b.FileDrop=function(){function b(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;a=c.toArray(a.dataTransfer.types||[]);return-1!==
c.inArray("Files",a)||-1!==c.inArray("public.file-url",a)||-1!==c.inArray("application/x-moz-file",a)}function l(a){for(var b=[],d=0;d<a.length;d++)[].push.apply(b,a[d].extensions.split(/\s*,\s*/));return-1===c.inArray("*",b)?b:[]}function k(a){if(!q.length)return!0;a=e.getFileExtension(a.name);return!a||-1!==c.inArray(a,q)}function f(a,b){var d=[];c.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?(a=a.getAsFile(),k(a)&&p.push(a)):d.push(b))});d.length?g(d,b):b()}function g(a,b){var d=
[];c.each(a,function(a){d.push(function(b){h(a,b)})});c.inSeries(d,function(){b()})}function h(a,b){a.isFile?a.file(function(a){k(a)&&p.push(a);b()},function(){b()}):a.isDirectory?m(a,b):b()}function m(a,b){function d(a){e.readEntries(function(b){b.length?([].push.apply(c,b),d(a)):a()},a)}var c=[],e=a.createReader();d(function(){g(c,b)})}var p=[],q=[],w;c.extend(this,{init:function(a){var e=this;w=a;q=l(w.accept);a=w.container;d.addEvent(a,"dragover",function(a){b(a)&&(a.preventDefault(),a.dataTransfer.dropEffect=
"copy")},e.uid);d.addEvent(a,"drop",function(a){b(a)&&(a.preventDefault(),p=[],a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?f(a.dataTransfer.items,function(){e.trigger("drop")}):(c.each(a.dataTransfer.files,function(a){k(a)&&p.push(a)}),e.trigger("drop")))},e.uid);d.addEvent(a,"dragenter",function(a){e.trigger("dragenter")},e.uid);d.addEvent(a,"dragleave",function(a){e.trigger("dragleave")},e.uid)},getFiles:function(){return p},destroy:function(){d.removeAllEvents(w&&a.get(w.container),
this.uid);p=q=w=null}})}});g("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(b,c,a){return b.FileReader=function(){var b,e=!1;a.extend(this,{read:function(c,l){var k=this;b=new window.FileReader;b.addEventListener("progress",function(a){k.trigger(a)});b.addEventListener("load",function(a){k.trigger(a)});b.addEventListener("error",function(a){k.trigger(a,b.error)});b.addEventListener("loadend",function(){b=null});"function"===
a.typeOf(b[c])?(e=!1,b[c](l.getSource())):"readAsBinaryString"===c&&(e=!0,b.readAsDataURL(l.getSource()))},getResult:function(){return b&&b.result?e?c.atob(b.result.substring(b.result.indexOf("base64,")+7)):b.result:null},abort:function(){b&&b.abort()},destroy:function(){b=null}})}});g("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),
function(b,c,a,d,e,f,l,g,h){return b.XMLHttpRequest=function(){function b(a,d){var c=this,e,l;e=d.getBlob().getSource();l=new window.FileReader;l.onload=function(){d.append(d.getBlobName(),new f(null,{type:e.type,data:l.result}));p.send.call(c,a,d)};l.readAsBinaryString(e)}function k(){var a;if(!window.XMLHttpRequest||"IE"===h.browser&&8>h.version)a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],d=0;d<b.length;d++)try{a=new ActiveXObject(b[d]);break a}catch(c){}a=void 0}else a=new window.XMLHttpRequest;
return a}function m(a){var b="----moxieboundary"+(new Date).getTime(),d="";if(!this.getRuntime().can("send_binary_string"))throw new g.RuntimeError(g.RuntimeError.NOT_SUPPORTED_ERR);return q.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),a.each(function(a,c){d+=a instanceof f?"--"+b+'\r\nContent-Disposition: form-data; name="'+c+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n":
"--"+b+'\r\nContent-Disposition: form-data; name="'+c+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n"}),d+="--"+b+"--\r\n"}var p=this,q,w;c.extend(this,{send:function(a,e){var g=this,r="Mozilla"===h.browser&&4<=h.version&&7>h.version,p="Android Browser"===h.browser,G=!1;if(w=a.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),q=k(),q.open(a.method,a.url,a.async,a.user,a.password),e instanceof f)e.isDetached()&&(G=!0),e=e.getSource();else if(e instanceof l){if(e.hasBlob())if(e.getBlob().isDetached())e=
m.call(g,e),G=!0;else if((r||p)&&"blob"===c.typeOf(e.getBlob().getSource())&&window.FileReader)return void b.call(g,a,e);if(e instanceof l){var x=new window.FormData;e.each(function(a,b){a instanceof f?x.append(b,a.getSource()):x.append(b,a)});e=x}}q.upload?(a.withCredentials&&(q.withCredentials=!0),q.addEventListener("load",function(a){g.trigger(a)}),q.addEventListener("error",function(a){g.trigger(a)}),q.addEventListener("progress",function(a){g.trigger(a)}),q.upload.addEventListener("progress",
function(a){g.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):q.onreadystatechange=function(){switch(q.readyState){case 3:var b,c;try{d.hasSameOrigin(a.url)&&(b=q.getResponseHeader("Content-Length")||0),q.responseText&&(c=q.responseText.length)}catch(e){b=c=0}g.trigger({type:"progress",lengthComputable:!!b,total:parseInt(b,10),loaded:c});break;case 4:q.onreadystatechange=function(){},g.trigger(0===q.status?"error":"load")}};c.isEmptyObj(a.headers)||c.each(a.headers,function(a,b){q.setRequestHeader(b,
a)});""!==a.responseType&&"responseType"in q&&(q.responseType="json"!==a.responseType||h.can("return_response_type","json")?a.responseType:"text");G?q.sendAsBinary?q.sendAsBinary(e):!function(){for(var a=new Uint8Array(e.length),b=0;b<e.length;b++)a[b]=255&e.charCodeAt(b);q.send(a.buffer)}():q.send(e);g.trigger("loadstart")},getStatus:function(){try{if(q)return q.status}catch(a){}return 0},getResponse:function(b){var d=this.getRuntime();try{switch(b){case "blob":var c=new e(d.uid,q.response),l=q.getResponseHeader("Content-Disposition");
if(l){var k=l.match(/filename=([\'\"'])([^\1]+)\1/);k&&(w=k[2])}return c.name=w,c.type||(c.type=a.getFileMime(w)),c;case "json":return h.can("return_response_type","json")?q.response:200===q.status&&window.JSON?JSON.parse(q.responseText):null;case "document":var f=q.responseXML,g=q.responseText;return"IE"===h.browser&&g&&f&&!f.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(q.getResponseHeader("Content-Type"))&&(f=new window.ActiveXObject("Microsoft.XMLDOM"),f.async=!1,f.validateOnParse=!1,f.loadXML(g)),
f&&("IE"===h.browser&&0!==f.parseError||!f.documentElement||"parsererror"===f.documentElement.tagName)?null:f;default:return""!==q.responseText?q.responseText:null}}catch(n){return null}},getAllResponseHeaders:function(){try{return q.getAllResponseHeaders()}catch(a){}return""},abort:function(){q&&q.abort()},destroy:function(){p=w=null}})}});g("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function b(c,k){var l=a?0:-8*(k-1),f=0,g;for(g=0;k>g;g++)f|=d.charCodeAt(c+g)<<Math.abs(l+
8*g);return f}function c(a,b,c){c=3===arguments.length?c:d.length-b-1;d=d.substr(0,b)+a+d.substr(c+b)}var a=!1,d;return{II:function(b){return b===m?a:void(a=b)},init:function(b){a=!1;d=b},SEGMENT:function(a,b,l){switch(arguments.length){case 1:return d.substr(a,d.length-a-1);case 2:return d.substr(a,b);case 3:c(l,a,b);break;default:return d}},BYTE:function(a){return b(a,1)},SHORT:function(a){return b(a,2)},LONG:function(d,f){var l;if(f===m)l=b(d,4);else{l="";var g=a?0:-24,h;for(h=0;4>h;h++)l+=String.fromCharCode(f>>
Math.abs(g+8*h)&255);c(l,d,4);l=void 0}return l},SLONG:function(a){a=b(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,c){var d="";for(c+=a;c>a;a++)d+=String.fromCharCode(b(a,1));return d}}}});g("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(b){return function a(d){var e=[],f,l,g,h=0;if(f=new b,f.init(d),65496===f.SHORT(0)){for(l=2;l<=d.length;)if(g=f.SHORT(l),65488<=g&&65495>=g)l+=2;else{if(65498===g||65497===g)break;h=f.SHORT(l+2)+2;65505<=
g&&65519>=g&&e.push({hex:g,name:"APP"+(15&g),start:l,length:h,segment:f.SEGMENT(l,h)});l+=h}return f.init(null),{headers:e,restore:function(a){var b,d;f.init(a);l=65504==f.SHORT(2)?4+f.SHORT(4):2;d=0;for(b=e.length;b>d;d++)f.SEGMENT(l,0,e[d].segment),l+=e[d].length;return a=f.SEGMENT(),f.init(null),a},strip:function(b){var d,e;e=new a(b);d=e.headers;e.purge();f.init(b);for(e=d.length;e--;)f.SEGMENT(d[e].start,d[e].length,"");return b=f.SEGMENT(),f.init(null),b},get:function(a){for(var b=[],d=0,l=
e.length;l>d;d++)e[d].name===a.toUpperCase()&&b.push(e[d].segment);return b},set:function(a,b){var d=[],l,f,k;"string"==typeof b?d.push(b):d=b;l=f=0;for(k=e.length;k>l&&(e[l].name===a.toUpperCase()&&(e[l].segment=d[f],e[l].length=d[f].length,f++),!(f>=d.length));l++);},purge:function(){e=[];f.init(null);f=null}}}}});g("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(b,c){return function(){function a(a,b){var c=d.SHORT(a),e,f,k,n,h,
t,u=[],y={};for(e=0;c>e;e++)if(t=a+12*e+2,k=b[d.SHORT(t)],k!==m){switch(n=d.SHORT(t+=2),h=d.LONG(t+=2),t+=4,u=[],n){case 1:case 7:4<h&&(t=d.LONG(t)+l.tiffHeader);for(f=0;h>f;f++)u[f]=d.BYTE(t+f);break;case 2:4<h&&(t=d.LONG(t)+l.tiffHeader);y[k]=d.STRING(t,h-1);continue;case 3:2<h&&(t=d.LONG(t)+l.tiffHeader);for(f=0;h>f;f++)u[f]=d.SHORT(t+2*f);break;case 4:1<h&&(t=d.LONG(t)+l.tiffHeader);for(f=0;h>f;f++)u[f]=d.LONG(t+4*f);break;case 5:t=d.LONG(t)+l.tiffHeader;for(f=0;h>f;f++)u[f]=d.LONG(t+4*f)/d.LONG(t+
4*f+4);break;case 9:t=d.LONG(t)+l.tiffHeader;for(f=0;h>f;f++)u[f]=d.SLONG(t+4*f);break;case 10:t=d.LONG(t)+l.tiffHeader;for(f=0;h>f;f++)u[f]=d.SLONG(t+4*f)/d.SLONG(t+4*f+4);break;default:continue}f=1==h?u[0]:u;y[k]=g.hasOwnProperty(k)&&"object"!=typeof f?g[k][f]:f}return y}var d,e,f,l={},g;return d=new c,e={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",
40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},g={ColorSpace:{1:"sRGB",0:"Uncalibrated"},
MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",
23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",
31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",
93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},
GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(b){l={tiffHeader:10};if(b!==m&&b.length)if(d.init(b),65505===d.SHORT(0)&&"EXIF\x00"===d.STRING(4,5).toUpperCase()){var c=l.tiffHeader;b=(d.II(18761==d.SHORT(c)),42!==d.SHORT(c+=2)?!1:(l.IFD0=l.tiffHeader+d.LONG(c+2),f=a(l.IFD0,e.tiff),"ExifIFDPointer"in f&&(l.exifIFD=l.tiffHeader+f.ExifIFDPointer,delete f.ExifIFDPointer),"GPSInfoIFDPointer"in f&&(l.gpsIFD=l.tiffHeader+f.GPSInfoIFDPointer,
delete f.GPSInfoIFDPointer),!0))}else b=!1;else b=!1;return b},TIFF:function(){return f},EXIF:function(){var d;if(d=a(l.exifIFD,e.exif),d.ExifVersion&&"array"===b.typeOf(d.ExifVersion)){for(var c=0,f="";c<d.ExifVersion.length;c++)f+=String.fromCharCode(d.ExifVersion[c]);d.ExifVersion=f}return d},GPS:function(){var d;return d=a(l.gpsIFD,e.gps),d.GPSVersionID&&"array"===b.typeOf(d.GPSVersionID)&&(d.GPSVersionID=d.GPSVersionID.join(".")),d},setExif:function(a,b){var c;if("PixelXDimension"!==a&&"PixelYDimension"!==
a)c=!1;else{c=a;var f,k,g,n=0;if("string"==typeof c)for(k in f=e.exif,f)if(f[k]===c){c=k;break}f=l.exifIFD;k=d.SHORT(f);for(var h=0;k>h;h++)if(g=f+12*h+2,d.SHORT(g)==c){n=g+8;break}c=n?(d.LONG(n,b),!0):!1}return c},getBinary:function(){return d.SEGMENT()},purge:function(){d.init(null);d=f=null;l={}}}}});g("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],
function(b,c,a,d,e){return function(f){var l,g,h,m,v,s;if(l=f,g=new d,g.init(l),65496!==g.SHORT(0))throw new c.ImageError(c.ImageError.WRONG_FORMAT);h=new a(f);m=new e;s=!!m.init(h.get("app1")[0]);v=function(){for(var a=0,b,d;a<=l.length;){if(b=g.SHORT(a+=2),65472<=b&&65475>=b)return a+=5,{height:g.SHORT(a),width:g.SHORT(a+2)};d=g.SHORT(a+=2);a+=d-2}return null}.call(this);b.extend(this,{type:"image/jpeg",size:l.length,width:v&&v.width||0,height:v&&v.height||0,setExif:function(a,d){return s?("object"===
b.typeOf(a)?b.each(a,function(a,b){m.setExif(b,a)}):m.setExif(a,d),void h.set("app1",m.getBinary())):!1},writeHeaders:function(){return arguments.length?h.restore(arguments[0]):l=h.restore(l)},stripHeaders:function(a){return h.strip(a)},purge:function(){m&&h&&g&&(m.purge(),h.purge(),g.init(null),l=v=h=m=g=null)}});s&&(this.meta={tiff:m.TIFF(),exif:m.EXIF(),gps:m.GPS()})}});g("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],
function(b,c,a){return function(d){function e(){l&&(l.init(null),f=g=l=null)}var f,l,g;f=d;l=new a;l.init(f);(function(){for(var a=0,d=0,c=[35152,20039,3338,6666],d=0;d<c.length;d++,a+=2)if(c[d]!=l.SHORT(a))throw new b.ImageError(b.ImageError.WRONG_FORMAT);})();g=function(){var a,b,d=8,c,e,f,k;return a=(c=l.LONG(d),e=l.STRING(d+=4,4),f=d+=4,k=l.LONG(d+c),{length:c,type:e,start:f,CRC:k}),"IHDR"==a.type?(b=a.start,{width:l.LONG(b),height:l.LONG(b+4)}):null}.call(this);c.extend(this,{type:"image/png",
size:f.length,width:g.width,height:g.height,purge:function(){e.call(this)}});e.call(this)}});g("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(b,c,a,d){return function(e){var f=[a,d],l;l=function(){for(var a=0;a<f.length;a++)try{return new f[a](e)}catch(b){}throw new c.ImageError(c.ImageError.WRONG_FORMAT);}();b.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},
stripHeaders:function(a){return a},purge:function(){}});b.extend(this,l);this.purge=function(){l.purge();l=null}}});g("moxie/runtime/html5/image/MegaPixel",[],function(){function b(c){var a=c.naturalWidth;if(1048576<a*c.naturalHeight){var d=document.createElement("canvas");d.width=d.height=1;d=d.getContext("2d");return d.drawImage(c,-a+1,0),0===d.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:b,renderTo:function(c,a,d){var e=c.naturalWidth,f=c.naturalHeight,l=d.width,g=d.height,h=d.x||
0;d=d.y||0;a=a.getContext("2d");b(c)&&(e/=2,f/=2);var m=document.createElement("canvas");m.width=m.height=1024;var v=m.getContext("2d"),s;s=f;var p=document.createElement("canvas");p.width=1;p.height=s;p=p.getContext("2d");p.drawImage(c,0,0);for(var p=p.getImageData(0,0,1,s).data,q=0,w=s,z=s;z>q;)0===p[4*(z-1)+3]?w=z:q=z,z=w+q>>1;s=z/s;s=0===s?1:s;for(p=0;f>p;){q=p+1024>f?f-p:1024;for(w=0;e>w;){z=w+1024>e?e-w:1024;v.clearRect(0,0,1024,1024);v.drawImage(c,-w,-p);var t=w*l/e+h<<0,u=Math.ceil(z*l/e),
y=p*g/f/s+d<<0,B=Math.ceil(q*g/f/s);a.drawImage(m,0,0,z,q,t,y,u,B);w+=1024}p+=1024}}}});g("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(b,c,a,d,e,f,l,g,h){return b.Image=function(){function b(){if(!y&&!t)throw new a.ImageError(a.DOMException.INVALID_STATE_ERR);return y||
t}function k(a){return d.atob(a.substring(a.indexOf("base64,")+7))}function m(b){var c=this;t=new Image;t.onerror=function(){w.call(this);c.trigger("error",a.ImageError.WRONG_FORMAT)};t.onload=function(){c.trigger("load")};t.src=/^data:[^;]*;base64,/.test(b)?b:"data:"+(G.type||"")+";base64,"+d.btoa(b)}function p(b,d){var c=this,e;return window.FileReader?(e=new FileReader,e.onload=function(){d(this.result)},e.onerror=function(){c.trigger("error",a.ImageError.WRONG_FORMAT)},e.readAsDataURL(b),void 0):
d(b.getAsDataURL())}function q(a,d,e,f){var k,g=0,n=0,m,s;if(C=f,s=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==c.inArray(s,[5,6,7,8]))m=a,a=d,d=m;m=b();e?(a=Math.min(a,m.width),d=Math.min(d,m.height),k=Math.max(a/m.width,d/m.height)):k=Math.min(a/m.width,d/m.height);if(1<k&&!e&&f)n=void this.trigger("Resize");else{y||(y=document.createElement("canvas"));f=Math.round(m.width*k);k=Math.round(m.height*k);e?(y.width=a,y.height=d,f>a&&(g=Math.round((f-a)/2)),k>d&&(n=Math.round((k-d)/
2))):(y.width=f,y.height=k);if(!C){a=y.width;d=y.height;switch(s){case 5:case 6:case 7:case 8:y.width=d;y.height=a;break;default:y.width=a,y.height=d}e=y.getContext("2d");switch(s){case 2:e.translate(a,0);e.scale(-1,1);break;case 3:e.translate(a,d);e.rotate(Math.PI);break;case 4:e.translate(0,d);e.scale(1,-1);break;case 5:e.rotate(0.5*Math.PI);e.scale(1,-1);break;case 6:e.rotate(0.5*Math.PI);e.translate(0,-d);break;case 7:e.rotate(0.5*Math.PI);e.translate(a,-d);e.scale(-1,1);break;case 8:e.rotate(-0.5*
Math.PI),e.translate(-a,0)}}s=y;g=-g;n=-n;"iOS"===h.OS?l.renderTo(m,s,{width:f,height:k,x:g,y:n}):s.getContext("2d").drawImage(m,g,n,f,k);n=(this.width=y.width,this.height=y.height,x=!0,void this.trigger("Resize"))}return n}function w(){u&&(u.purge(),u=null);B=t=y=G=null;x=!1}var z=this,t,u,y,B,G,x=!1,C=!0;c.extend(this,{loadFromBlob:function(b){var d=this,c=d.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!c.can("access_binary"))throw new a.RuntimeError(a.RuntimeError.NOT_SUPPORTED_ERR);return G=
b,b.isDetached()?(B=b.getSource(),void m.call(this,B)):void p.call(this,b.getSource(),function(a){e&&(B=k(a));m.call(d,a)})},loadFromImage:function(a,b){this.meta=a.meta;G=new e(null,{name:a.name,size:a.size,type:a.type});m.call(this,b?B=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime();return!u&&B&&a.can("access_image_binary")&&(u=new f(B)),{width:b().width||0,height:b().height||0,type:G.type||g.getFileMime(G.name),size:B&&B.length||G.size||0,name:G.name||"",meta:u&&
u.meta||this.meta||{}}},downsize:function(){q.apply(this,arguments)},getAsCanvas:function(){return y&&(y.id=this.uid+"_canvas"),y},getAsBlob:function(a,b){return a!==this.type&&q.call(this,this.width,this.height,!1),new e(null,{name:G.name||"",type:a,data:z.getAsBinaryString.call(this,a,b)})},getAsDataURL:function(a,b){var d=b||90;if(!x)return t.src;if("image/jpeg"!==a)return y.toDataURL("image/png");try{return y.toDataURL("image/jpeg",d/100)}catch(c){return y.toDataURL("image/jpeg")}},getAsBinaryString:function(a,
b){if(!x)return B||(B=k(z.getAsDataURL(a,b))),B;if("image/jpeg"!==a)B=k(z.getAsDataURL(a,b));else{var d;b||(b=90);try{d=y.toDataURL("image/jpeg",b/100)}catch(c){d=y.toDataURL("image/jpeg")}B=k(d);u&&(B=u.stripHeaders(B),C&&(u.meta&&u.meta.exif&&u.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),B=u.writeHeaders(B)),u.purge(),u=null)}return x=!1,B},destroy:function(){z=null;w.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});g("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic",
"moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(b,c,a,d,e){function f(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(d){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}var l={};return e.addConstructor("flash",function(g){var h=this,m;g=b.extend({swf_url:c.swf_url},g);e.call(this,g,"flash",{access_binary:function(a){return a&&
"browser"===h.mode},access_image_binary:function(a){return a&&"browser"===h.mode},display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===h.mode},resize_image:e.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!b.arrayDiff(a,["","text","document"])||"browser"===h.mode},return_status_code:function(a){return"browser"===h.mode||!b.arrayDiff(a,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,
send_binary_string:function(a){return a&&"browser"===h.mode},send_browser_cookies:function(a){return a&&"browser"===h.mode},send_custom_headers:function(a){return a&&"browser"===h.mode},send_multipart:e.capTrue,slice_blob:function(a){return a&&"browser"===h.mode},stream_upload:function(a){return a&&"browser"===h.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=b.parseSizeStr(a)||"client"===h.mode},use_http_method:function(a){return!b.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?
"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return b.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return b.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
"browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=b.parseSizeStr(a)?"client":"browser"}},"client");10>f()&&(this.mode=!1);b.extend(this,{getShim:function(){return a.get(this.uid)},shimExec:function(a,b){var d=[].slice.call(arguments,2);return h.getShim().exec(this.uid,a,b,d)},init:function(){var a,e,f;f=this.getShimContainer();b.extend(f.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});
a='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+g.swf_url+'" ';"IE"===c.browser&&(a+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');a+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+c.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===c.browser?(e=document.createElement("div"),
f.appendChild(e),e.outerHTML=a,e=f=null):f.innerHTML=a;m=setTimeout(function(){h&&!h.initialized&&h.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(h);clearTimeout(m);g=m=a=h=null}}(this.destroy)},l)}),l});g("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(b,c){return b.Blob={slice:function(a,b,e,f){var l=this.getRuntime();return 0>b?b=Math.max(a.size+b,0):0<b&&(b=Math.min(b,a.size)),0>e?
e=Math.max(a.size+e,0):0<e&&(e=Math.min(e,a.size)),a=l.shimExec.call(this,"Blob","slice",b,e,f||""),a&&(a=new c(l.uid,a)),a}}});g("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(b){return b.FileInput={init:function(b){this.getRuntime().shimExec.call(this,"FileInput","init",{name:b.name,accept:b.accept,multiple:b.multiple});this.trigger("ready")}}});g("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(b,c){function a(a,
b){switch(b){case "readAsText":return c.atob(a,"utf8");case "readAsBinaryString":return c.atob(a);case "readAsDataURL":return a}return null}var d="";return b.FileReader={read:function(b,c){var f=this.getRuntime();return"readAsDataURL"===b&&(d="data:"+(c.type||"")+";base64,"),this.bind("Progress",function(c,f){f&&(d+=a(f,b))}),f.shimExec.call(this,"FileReader","readAsBase64",c.uid)},getResult:function(){return d},destroy:function(){d=null}}});g("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime",
"moxie/core/utils/Encode"],function(b,c){function a(a,b){switch(b){case "readAsText":return c.atob(a,"utf8");case "readAsBinaryString":return c.atob(a);case "readAsDataURL":return a}return null}return b.FileReaderSync={read:function(b,c){var f;return(f=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",c.uid))?("readAsDataURL"===b&&(f="data:"+(c.type||"")+";base64,"+f),a(f,b,c.type)):null}}});g("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
function(b,c,a,d,e,f,l){return b.XMLHttpRequest={send:function(b,d){function e(){b.transport=m.mode;m.shimExec.call(h,"XMLHttpRequest","send",b,d)}function k(a,b){m.shimExec.call(h,"XMLHttpRequest","appendBlob",a,b.uid);d=null;e()}function g(a,b){var d=new l;d.bind("TransportingComplete",function(){b(this.result)});d.transport(a.getSource(),a.type,{ruid:m.uid})}var h=this,m=h.getRuntime();if(c.isEmptyObj(b.headers)||c.each(b.headers,function(a,b){m.shimExec.call(h,"XMLHttpRequest","setRequestHeader",
b,a.toString())}),d instanceof f){var w;if(d.each(function(b,d){b instanceof a?w=d:m.shimExec.call(h,"XMLHttpRequest","append",d,b)}),d.hasBlob()){var z=d.getBlob();z.isDetached()?g(z,function(a){z.destroy();k(w,a)}):k(w,z)}else d=null,e()}else d instanceof a?d.isDetached()?g(d,function(a){d.destroy();d=a.uid;e()}):(d=d.uid,e()):e()},getResponse:function(a){var b,f,l=this.getRuntime();if(f=l.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new d(l.uid,f),"blob"===a)return f;try{if(b=
new e,~c.inArray(a,["","text"]))return b.readAsText(f);if("json"===a&&window.JSON)return JSON.parse(b.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});g("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(b,c){return b.Transporter={getAsBlob:function(a){var b=this.getRuntime();return(a=b.shimExec.call(this,
"Transporter","getAsBlob",a))?new c(b.uid,a):null}}});g("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(b,c,a,d,e){return b.Image={loadFromBlob:function(b){function d(a){e.shimExec.call(c,"Image","loadFromBlob",a.uid);c=e=null}var c=this,e=c.getRuntime();if(b.isDetached()){var f=new a;f.bind("TransportingComplete",function(){d(f.result.getSource())});f.transport(b.getSource(),
b.type,{ruid:e.uid})}else d(b.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(a,b){var c=this.getRuntime(),e=c.shimExec.call(this,"Image","getAsBlob",a,b);return e?new d(c.uid,e):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments),b;return a?(b=new e,b.readAsDataURL(a)):null}}});g("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom",
"moxie/core/Exceptions","moxie/runtime/Runtime"],function(b,c,a,d,e){function f(a){var b=!1,d=null,c,e,l,k,g,h=0;try{try{d=new ActiveXObject("AgControl.AgControl"),d.IsVersionSupported(a)&&(b=!0)}catch(n){var m=navigator.plugins["Silverlight Plug-In"];if(m){c=m.description;"1.0.30226.2"===c&&(c="2.0.30226.2");for(e=c.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(l=a.split(".");4<l.length;)l.pop();do k=parseInt(l[h],10),g=parseInt(e[h],10),h++;while(h<l.length&&k===g);g>=k&&!isNaN(k)&&
(b=!0)}}}catch(y){b=!1}return b}var l={};return e.addConstructor("silverlight",function(g){var h=this,m;g=b.extend({xap_url:c.xap_url},g);e.call(this,g,"silverlight",{access_binary:e.capTrue,access_image_binary:e.capTrue,display_media:e.capTrue,do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:e.capTrue,resize_image:e.capTrue,return_response_headers:function(a){return a&&"client"===h.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===
h.mode||!b.arrayDiff(a,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:e.capTrue,send_browser_cookies:function(a){return a&&"browser"===h.mode},send_custom_headers:function(a){return a&&"client"===h.mode},send_multipart:e.capTrue,slice_blob:e.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:e.capTrue,use_http_method:function(a){return"client"===h.mode||!b.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return b.arrayDiff(a,
[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return b.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});f("2.0.31005.0")&&"Opera"!==c.browser||(this.mode=!1);b.extend(this,{getShim:function(){return a.get(this.uid).content.Moxie},shimExec:function(a,b){var d=[].slice.call(arguments,2);return h.getShim().exec(this.uid,a,b,d)},init:function(){this.getShimContainer().innerHTML=
'<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+c.global_event_dispatcher+'"/></object>';m=setTimeout(function(){h&&!h.initialized&&h.trigger("Error",new d.RuntimeError(d.RuntimeError.NOT_INIT_ERR))},
"Windows"!==c.OS?1E4:5E3)},destroy:function(a){return function(){a.call(h);clearTimeout(m);g=m=a=h=null}}(this.destroy)},l)}),l});g("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(b,c,a){return b.Blob=c.extend({},a)});g("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(b){return b.FileInput={init:function(b){this.getRuntime().shimExec.call(this,"FileInput","init",function(a){for(var b=
"",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}(b.accept),b.name,b.multiple);this.trigger("ready")}}});g("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(b,c,a){return b.FileDrop={init:function(){var b=this.getRuntime(),e;return e=b.getShimContainer(),a.addEvent(e,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},
this.uid),a.addEvent(e,"dragenter",function(a){a.preventDefault();c.get(b.uid).dragEnter(a)&&a.stopPropagation()},this.uid),a.addEvent(e,"drop",function(a){a.preventDefault();c.get(b.uid).dragDrop(a)&&a.stopPropagation()},this.uid),b.shimExec.call(this,"FileDrop","init")}}});g("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(b,c,a){return b.FileReader=c.extend({},a)});g("moxie/runtime/silverlight/file/FileReaderSync",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(b,c,a){return b.FileReaderSync=c.extend({},a)});g("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(b,c,a){return b.XMLHttpRequest=c.extend({},a)});g("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],
function(b,c,a){return b.Transporter=c.extend({},a)});g("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(b,c,a){return b.Image=c.extend({},a,{getInfo:function(){var a=["tiff","exif","gps"],b={meta:{}},f=this.getRuntime().shimExec.call(this,"Image","getInfo");return f.meta&&c.each(a,function(a){var d=f.meta[a],c,k,g,h;if(d&&d.keys)for(b.meta[a]={},k=0,g=d.keys.length;g>k;k++)c=d.keys[k],(h=d[c])&&(/^(\d|[1-9]\d+)$/.test(h)?
h=parseInt(h,10):/^\d*\.\d+$/.test(h)&&(h=parseFloat(h)),b.meta[a][c]=h)}),b.width=parseInt(f.width,10),b.height=parseInt(f.height,10),b.size=parseInt(f.size,10),b.type=f.type,b.name=f.name,b}})});g("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(b,c,a,d){var e={};return a.addConstructor("html4",function(c){var f=this,g=a.capTest,h=a.capTrue;a.call(this,c,"html4",{access_binary:g(window.FileReader||window.File&&
File.getAsDataURL),access_image_binary:!1,display_media:g(e.Image&&(d.can("create_canvas")||d.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:g("Chrome"===d.browser&&28<=d.version||"IE"===d.browser&&10<=d.version),resize_image:function(){return e.Image&&f.can("access_binary")&&d.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~b.inArray(a,["text","document",""])},return_status_code:function(a){return!b.arrayDiff(a,
[200,404])},select_file:function(){return d.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return f.can("select_file")},summon_file_dialog:g("Firefox"===d.browser&&4<=d.version||"Opera"===d.browser&&12<=d.version||!!~b.inArray(d.browser,["Chrome","Safari"])),upload_filesize:h,use_http_method:function(a){return!b.arrayDiff(a,["GET","POST"])}});b.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(f);
a=f=null}}(this.destroy)});b.extend(this.getShim(),e)}),e});g("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(b,c,a,d,e,f){return b.FileInput=function(){function b(){var e=this,p=e.getRuntime(),q,w,z,t,u,y;y=c.guid("uid_");q=p.getShimContainer();g&&(z=a.get(g+"_form"),z&&c.extend(z.style,{top:"100%"}));t=document.createElement("form");t.setAttribute("id",
y+"_form");t.setAttribute("method","post");t.setAttribute("enctype","multipart/form-data");t.setAttribute("encoding","multipart/form-data");c.extend(t.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});u=document.createElement("input");u.setAttribute("id",y);u.setAttribute("type","file");u.setAttribute("name",m.name||"Filedata");u.setAttribute("accept",h.join(","));c.extend(u.style,{fontSize:"999px",opacity:0});t.appendChild(u);q.appendChild(t);c.extend(u.style,
{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===f.browser&&10>f.version&&c.extend(u.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});u.onchange=function(){var d;this.value&&(d=this.files?this.files[0]:{name:this.value},k=[d],this.onchange=function(){},b.call(e),e.bind("change",function x(){var b=a.get(y),d=a.get(y+"_form"),c;e.unbind("change",x);e.files.length&&b&&d&&(c=e.files[0],b.setAttribute("id",c.uid),d.setAttribute("id",c.uid+"_form"),d.setAttribute("target",
c.uid+"_iframe"))},998),u=t=null,e.trigger("change"))};p.can("summon_file_dialog")&&(w=a.get(m.browse_button),d.removeEvent(w,"click",e.uid),d.addEvent(w,"click",function(a){u&&!u.disabled&&u.click();a.preventDefault()},e.uid));g=y;q=z=w=null}var g,k=[],h=[],m;c.extend(this,{init:function(c){var f=this,g=f.getRuntime(),k;m=c;h=c.accept.mimes||e.extList2mimes(c.accept,g.can("filter_by_extension"));k=g.getShimContainer();(function(){var b,e;b=a.get(c.browse_button);g.can("summon_file_dialog")&&("static"===
a.getStyle(b,"position")&&(b.style.position="relative"),e=parseInt(a.getStyle(b,"z-index"),10)||1,b.style.zIndex=e,k.style.zIndex=e-1);b=g.can("summon_file_dialog")?b:k;d.addEvent(b,"mouseover",function(){f.trigger("mouseenter")},f.uid);d.addEvent(b,"mouseout",function(){f.trigger("mouseleave")},f.uid);d.addEvent(b,"mousedown",function(){f.trigger("mousedown")},f.uid);d.addEvent(a.get(c.container),"mouseup",function(){f.trigger("mouseup")},f.uid);b=null})();b.call(this);k=null;f.trigger({type:"ready",
async:!0})},getFiles:function(){return k},disable:function(b){var d;(d=a.get(g))&&(d.disabled=!!b)},destroy:function(){var b=this.getRuntime(),c=b.getShim(),b=b.getShimContainer();d.removeAllEvents(b,this.uid);d.removeAllEvents(m&&a.get(m.container),this.uid);d.removeAllEvents(m&&a.get(m.browse_button),this.uid);b&&(b.innerHTML="");c.removeInstance(this.uid);g=k=h=m=null}})}});g("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(b,
c){return b.FileReader=c});g("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(b,c,a,d,e,f,l,g){return b.XMLHttpRequest=function(){function b(d){var c=this,e,l,g,k=!1;if(m){if(e=m.id.replace(/_iframe$/,""),l=a.get(e+"_form")){e=l.getElementsByTagName("input");for(g=e.length;g--;)switch(e[g].getAttribute("type")){case "hidden":e[g].parentNode.removeChild(e[g]);
break;case "file":k=!0}e=[];k||l.parentNode.removeChild(l);l=null}setTimeout(function(){f.removeEvent(m,"load",c.uid);m.parentNode&&m.parentNode.removeChild(m);var a=c.getRuntime().getShimContainer();a.children.length||a.parentNode.removeChild(a);m=null;d()},1)}}var k,h,m;c.extend(this,{send:function(p,q){var w=this,z=w.getRuntime(),t,u,y,B;if(k=h=null,q instanceof g&&q.hasBlob()){if(B=q.getBlob(),t=B.uid,y=a.get(t),u=a.get(t+"_form"),!u)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);}else t=
c.guid("uid_"),u=document.createElement("form"),u.setAttribute("id",t+"_form"),u.setAttribute("method",p.method),u.setAttribute("enctype","multipart/form-data"),u.setAttribute("encoding","multipart/form-data"),u.setAttribute("target",t+"_iframe"),z.getShimContainer().appendChild(u);q instanceof g&&q.each(function(a,b){if(a instanceof l)y&&y.setAttribute("name",b);else{var d=document.createElement("input");c.extend(d,{type:"hidden",name:b,value:a});y?u.insertBefore(d,y):u.appendChild(d)}});u.setAttribute("action",
p.url);(function(){var a=z.getShimContainer()||document.body,e=document.createElement("div");e.innerHTML='<iframe id="'+t+'_iframe" name="'+t+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';m=e.firstChild;a.appendChild(m);f.addEvent(m,"load",function(){var a;try{a=m.contentWindow.document||m.contentDocument||window.frames[m.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(a.title)?k=a.title.replace(/^(\d+).*$/,"$1"):(k=200,h=c.trim(a.body.innerHTML),w.trigger({type:"progress",
loaded:h.length,total:h.length}),B&&w.trigger({type:"uploadprogress",loaded:B.size||1025,total:B.size||1025}))}catch(e){if(!d.hasSameOrigin(p.url))return void b.call(w,function(){w.trigger("error")});k=404}b.call(w,function(){w.trigger("load")})},w.uid)})();u.submit();w.trigger("loadstart")},getStatus:function(){return k},getResponse:function(a){if("json"===a&&"string"===c.typeOf(h)&&window.JSON)try{return JSON.parse(h.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return h},
abort:function(){var a=this;m&&m.contentWindow&&(m.contentWindow.stop?m.contentWindow.stop():m.contentWindow.document.execCommand?m.contentWindow.document.execCommand("Stop"):m.src="about:blank");b.call(this,function(){a.dispatchEvent("abort")})}})}});g("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(b,c){return b.Image=c});(function(g){for(var c=0;c<g.length;c++){for(var a=b,d=g[c],e=d.split(/[.\/]/),h=0;h<e.length-1;++h)a[e[h]]===m&&(a[e[h]]=
{}),a=a[e[h]];a[e[e.length-1]]=f[d]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))}(this);
(function(b){var m={},h=b.moxie.core.utils.Basic.inArray;return function f(b){var c,a;for(c in b)a=typeof b[c],"object"!==a||~h(c,["Exceptions","Env","Mime"])?"function"===a&&(m[c]=b[c]):f(b[c])}(b.moxie),m.Env=b.moxie.core.utils.Env,m.Mime=b.moxie.core.utils.Mime,m.Exceptions=b.moxie.core.Exceptions,b.mOxie=m,b.o||(b.o=m),m})(this);
(function(b,m,h){function g(a){function b(a,d,c){var e={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};e[a]?f[e[a]]=d:c||(f[a]=d)}var e=a.required_features,f={};if("string"==typeof e)c.each(e.split(/\s*,\s*/),function(a){b(a,
!0)});else if("object"==typeof e)c.each(e,function(a,c){b(c,a)});else if(!0===e){0<a.chunk_size&&(f.slice_blob=!0);if(a.resize.enabled||!a.multipart)f.send_binary_string=!0;c.each(a,function(a,c){b(c,!!a,!0)})}return f}var f=b.setTimeout,k={},c={VERSION:"2.1.2",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,
MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:m.mimes,ua:m.ua,typeOf:m.typeOf,extend:m.extend,guid:m.guid,get:function(a){var b=[],c;"array"!==m.typeOf(a)&&(a=[a]);for(var f=a.length;f--;)(c=m.get(a[f]))&&b.push(c);return b.length?b:null},each:m.each,getPos:m.getPos,getSize:m.getSize,xmlEncode:function(a){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},c=/[<>&\"\']/g;return a?(""+a).replace(c,function(a){return b[a]?"&"+b[a]+";":a}):a},toArray:m.toArray,inArray:m.inArray,addI18n:m.addI18n,
translate:m.translate,isEmptyObj:m.isEmptyObj,hasClass:m.hasClass,addClass:m.addClass,removeClass:m.removeClass,getStyle:m.getStyle,addEvent:m.addEvent,removeEvent:m.removeEvent,removeAllEvents:m.removeAllEvents,cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=
2)a=a.replace(c[b],c[b+1]);return a=a.replace(/\s+/g,"_"),a=a.replace(/[^a-z0-9_\-\.]+/gi,""),a},buildUrl:function(a,b){var e="";return c.each(b,function(a,b){e+=(e?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)}),e&&(a+=(0<a.indexOf("?")?"&":"?")+e),a},formatSize:function(a){function b(a,c){return Math.round(a*Math.pow(10,c))/Math.pow(10,c)}if(a===h||/\D/.test(a))return c.translate("N/A");var e=Math.pow(1024,4);return a>e?b(a/e,1)+" "+c.translate("tb"):a>(e/=1024)?b(a/e,1)+" "+c.translate("gb"):
a>(e/=1024)?b(a/e,1)+" "+c.translate("mb"):1024<a?Math.round(a/1024)+" "+c.translate("kb"):a+" "+c.translate("b")},parseSize:m.parseSizeStr,predictRuntime:function(a,b){var e,f;return e=new c.Uploader(a),f=m.Runtime.thatCan(e.getOption().required_features,b||a.runtimes),e.destroy(),f},addFileFilter:function(a,b){k[a]=b}};c.addFileFilter("mime_types",function(a,b,e){a.length&&!a.regexp.test(b.name)?(this.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:b}),
e(!1)):e(!0)});c.addFileFilter("max_file_size",function(a,b,e){a=c.parseSize(a);void 0!==b.size&&a&&b.size>a?(this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:b}),e(!1)):e(!0)});c.addFileFilter("prevent_duplicates",function(a,b,e){if(a)for(a=this.files.length;a--;)if(b.name===this.files[a].name&&b.size===this.files[a].size){this.trigger("Error",{code:c.FILE_DUPLICATE_ERROR,message:c.translate("Duplicate file error."),file:b});e(!1);return}e(!0)});c.Uploader=
function(a){function b(){var a,d=0,e;if(this.state==c.STARTED){for(e=0;e<C.length;e++)a||C[e].status!=c.QUEUED?d++:(a=C[e],this.trigger("BeforeUpload",a)&&(a.status=c.UPLOADING,this.trigger("UploadFile",a)));d==C.length&&(this.state!==c.STOPPED&&(this.state=c.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",C))}}function e(a){a.percent=0<a.size?Math.ceil(100*(a.loaded/a.size)):100;n()}function n(){var a,b;E.reset();for(a=0;a<C.length;a++)b=C[a],b.size!==h?(E.size+=b.origSize,E.loaded+=
b.loaded*b.origSize/b.size):E.size=h,b.status==c.DONE?E.uploaded++:b.status==c.FAILED?E.failed++:E.queued++;E.size===h?E.percent=0<C.length?Math.ceil(100*(E.uploaded/C.length)):0:(E.bytesPerSec=Math.ceil(E.loaded/((+new Date-O||1)/1E3)),E.percent=0<E.size?Math.ceil(100*(E.loaded/E.size)):0)}function l(){var a=J[0]||N[0];return a?a.getRuntime().uid:!1}function r(a,b){if(a.ruid){var c=m.Runtime.getInfo(a.ruid);if(c)return c.can(b)}return!1}function H(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged");
a.refresh()});this.bind("CancelUpload",t);this.bind("BeforeUpload",p);this.bind("UploadFile",q);this.bind("UploadProgress",w);this.bind("StateChanged",z);this.bind("QueueChanged",n);this.bind("Error",y);this.bind("FileUploaded",u);this.bind("Destroy",B)}function D(a,b){var d=this,e=0,f=[],g={runtime_order:a.runtimes,required_caps:a.required_features,preferred_caps:K,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};c.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(g[b]=a[b])});a.browse_button&&
c.each(a.browse_button,function(b){f.push(function(f){var l=new m.FileInput(c.extend({},g,{accept:a.filters.mime_types,name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:b}));l.onready=function(){var a=m.Runtime.getInfo(this.ruid);m.extend(d.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")});e++;J.push(this);f()};l.onchange=function(){d.addFile(this.files)};l.bind("mouseenter mouseleave mousedown mouseup",
function(c){L||(a.browse_button_hover&&("mouseenter"===c.type?m.addClass(b,a.browse_button_hover):"mouseleave"===c.type&&m.removeClass(b,a.browse_button_hover)),a.browse_button_active&&("mousedown"===c.type?m.addClass(b,a.browse_button_active):"mouseup"===c.type&&m.removeClass(b,a.browse_button_active)))});l.bind("mousedown",function(){d.trigger("Browse")});l.bind("error runtimeerror",function(){l=null;f()});l.init()})});a.drop_element&&c.each(a.drop_element,function(a){f.push(function(b){var f=new m.FileDrop(c.extend({},
g,{drop_zone:a}));f.onready=function(){var a=m.Runtime.getInfo(this.ruid);d.features.dragdrop=a.can("drag_and_drop");e++;N.push(this);b()};f.ondrop=function(){d.addFile(this.files)};f.bind("error runtimeerror",function(){f=null;b()});f.init()})});m.inSeries(f,function(){"function"==typeof b&&b(e)})}function v(a,b,c){var d=new m.Image;try{d.onload=function(){if(b.width>this.width&&b.height>this.height&&b.quality===h&&b.preserve_headers&&!b.crop)return this.destroy(),c(a);d.downsize(b.width,b.height,
b.crop,b.preserve_headers)},d.onresize=function(){c(this.getAsBlob(a.type,b.quality));this.destroy()},d.onerror=function(){c(a)},d.load(a)}catch(e){c(a)}}function s(a,b,d){function e(a,b,d){var g=x[a];switch(a){case "max_file_size":"max_file_size"===a&&(x.max_file_size=x.filters.max_file_size=b);break;case "chunk_size":if(b=c.parseSize(b))x[a]=b,x.send_file_name=!0;break;case "multipart":(x[a]=b)||(x.send_file_name=!0);break;case "unique_names":(x[a]=b)&&(x.send_file_name=!0);break;case "filters":"array"===
c.typeOf(b)&&(b={mime_types:b});d?c.extend(x.filters,b):x.filters=b;b.mime_types&&(x.filters.mime_types.regexp=function(a){var b=[];return c.each(a,function(a){c.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),RegExp("("+b.join("|")+")$","i")}(x.filters.mime_types));break;case "resize":d?c.extend(x.resize,b,{enabled:!0}):x.resize=b;break;case "prevent_duplicates":x.prevent_duplicates=
x.filters.prevent_duplicates=!!b;break;case "browse_button":case "drop_element":b=c.get(b);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":x[a]=b;d||(k=!0);break;default:x[a]=b}d||f.trigger("OptionChanged",a,b,g)}var f=this,k=!1;"object"==typeof a?c.each(a,function(a,b){e(b,a,d)}):e(a,b,d);d?(x.required_features=g(c.extend({},x)),K=g(c.extend({},x,{required_features:!0}))):k&&(f.trigger("Destroy"),D.call(f,x,function(a){a?(f.runtime=m.Runtime.getInfo(l()).type,
f.trigger("Init",{runtime:f.runtime}),f.trigger("PostInit")):f.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}))}function p(a,b){if(a.settings.unique_names){var c=b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function q(a,b){function d(){0<k--?f(e,1E3):(b.loaded=n,a.trigger("Error",{code:c.HTTP_ERROR,message:c.translate("HTTP Error."),file:b,response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()}))}function e(){var r,
p,q={},w;b.status===c.UPLOADING&&a.state!==c.STOPPED&&(a.settings.send_file_name&&(q.name=b.target_name||b.name),l&&h.chunks&&s.size>l?(w=Math.min(l,s.size-n),r=s.slice(n,n+w)):(w=s.size,r=s),l&&h.chunks&&(a.settings.send_chunk_number?(q.chunk=Math.ceil(n/l),q.chunks=Math.ceil(s.size/l)):(q.offset=n,q.total=s.size)),A=new m.XMLHttpRequest,A.upload&&(A.upload.onprogress=function(c){b.loaded=Math.min(b.size,n+c.loaded);a.trigger("UploadProgress",b)}),A.onload=function(){400<=A.status?d():(k=a.settings.max_retries,
w<s.size?(r.destroy(),n+=w,b.loaded=Math.min(n,s.size),a.trigger("ChunkUploaded",b,{offset:b.loaded,total:s.size,response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()}),"Android Browser"===m.Env.browser&&a.trigger("UploadProgress",b)):b.loaded=b.size,r=p=null,!n||n>=s.size?(b.size!=b.origSize&&(s.destroy(),s=null),a.trigger("UploadProgress",b),b.status=c.DONE,a.trigger("FileUploaded",b,{response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()})):
f(e,1))},A.onerror=function(){d()},A.onloadend=function(){this.destroy();A=null},a.settings.multipart&&h.multipart?(A.open("post",g,!0),c.each(a.settings.headers,function(a,b){A.setRequestHeader(b,a)}),p=new m.FormData,c.each(c.extend(q,a.settings.multipart_params),function(a,b){p.append(b,a)}),p.append(a.settings.file_data_name,r),A.send(p,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:K,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):
(g=c.buildUrl(a.settings.url,c.extend(q,a.settings.multipart_params)),A.open("post",g,!0),A.setRequestHeader("Content-Type","application/octet-stream"),c.each(a.settings.headers,function(a,b){A.setRequestHeader(b,a)}),A.send(r,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:K,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var g=a.settings.url,l=a.settings.chunk_size,k=a.settings.max_retries,h=a.features,n=0,s;b.loaded&&(n=b.loaded=
l?l*Math.floor(b.loaded/l):0);s=b.getSource();a.settings.resize.enabled&&r(s,"send_binary_string")&&~m.inArray(s.type,["image/jpeg","image/png"])?v.call(this,s,a.settings.resize,function(a){s=a;b.size=a.size;e()}):e()}function w(a,b){e(b)}function z(a){if(a.state==c.STARTED)O=+new Date;else if(a.state==c.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==c.UPLOADING&&(a.files[b].status=c.QUEUED,n())}function t(){A&&A.abort()}function u(a){n();f(function(){b.call(a)},1)}function y(a,l){l.code===
c.INIT_ERROR?a.destroy():l.file&&(l.file.status=c.FAILED,e(l.file),a.state==c.STARTED&&(a.trigger("CancelUpload"),f(function(){b.call(a)},1)))}function B(a){a.stop();c.each(C,function(a){a.destroy()});C=[];J.length&&(c.each(J,function(a){a.destroy()}),J=[]);N.length&&(c.each(N,function(a){a.destroy()}),N=[]);K={};L=!1;O=A=null;E.reset()}var G=c.guid(),x,C=[],K={},J=[],N=[],O,E,L=!1,A;x={runtimes:m.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",
silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0};s.call(this,a,null,!0);E=new c.QueueProgress;c.extend(this,{id:G,uid:G,state:c.STOPPED,features:{},runtime:null,files:C,settings:x,total:E,init:function(){var a=this;"function"==typeof x.preinit?x.preinit(a):c.each(x.preinit,function(b,c){a.bind(c,b)});H.call(this);x.browse_button&&x.url?D.call(this,x,function(b){"function"==
typeof x.init?x.init(a):c.each(x.init,function(b,c){a.bind(c,b)});b?(a.runtime=m.Runtime.getInfo(l()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}):this.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})},setOption:function(a,b){s.call(this,a,b,!this.runtime)},getOption:function(a){return a?x[a]:x},refresh:function(){J.length&&c.each(J,function(a){a.trigger("Refresh")});this.trigger("Refresh")},
start:function(){this.state!=c.STARTED&&(this.state=c.STARTED,this.trigger("StateChanged"),b.call(this))},stop:function(){this.state!=c.STOPPED&&(this.state=c.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){L=a!==h?a:!0;J.length&&c.each(J,function(a){a.disable(L)});this.trigger("DisableBrowse",L)},getFile:function(a){var b;for(b=C.length-1;0<=b;b--)if(C[b].id===a)return C[b]},addFile:function(a,b){function d(a,b){var c=[];m.each(g.settings.filters,function(b,
d){k[d]&&c.push(function(c){k[d].call(g,b,a,function(a){c(!a)})})});m.inSeries(c,b)}function e(a){var l=m.typeOf(a);if(a instanceof m.File){if(!a.ruid&&!a.isDetached()){if(!s)return!1;a.ruid=s;a.connectRuntime(s)}e(new c.File(a))}else a instanceof m.Blob?(e(a.getSource()),a.destroy()):a instanceof c.File?(b&&(a.name=b),h.push(function(b){d(a,function(c){c||(C.push(a),n.push(a),g.trigger("FileFiltered",a));f(b,1)})})):-1!==m.inArray(l,["file","blob"])?e(new m.File(null,a)):"node"===l&&"filelist"===
m.typeOf(a.files)?m.each(a.files,e):"array"===l&&(b=null,m.each(a,e))}var g=this,h=[],n=[],s;s=l();e(a);h.length&&m.inSeries(h,function(){n.length&&g.trigger("FilesAdded",n)})},removeFile:function(a){a="string"==typeof a?a:a.id;for(var b=C.length-1;0<=b;b--)if(C[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var d=C.splice(a===h?0:a,b===h?C.length:b),e=!1;return this.state==c.STARTED&&(c.each(d,function(a){if(a.status===c.UPLOADING)return e=!0,!1}),e&&this.stop()),this.trigger("FilesRemoved",
d),c.each(d,function(a){a.destroy()}),e&&this.start(),d},bind:function(a,b,d){var e=this;c.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);return a.splice(0,1,e),b.apply(this,a)},0,d)},destroy:function(){this.trigger("Destroy");x=E=null;this.unbindAll()}})};c.Uploader.prototype=m.EventTarget.instance;c.File=function(){var a={};return function(b){c.extend(this,{id:c.guid(),name:b.name||b.fileName,type:b.type||"",size:b.size||b.fileSize,origSize:b.size||b.fileSize,loaded:0,
percent:0,status:c.QUEUED,lastModifiedDate:b.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==m.inArray(m.typeOf(a),["blob","file"])?a:null},getSource:function(){return a[this.id]?a[this.id]:null},destroy:function(){var b=this.getSource();b&&(b.destroy(),delete a[this.id])}});a[this.id]=b}}();c.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=
a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};b.plupload=c})(window,mOxie);
(function(b){var m=function(g,f){var k=b.extend({},h.defaults,f||{});b.telligent.evolution.get({url:k.endpoint,data:{url:g,maxImageWidth:"undefined"!==typeof f.maxImageWidth?f.maxImageWidth:k.maxImageWidth,maxImageHeight:"undefined"!==typeof f.maxImageHeight?f.maxImageHeight:k.maxImageHeight},success:function(b){b&&k.success&&"undefined"!==typeof b&&null!==b?k.success(b):k.error&&k.error(b)},error:function(b,a,d){k.error&&k.error(b,a,d)}})},h={load:function(b,f){m(b,f)},render:function(g,f){if(null!==
g&&"undefined"!==typeof g&&"undefined"!==typeof g.url&&0!==g.url.length&&"undefined"!==typeof g.title&&0!==g.title.length){var k=b.extend({},h.defaults,f);return b.telligent.evolution.template.compile(k.template)(g)}},defaults:{endpoint:"",maxImageWidth:90,maxImageHeight:90,template:'<div class="abbreviated-post-header shared-link"></div><div class="abbreviated-post shared-link <% if(imageUrl !== null && imageUrl.length > 0){ %> with-image <% } %>">   <h4 class="post-name"><a href="<%: url %>" class="external-link" target="_new" rel="nofollow"><%= title %></a></h4>   <% if(siteName !== null && siteName.length > 0){ %>       <div class="post-application">           <span class="label"></span>           <span class="value"><a href="<%: url %>" class="external-link" target="_new" rel="nofollow"><%= siteName %></a></span>       </div>   <% } %>   <% if(imageUrl !== null && imageUrl.length > 0){ %>       <div class="post-thumbnail">           <a href="<%: url %>" class="external-link" target="_new" rel="nofollow"><%= resizedImageHtml %></a>       </div>   <% } %>   <% if(excerpt !== null && excerpt.length > 0){ %>       <div class="post-summary">           <%= excerpt %>      </div>   <% } %></div><div class="abbreviated-post-footer shared-link"></div>'}};
b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.preview=h})(jQuery);(function(b,m){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.regex={encode:function(b){return b?b.replace(/[\-\[\]\{\}\(\)\*\+\?\.\,\\\^\$\|\#\s]/g,"\\$&"):b}}})(jQuery,window);
(function(b){var m=null,h=function(b){b.area.css({height:"auto"}).css({height:b.area.prop("scrollHeight")-(null===m?b.offset:m)});var g=b.area.outerHeight();g!==b.oldHeight&&(g>=b.maxHeight?b.area.css({overflow:"visible"}):b.area.css({overflow:"hidden"}),b.area.trigger("evolutionResize",{newHeight:g,oldHeight:b.oldHeight}),b.oldHeight=g)},g=function(b){return parseInt(b.replace("px",""),10)};b(function(){var f=b("<textarea>test</textarea>").css({overflow:"hidden",resize:"none",visible:"none"}).appendTo("body");
1>=Math.abs(f.prop("scrollHeight")-f.height())&&(m=0);f.remove()});b.fn.evolutionResize=function(){return this.filter("textarea").each(function(){var f=b(this).css({resize:"none",overflow:"hidden"}),k={area:f,oldHeight:f.height(),maxHeight:g(f.css("max-height")),offset:f.innerHeight()!==f.height()?g(f.css("padding-top"))+g(f.css("padding-bottom")):0};f.bind("input keydown keyup",function(){h(k)});h(k)})}})(jQuery);
(function(b){var m={};b.event.special.scrollend={setup:function(h){m=b.extend({padding:150,delay:250},h)},add:function(){var h=b(this);if(!h.data("_scrollend_init")){h.data("_scrollend_init",!0);var g=this===document,f=g?b(window):h,k=!1;f.on("scroll",function(){k=!0});setInterval(function(){if(k){var c;c=g?b(h).height()-b(h).scrollTop()-b(f).height()<=m.padding:h.scrollTop()+h.innerHeight()+m.padding>=h[0].scrollHeight;c&&h.trigger("scrollend");k=!1}},m.delay)}}}})(jQuery);
(function(b){var m={};b.event.special.scrolltop={setup:function(h){m=b.extend({padding:150,delay:250},h)},add:function(){var h=b(this);if(!h.data("_scrolltop_init")){h.data("_scrolltop_init",!0);var g=!1;(this===document?b(window):h).on("scroll",function(){g=!0});setInterval(function(){g&&(h.scrollTop()<=m.padding&&h.trigger("scrolltop"),g=!1)},m.delay)}}}})(jQuery);
(function(b,m,h){function g(){return m.navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&m.navigator.userAgent.match(/AppleWebKit/)}var f=function(){var a={longPollDelay:0};return{configure:function(c){var d=b.extend({},a,c||{}),e=b.signalR,f=b.signalR.events,l=b.signalR.changeState,g=b.signalR.isDisconnecting,k=e.transports._logic;e.transports.longPolling={name:"longPolling",supportsKeepAlive:!1,reconnectDelay:3E3,init:function(a,b){var c=this,d,e=function(b){!1===g(a)&&(a.log("Server ping failed because '"+
b+"', re-trying ping."),a._.pingLoopId=window.setTimeout(d,c.reconnectDelay))};a.log("Initializing long polling connection with server.");d=function(){k.pingServer(a).done(b).fail(e)};d()},start:function(a,c,h){var n=this,m=function(){s=m=b.noop;a.log("Longpolling connected.");c();h=null},s=function(){return h?(h(),h=null,a.log("LongPolling failed to connect."),!0):!1},r=a._,p=0,v=function(c){window.clearTimeout(r.reconnectTimeoutId);r.reconnectTimeoutId=null;!0===l(a,e.connectionState.reconnecting,
e.connectionState.connected)&&(a.log("Raising the reconnect event."),b(c).triggerHandler(f.onReconnect))};a.pollXhr&&(a.log("Polling xhr requests already exists, aborting."),a.stop());r.reconnectTimeoutId=null;r.pollTimeoutId=null;n.init(a,function(){a.messageId=null;r.pollTimeoutId=window.setTimeout(function(){(function A(c,l){var h=null!==c.messageId,t=k.getUrl(c,n.name,h,!l);!0!==g(c)&&(a.log("Opening long polling request to '"+t+"'."),c.pollXhr=b.ajax(b.extend({},b.signalR.ajaxDefaults,{xhrFields:{withCredentials:a.withCredentials},
url:t,type:"GET",dataType:a.ajaxDataType,contentType:a.contentType,success:function(e){var f=0,l,h,n;a.log("Long poll complete.");p=0;try{l=a._parseResponse(e)}catch(t){k.handleParseFailure(c,e,t.message,s);return}null!==r.reconnectTimeoutId&&v();m();l&&(h=k.maximizePersistentResponse(l));k.processMessages(c,l);d&&0<d.longPollDelay?f=d.longPollDelay:h&&"number"===b.type(h.LongPollDelay)&&(f=h.LongPollDelay);h&&h.Disconnect||!0===g(c)||((n=h&&h.ShouldReconnect)&&k.ensureReconnectingState(c),0<f?r.pollTimeoutId=
window.setTimeout(function(){A(c,n)},f):A(c,n))},error:function(d,l){window.clearTimeout(r.reconnectTimeoutId);r.reconnectTimeoutId=null;"abort"===l?a.log("Aborted xhr requst."):s()||(p++,a.state!==e.connectionState.reconnecting&&(a.log("An error occurred using longPolling. Status = "+l+".  Response = "+d.responseText+"."),b(c).triggerHandler(f.onError,[d.responseText])),(a.state!==e.connectionState.connected&&a.state!==e.connectionState.reconnecting||k.verifyLastActive(a))&&k.ensureReconnectingState(c)&&
(r.pollTimeoutId=window.setTimeout(function(){n.init(c,function(){A(c,!0)})},n.reconnectDelay)))}})),h&&!0===l&&(r.reconnectTimeoutId=window.setTimeout(function(){v(c)},Math.min(1E3*(Math.pow(2,p)-1),36E5))))})(a);window.setTimeout(function(){m()},250)},250)})},lostConnection:function(a){throw Error("Lost Connection not handled for LongPolling");},send:function(a,b){k.ajaxSend(a,b)},stop:function(a){window.clearTimeout(a._.pollTimeoutId);window.clearTimeout(a._.reconnectTimeoutId);delete a._.pollTimeoutId;
delete a._.reconnectTimeoutId;a.pollXhr&&(a.pollXhr.abort(),a.pollXhr=null,delete a.pollXhr)},abort:function(a,b){k.ajaxAbort(a,b)}}}}}(),k={},c=null,a;a=g()?["longPolling","foreverFrame"]:["serverSentEvents","longPolling","foreverFrame"];var d=0,e=!1,n=0,l=null,r=0,H=function(b){r++;12<r||(clearTimeout(n),n=setTimeout(function(){b.start({transport:a});clearTimeout(n)},5E3))},D=function(a,c,d){if(a=k[a+"|"+c]){var e=d&&0<d.length?b.parseJSON(d):null;b.each(a,function(a,b){try{b(e)}catch(c){}})}},
v=function(h){b.connection&&(f.configure({longPollDelay:g()?5E3:0}),b.each(h.sockets,function(a,e){v[e.name]={on:function(a,b){var c=e.fullName+"|"+a;k[c]=k[c]||[];k[c].push(b)},off:function(a){delete k[e.fullName+"|"+a]},send:function(a,f){if(d==b.signalR.connectionState.connected){var l=b.telligent.evolution.url.serializeQuery(b.extend(f,{_s:e.fullName,_m:a}));c.send(l)}}}}),b.ajaxPrefilter(function(a,c,d){0===a.url.indexOf(h.endpoint)&&b.telligent.evolution.writeAuthorizationHeader(d)}),0<h.sockets.length&&
(c=b.connection(h.endpoint),c.received(function(a){a=b.telligent.evolution.url.parseQuery(a);D(a._s,a._m,a._d)}),c.error(function(a){d=b.signalR.connectionState.disconnected;c.stop()}),c.stateChanged(function(a){d=a.newState;d==b.signalR.connectionState.disconnected&&H(c)}),c.disconnected(function(){}),c.reconnected(function(){d=b.signalR.connectionState.connected}),c.start({transport:a,callback:function(){e||(e=!0,b.telligent.evolution.messaging.publish("socket.connected"));clearInterval(l);l=setInterval(function(){d==
b.signalR.connectionState.connected&&c.send("_KEEP_ALIVE")},6E4);r=0}})))};b.telligent=b.telligent||{};b.telligent.evolution=b.telligent.evolution||{};b.telligent.evolution.sockets=b.telligent.evolution.sockets||v})(jQuery,window);
(function(b,m){var h=[],g=/MSIE 6/i.test(navigator.userAgent)?"gif":"png",f=function(a,b){return 1==b%2?a.settings.imagesPathUrl+"star-right-on."+g:a.settings.imagesPathUrl+"star-left-on."+g},k=function(a,b){return 1==b%2?a.settings.imagesPathUrl+"star-right-off."+g:a.settings.imagesPathUrl+"star-left-off."+g},c=function(a,b){var c;for(c=0;c<h.length;c++)if(h[c].src==b)return!0;return!1},a=function(a,b,c){return"object"==typeof a.settings.titles?a.settings.titles[b].replace("{0}",c):a.settings.titles?
a.settings.titles.replace("{0}",c):c},d=function(a){return"undefined"!==typeof a.internal.value?a.internal.value:a.settings.value},e=function(a,c){var d,e=2*a.settings.maxRating;c=2*c-1;for(d=0;d<e;d++)d<=c?b(a.internal.state.find("img").get(d)).attr("src",f(a,d)):b(a.internal.state.find("img").get(d)).attr("src",k(a,d))},n=function(a,b){a.internal.isInitialized&&!a.settings.isReadOnly&&(a.internal.state.addClass(a.settings.overClass),e(a,b))},l=function(a,b){a.internal.isInitialized&&!a.settings.isReadOnly&&
(a.internal.state.removeClass(a.settings.overClass),e(a,b))},r=function(a){return this.each(function(){var d={settings:b.extend({},b.fn.evolutionStarRating.defaults,a||{}),internal:{state:b(this)}};d.settings.imagesPathUrl||(d.settings.imagesPathUrl=b.telligent.evolution.site.getBaseUrl()+"utility/images/");var e,l,g;for(g=0;2>g;g++)l=f(d,g),c(l)||(e=new Image,e.src=l,h[h.length]=e),l=k(d,g),c(l)||(e=new Image,e.src=l,h[h.length]=e);b(this).data("evolutionStarRating_context",d);H(d)})},H=function(c){c.internal.state.addClass(c.settings.starClass).css("white-space",
"nowrap").find("a").unbind(".evolutionStarRating").empty().end().bind("mouseleave",function(){e(c,d(c))});c.settings.isReadOnly&&c.internal.state.addClass(c.settings.readOnlyClass);var g,h=2*c.settings.maxRating,m="undefined"===typeof c.settings.ratingCount;for(g=0;g<h;g++)(function(){var d,e;e=b("<img />").css({borderLeftWidth:"0px",borderTopWidth:"0px",borderRightWidth:"0px",borderBottomWidth:"0px"});c.settings.isReadOnly||(d=b('<a href="#" />').css({textDecoration:"none"}).append(e));var h=(g+
1)/2;h<=c.settings.value?e.attr("src",f(c,g)):e.attr("src",k(c,g));if(!c.settings.isReadOnly){if(c.settings.useHalfStars)r=a(c,g,h);else var h=Math.ceil(h),r=a(c,h,h);m&&d.attr("title",r);e.attr("alt",r);d.data("rating-value",h).bind("click.evolutionStarRating",function(a){a=d.data("rating-value");c.internal.isInitialized&&!c.settings.isReadOnly&&(c.internal.value=a,c.settings.allowMultipleSelections||(c.settings.isReadOnly=!0),c.internal.savingValue=!0,c.settings.onRate(a));return!1}).bind("focus.evolutionStarRating",
function(a){n(c,d.data("rating-value"))}).bind("mouseover.evolutionStarRating",function(a){n(c,d.data("rating-value"))}).bind("blur.evolutionStarRating",function(a){l(c,d.data("rating-value"))}).bind("mouseout.evolutionStarRating",function(a){l(c,d.data("rating-value"))})}e.attr("align","absmiddle").attr("border",0);d?c.internal.state.append(d):c.internal.state.append(e)})();D(c);c.internal.isInitialized=!0},D=function(a){!a.settings.ratingMessageFormat||(isNaN(parseInt(a.settings.ratingCount))||
isNaN(parseInt(a.settings.value)))||a.internal.state.attr("title",a.settings.ratingMessageFormat.replace(/\{rating\}/gi,Math.round(10*a.settings.value)/10).replace(/\{count\}/gi,a.settings.ratingCount))},v={val:function(a){var b=this.data("evolutionStarRating_context");return null!==b?"undefined"!==typeof a?(b.internal.value=a,e(b,a),a):d(b):0},readOnly:function(a){var b=this.data("evolutionStarRating_context");if(null!==b)if("undefined"!==typeof a)(b.settings.isReadOnly=a)?b.internal.state.find("a").css({cursor:"default"}):
b.internal.state.find("a").css({cursor:"pointer"});else return b.settings.isReadOnly;return!0},option:function(a,c){if("object"===typeof a)return this.each(function(){var c=b(this).data("evolutionStarRating_context");null!=c&&(c.settings=b.extend({},c.settings,a),r.apply(b(this),[c.settings]))});if("undefined"!==typeof a&&"undefined"!==typeof c)return this.each(function(){var d=b(this).data("evolutionStarRating_context");null!=d&&(d.settings[a]=c,r.apply(b(this),[d.settings]))});if("undefined"!==
typeof a){var d=this.data("evolutionStarRating_context");return null!==d?d.settings[a]:null}}};b.fn.evolutionStarRating=function(a){if(a in v)return v[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.fn.evolutionStarRating");else return r.apply(this,arguments)};b.extend(b.fn.evolutionStarRating,{defaults:{value:0,maxRating:5,imagesPathUrl:"",useHalfStars:!1,starClass:"rating",overClass:"active",readOnlyClass:"readonly",
titles:"Terrible Poor Fair Average Good Excellent".split(" "),isReadOnly:!1,allowMultipleSelections:!0,ratingCount:m,ratingMessageFormat:"Average rating: {rating} out of {count} ratings.",onRate:function(a){}}})})(jQuery,void 0);
(function(b){var m={openTagSelector:function(){var a=this.data("evolutionTagTextBox");if(a){window.__tagEditor={SetSelectedTags:function(c){for(var d=[],f=g(a),k=a.settings.allTags,h,m=0;m<f.length;m++){h=!1;for(var v=0;v<k.length;v++)if(f[m].toUpperCase()==k[v].toUpperCase()){h=!0;break}h||(d[d.length]=f[m])}for(m=0;m<c.length;m++)d[d.length]=c[m];b(a.internal.state).val(d.join(", "))},GetAllTagsWithEncoding:function(){for(var c=[],d=a.settings.allTags,f=b("<div></div>"),g=0;g<d.length;g++)f.text(d[g]),
c[g]=[d[g],f.html()];return c},GetSelectedTags:function(){return g(a)}};var c=a.settings.selectTagsModalUrl;"~/"==c.substr(0,2)&&(c=b.telligent.evolution.site.getBaseUrl()+c.substr(2));window.Telligent_Modal?window.Telligent_Modal.Open(c,400,350,null):b.glowModal&&b.glowModal(c,{width:400,height:350})}}},h=function(a){return this.each(function(){var d={settings:b.extend({},b.fn.evolutionTagTextBox.defaults,a||{}),internal:{state:this,suggestionTimeoutHandle:null,previousTags:[],previousValue:"",currentTag:"",
currentTagPosition:0}};b(this).data("evolutionTagTextBox",d);c(d);b(this).bind("keyup.evolutionTagTextBox",function(a){return k(d,a)});b(this).bind("keydown.evolutionTagTextBox",function(a){return f(d,a)});b(this).bind("onblur.evolutionTagTextBox",function(a){window.clearTimeout(d.internal.suggestionTimeoutHandle);return!0})})},g=function(a){a=b(a.internal.state).val().split(/;|,/);for(var c=[],e=0;e<a.length;e++)a[e]=a[e].replace(/^\s+|\s+$/g,""),""!=a[e]&&(c[c.length]=a[e]);return c},f=function(a,
b){window.clearTimeout(a.internal.suggestionTimeoutHandle);b||(b=window.event);if(b){if(13==b.keyCode){a.internal.state.focus();if(document.selection){var c=window.document.selection.createRange();c.text&&0<c.text.length&&(c.moveStart("character",c.text.length),c.select())}else if(a.internal.state.selectionStart||"0"==a.internal.state.selectionStart)a.internal.state.selectionStart=a.internal.state.selectionEnd;b.cancelBubble=!0;return b.returnValue=!1}if(8==b.keyCode)if(a.internal.state.focus(),document.selection){if(c=
window.document.selection.createRange())return c.moveStart("character",-1),c.text="",b.cancelBubble=!0,b.returnValue=!1}else if(a.internal.state.selectionStart||"0"==a.internal.state.selectionStart){var c=a.internal.state.selectionStart,f=a.internal.state.selectionEnd;if(c==f)return!0;0<c&&c--;a.internal.state.value=a.internal.state.value.substring(0,c)+a.internal.state.value.substring(f);a.internal.state.selectionStart=c;a.internal.state.selectionEnd=c;b.cancelBubble=!0;return b.returnValue=!1}return!0}},
k=function(a,d){window.clearTimeout(a.internal.suggestionTimeoutHandle);a.internal.suggestionTimeoutHandle=window.setTimeout(function(){if((document.selection||a.internal.state.selectionStart||"0"==a.internal.state.selectionStart)&&b(a.internal.state).val()!=a.internal.previousValue&&(a.internal.previousValue=b(a.internal.state).val(),c(a),""!=a.internal.currentTag)){var d;b:{d=a.internal.currentTag;var f,g,k,h=a.settings.allTags;for(f=0;f<h.length;f++)if(0==h[f].toLowerCase().indexOf(d)){k=!1;for(g=
0;g<a.internal.previousTags.length&&!k;g++)a.internal.previousTags[g]==h[f].toLowerCase()&&(k=!0);if(!k){d=h[f];break b}}d=null}if(d&&d.length!=a.internal.currentTag.length)if(d=d.substr(a.internal.currentTag.length),b(a.internal.state).val(b(a.internal.state).val().substr(0,a.internal.currentTagPosition+a.internal.currentTag.length)+d+b(a.internal.state).val().substr(a.internal.currentTagPosition+a.internal.currentTag.length)),a.internal.state.focus(),document.selection)f=a.internal.state.createTextRange(),
f.select(),f.moveStart("character",a.internal.currentTagPosition+a.internal.currentTag.length),f.moveEnd("character",-(b(a.internal.state).val().length-(a.internal.currentTagPosition+a.internal.currentTag.length+d.length))),f.select();else if(a.internal.state.selectionStart||"0"==a.internal.state.selectionStart)a.internal.state.selectionStart=a.internal.currentTagPosition+a.internal.currentTag.length,a.internal.state.selectionEnd=a.internal.currentTagPosition+a.internal.currentTag.length+d.length}},
249);return!0},c=function(a){var c=b(a.internal.state).val().toLowerCase().split(/;|,/),e,f,g;a.internal.currentTag="";var k=0,h=!0;for(e=0;e<c.length;e++){f=c[e].replace(/^\s+/g,"");k+=c[e].length-f.length;c[e]=f;g=!1;for(f=0;f<a.internal.previousTags.length&&!g;f++)c[e]==a.internal.previousTags[f]&&(a.internal.previousTags.splice(f,1),g=!0);g||(""!=a.internal.currentTag?h=!1:(a.internal.currentTag=c[e],a.internal.currentTagPosition=k));k+=c[e].length+1}h||(a.internal.currentTag="");a.internal.previousTags=
c};b.fn.evolutionTagTextBox=function(a){if(a in m)return m[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.fn.evolutionTagTextBox");else return h.apply(this,arguments)};b.extend(b.fn.evolutionTagTextBox,{defaults:{allTags:[],selectTagsModalUrl:"~/utility/TagSelector.aspx?TagEditor=__tagEditor"}})})(jQuery);
(function(b){var m={},h={open:"<%",close:"%>"},g=function(f,c){var a=b.extend({},h,c||{}),d=RegExp("\\"+a.open+"=([\\s\\S]+?)"+a.close,"g"),e=RegExp("\\"+a.open+":([\\s\\S]+?)"+a.close,"g"),a=RegExp("\\"+a.open+"(.*?)"+a.close,"g"),d=" var source = [];  with(data){with(extraHelpers){with(defaultHelpers){  source.push('"+f.replace(/[\r\n]/g,"").replace(d,"'); source.push(String($1)); source.push('").replace(e,"'); source.push(escape(String($1))); source.push('").replace(a,"'); $1 source.push('")+"');  }}}  return source.join('');",
e=new Function("defaultHelpers","extraHelpers","data",d);e.compiledSource="function(defaultHelpers, extraHelpers, data) { "+d+" } ";return e},f={compile:function(b,c,a){var d=m[b];if("undefined"===typeof d){var e=null!==document.getElementById(b)?document.getElementById(b).innerHTML:b,h=g(e,a);m[b]=d=function(a){return h.call(this,f.helpers||{},c||{},a||{})};d.source={raw:e,compiled:h.compiledSource}}return d},helpers:{foreach:function(b,c){if(b&&0<b.length&&c)for(var a=0;a<b.length;a++)c(b[a],a)},
escape:function(b){var c=/&/g,a=/</g,d=/>/g,e=/\"/g;return function(b){return b.replace(c,"&amp;").replace(a,"&lt;").replace(d,"&gt;").replace(e,"&quot;")}}()}};b.telligent=b.telligent||{};b.telligent.evolution=b.telligent.evolution||{};b.telligent.evolution.template=f})(jQuery);
(function(b){var m={show:function(h){var g=b.extend({},m.defaults,h||{}),f=b('<div class="theater-mask"></div>').hide().appendTo("body"),k=b('<div class="theater-container"></div>').hide().appendTo("body");h=b('<div class="theater-content-container"></div>').appendTo(k);var c=b('<div class="theater-content"></div>').appendTo(h),a=b('<a href="#" class="theater-next">&rarr;</a>').appendTo(k),d=b('<a href="#" class="theater-back">&larr;</a>').appendTo(k),e=b('<a href="#" class="theater-close">X</a>').appendTo(h),
n=null,l=null,r=null,H=function(e,h){b("body").css({overflow:"hidden"});n=e;e(function(b){a.hide();d.hide();h?h(c,b):c.hide().html(b);f.is(":visible")||(f.show(),k.show());g.loaded(c);l=g.nextContent(c);r=g.previousContent(c);c.show();l&&null!==l&&a.show();r&&null!==r&&d.show()})},D=function(){b("body").css({overflow:"auto"});a.unbind("_evolution_theater");d.unbind("_evolution_theater");e.unbind("_evolution_theater");k.unbind("_evolution_theater");f.hide().remove();k.hide().remove();b(document).unbind("_evolution_theater")};
m.refresh=function(a){H(n,a)};m.hide=function(){D()};a.bind("click._evolution_theater",function(a){a.preventDefault();l&&null!==l&&H(l)});d.bind("click._evolution_theater",function(a){a.preventDefault();r&&null!==r&&H(r)});e.bind("click._evolution_theater",function(a){a.preventDefault();D()});k.bind("click._evolution_theater",function(a){a.target===k.get(0)&&D()});b(document).bind("keydown._evolution_theater",function(c){f.is(":visible")&&(39===c.which?b(c.target).is("input,textarea")||(l&&null!==
l&&H(l),a.addClass("pressed")):37===c.which?b(c.target).is("input,textarea")||(r&&null!==r&&H(r),d.addClass("pressed")):27===c.which&&D())});b(document).bind("keyup._evolution_theater",function(b){f.is(":visible")&&(39===b.which?a.removeClass("pressed"):37===b.which&&d.removeClass("pressed"))});H(g.content)},hide:function(){},refresh:function(){},defaults:{content:function(){return null},nextContent:function(){return null},previousContent:function(){return null},loaded:function(){}}};b.evolutionTheater=
m})(jQuery);
(function(b){var m={val:function(f){if(void 0===f){var k=this.data("evolutionToggleLink");return k?k.settings.val:!1}return this.each(function(){var c=b(this).data("evolutionToggleLink");c&&(c.settings.val=f,c.internal.processing=!1,g(c))})}},h=function(f){return this.each(function(){var k={settings:b.extend({},b.fn.evolutionToggleLink.defaults,f||{}),internal:{state:b(this),processing:!1}};k.internal.state.data("evolutionToggleLink",k).click(function(b){!k.internal.processing&&k.settings.changeState&&(k.internal.processing=
!0,g(k),k.settings.changeState(!k.settings.val));return!1});g(k)})},g=function(b){b.internal.processing?b.internal.state.attr("class",b.settings.processingCssClass).attr("title",b.settings.processingTitle).html(b.settings.processingHtml):b.settings.val?b.internal.state.attr("class",b.settings.onCssClass).attr("title",b.settings.onTitle).html(b.settings.onHtml):b.internal.state.attr("class",b.settings.offCssClass).attr("title",b.settings.offTitle).html(b.settings.offHtml)};b.fn.evolutionToggleLink=
function(f){if(f in m)return m[f].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof f&&f)b.error("Method "+f+" does not exist on jQuery.fn.evolutionToggleLink");else return h.apply(this,arguments)};b.extend(b.fn.evolutionToggleLink,{defaults:{onHtml:"",offHtml:"",processingHtml:"",changeState:null,onCssClass:"",offCssClass:"",processingCssClass:"",onTitle:"",offTitle:"",processingTitle:"",val:!1}})})(jQuery);
(function(b){var m=function(f){var g=b(this);g.off("mouseover mouseout");g=g.data("touch");g.start=g.current=f.originalEvent.touches[0].clientX},h=function(f){b(this).data("touch").current=f.originalEvent.touches[0].clientX},g=function(f){f=b(this);var g=f.data("touch");48<g.current-g.start&&f.triggerHandler("swiperight");g.start=0;g.current=0};b.event.special.swiperight={setup:function(){b(this).data("touch",{start:0,current:0}).bind("touchstart",m).bind("touchmove",h).bind("touchend",g)},teardown:function(){b(this).removeData("touch").unbind("touchstart",
m).unbind("touchmove",h).unbind("touchend",g)}}})(jQuery);
(function(b){var m={};parseData=function(h){h=h.get(0);var g={};b.each(h.attributes,function(f,k){if(0===k.name.indexOf("data-")){var c=k.name.substring(5);g[c]="configuration"===c?b.telligent.evolution.url.parseQuery(k.value):k.value}});return g};api={components:{},render:function(h){var g=b(h||document);b.each(api.components,function(f,k){var c=b(".ui-"+f,g);g.hasClass(".ui-"+f)&&c.add(g);c&&(0<c.length&&"undefined"!==typeof k.setup&&!m[f])&&(k.setup.call(this),m[f]=!0);c&&(0<c.length&&"undefined"!==
typeof k.add)&&c.each(function(){var a=b(this);a.data("_telligent_evolution_ui_render_add")||(k.add.call(a,a,api.data(a)),a.data("_telligent_evolution_ui_render_add",!0))})})},data:function(h){if(!h)return{};h=b(h);var g=h.data("_telligent_evolution_ui_data");if(null===g||"undefined"===typeof g)g=parseData(h),h.data("_telligent_evolution_ui_data",g);return g}};b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.ui=api})(jQuery);
(function(b){var m=function(b,g){return function(){try{g.before&&g.before.apply(this,arguments)}catch(f){}var k=b.apply(this,arguments);try{g.after&&g.after.apply(this,arguments)}catch(c){}return k}};b.each(["html","append","prepend"],function(h,g){b.fn[g]=m(b.fn[g],{after:function(){b.telligent.evolution.ui.render(this)}})});b.each(["appendTo","prependTo"],function(h,g){b.fn[g]=m(b.fn[g],{after:function(f){b.telligent.evolution.ui.render(b(f))}})});b.each(["after","before"],function(h,g){b.fn[g]=
m(b.fn[g],{after:function(){b.telligent.evolution.ui.render(this.parent())}})});b.each(["insertAfter","insertBefore"],function(h,g){b.fn[g]=m(b.fn[g],{after:function(f){b.telligent.evolution.ui.render(b(f).parent())}})})})(jQuery);jQuery(function(b){b.telligent.evolution.ui.render()});
(function(b){b.telligent.evolution.ui.components.bookmark={setup:function(){},add:function(m,h){var g={contentId:h.contentid,contentTypeId:h.contenttypeid,typeId:h.bookmarktypeid,initialState:"true"==h.value,contentTypeName:h.contenttypename,onBookmark:function(f,g,c,a){b.telligent.evolution.post({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/bookmark.json?ContentId={ContentId}&ContentTypeId={ContentTypeId}"+(c?"&TypeId="+c:""),data:{ContentId:f,ContentTypeId:g},dataType:"json",success:function(b){a()}})},
onUnbookmark:function(f,g,c,a){b.telligent.evolution.del({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/bookmark.json?ContentId={ContentId}"+(c?"&TypeId="+c:""),data:{ContentId:f},dataType:"json",success:function(b){a()}})}};h.configuration.deleteBookmarkText&&(g.deleteBookmarkText=h.configuration.deleteBookmarkText);h.configuration.addBookmarkText&&(g.addBookmarkText=h.configuration.addBookmarkText);h.configuration.processingText&&(g.processingText=h.configuration.processingText);h.configuration.addBookmarkCssClass&&
(g.addBookmarkCssClass=h.configuration.addBookmarkCssClass);h.configuration.deleteBookmarkCssClass&&(g.deleteBookmarkCssClass=h.configuration.deleteBookmarkCssClass);h.configuration.processingCssClass&&(g.processingCssClass=h.configuration.processingCssClass);b(m).evolutionBookmark(g)}}})(jQuery);
(function(b){b.telligent.evolution.ui.components.collapseexpand={setup:function(){},add:function(m,h){var g=b("<a></a>").attr({href:"#"}).text(h.collapsetext),f=!1;g.click(function(){f?(m.slideUp(),g.text(h.collapsetext)):(m.slideDown(),g.text(h.expandtext));f=!f;return!1});m.removeClass().before(g).hide()}}})(jQuery);
(function(b){var m=function(h,g,f,k){b.telligent.evolution.get({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:h,ContentTypeId:g,TypeId:f,SortBy:"Date",SortOrder:"Descending",PageSize:1,PageIndex:0},cache:!1,dataType:"json",success:function(b){k.call(this,{count:b.TotalCount,latestLike:0<b.Likes.length?b.Likes[0]:null})}})};b.telligent.evolution.ui.components.like={setup:function(){b.fn.evolutionLike.delegatePopups({containerSelector:".content-fragment",delegatedSelector:".ui-like",
onList:function(h,g,f,k,c,a){b.telligent.evolution.get({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:{ContentId:h,ContentTypeId:g,TypeId:f,SortBy:"Date",SortOrder:"Descending",PageSize:c||20,PageIndex:a||0},cache:!1,dataType:"json",success:function(a){k({likers:b.map(a.Likes,function(a){return{displayName:a.User.DisplayName,profileUrl:a.User.ProfileUrl,avatarUrl:a.User.AvatarUrl}}),hasMorePages:(a.PageIndex+1)*a.PageSize<a.TotalCount})}})},onOptions:function(h){h=b.telligent.evolution.ui.data(h);
return{contentId:h.contentid,contentTypeId:h.contenttypeid,typeId:h.configuration.LikeTypeId}},likersTemplate:' <% foreach(likers, function(liker) { %>      <li class="content-item">          <div class="full-post-header"></div>          <div class="full-post">              <span class="avatar">                  <a href="<%: liker.profileUrl %>"  class="internal-link view-user-profile">                      <img src="<%: liker.avatarUrl %>" alt="" border="0" width="32" height="32" style="width:32px;height:32px" />                  </a>              </span>              <span class="user-name">                  <a href="<%: liker.profileUrl %>" class="internal-link view-user-profile"><%= liker.displayName %></a>              </span>          </div>          <div class="full-post-footer"></div>      </li>  <% }); %> ',
likersPopupTemplate:' <div class="who-likes-list">      <div class="content-list-header"></div>      <ul class="content-list"><%= likers %></ul>      <div class="content-list-footer"></div>      <% if(hasMorePages) { %>          <a href="#" class="show-more"><%= showMoreText %></a>     <% } %>  </div> '})},add:function(h,g){var f="true"===g.readonly;b(h).evolutionLike({contentId:g.contentid,contentTypeId:g.contenttypeid,initialState:g.initialstate,initialMessage:g.initialmessage,initialCount:g.initialcount,
format:f?g.format.replace("{toggle}",""):g.format,typeId:g.configuration.LikeTypeId,onLike:function(f,c,a,d){var e={ContentId:f,ContentTypeId:c};null!==a&&0<a.length&&(e.TypeId=a);b.telligent.evolution.post({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/likes.json",data:e,cache:!1,dataType:"json",success:function(b){m(f,c,a,d)}})},onUnlike:function(f,c,a,d){var e={ContentId:f};null!==a&&0<a.length&&(e.TypeId=a);b.telligent.evolution.del({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/like.json",
data:e,cache:!1,dataType:"json",success:function(b){m(f,c,a,d)}})}})}}})(jQuery);
(function(b){var m=function(h,g,f){b.telligent.evolution.post({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/abusereports.json",data:{ContentId:h,ContentTypeId:g},cache:!1,dataType:"json",success:function(b){f(b)}})};b.telligent.evolution.ui.components.moderate={setup:function(){},add:function(h,g){h=b(h);var f={contentId:g.contentid,contentTypeId:g.contenttypeid,supportsAbuse:"true"===g.supportsabuse,initialState:"true"===g.initialstate,onReport:m};if(g.configuration&&g.configuration.AdditionalLinks){var k=
b.parseJSON(g.configuration.AdditionalLinks);if(!f.supportsAbuse&&0===k.length)return;f.onGetAdditionalLinks=function(b){b(k)}}else if(g.configuration&&g.configuration.AdditionalLinksUrl){if(!f.supportsAbuse&&0===g.configuration.AdditionalLinksUrl.length)return;f.onGetAdditionalLinks=function(c){b.telligent.evolution.get({url:g.configuration.AdditionalLinksUrl,cache:!1,dataType:"json",success:function(a){c(a.links||[])}})}}if(f.supportsAbuse||f.onGetAdditionalLinks)g.configuration&&g.configuration.LinkClassName&&
(f.linkClassName=g.configuration.LinkClassName),h.evolutionModerate(f)}}})(jQuery);
(function(b){var m={};b.telligent.evolution.ui.components.page={setup:function(){},add:function(h,g){var f={currentPage:parseInt(g.currentpage,10),pageSize:parseInt(g.pagesize,10),totalItems:parseInt(g.totalitems,10),showPrevious:"undefined"===typeof g.configuration.ShowPrevious?!1:"true"===g.configuration.ShowPrevious,showNext:"undefined"===typeof g.configuration.ShowNext?!1:"true"===g.configuration.ShowNext,showFirst:"undefined"===typeof g.configuration.ShowFirst?!0:"true"===g.configuration.ShowFirst,
showLast:"undefined"===typeof g.configuration.ShowLast?!0:"true"===g.configuration.ShowLast,showIndividualPages:"undefined"===typeof g.configuration.ShowIndividualPages?!0:"true"===g.configuration.ShowIndividualPages,numberOfPagesToDisplay:"undefined"===typeof g.configuration.NumberOfPagesToDisplay?5:parseInt(g.configuration.NumberOfPagesToDisplay,10),pageKey:g.pagekey,hash:g.configuration.Target,baseUrl:g.configuration.BaseUrl||window.location.href,template:"undefined"!==typeof g.configuration.Template?
g.configuration.Template:' <% foreach(links, function(link, i) { %>      <% if(link.type === "first") { %>          <a href="<%: link.url %>" class="first" data-type="first" data-page="<%= link.page %>" data-selected="false"><span>&#171;</span></a>      <% } else if(link.type === "previous") { %>          <a href="<%: link.url %>" class="previous" data-type="previous" data-page="<%= link.page %>" data-selected="false"><span>&#60;</span></a>      <% } else if(link.type === "page") { %>          <a href="<%: link.url %>" class="page<%= link.selected ? " selected" : "" %>" data-type="page" data-page="<%= link.page %>" data-selected="<%= link.selected ? "true" : "false" %>"><span><%= link.page %></span></a>      <% } else if(link.type === "next") { %>          <a href="<%: link.url %>" class="next" data-type="next" data-page="<%= link.page %>" data-selected="false"><span>&#62;</span></a>      <% } else if(link.type === "last") { %>          <a href="<%: link.url %>" class="last" data-type="last" data-page="<%= link.page %>" data-selected="false"><span>&#187;</span></a>      <% } %>      <% if(i < (links.length - 1)) { %>          <span class="separator"></span>      <% } %>  <% }); %> '};
g.pagedcontenturl&&(m[g.pagedcontentpagingevent]={onPage:function(f,c){var a={};a[g.pagekey]=f;a=b.telligent.evolution.url.modify({url:g.pagedcontenturl,query:a});b.telligent.evolution.get({url:a,cache:!1,success:function(a){c(a)}})}},b.extend(f,{onPage:function(b,c){m[g.pagedcontentpagingevent].onPage(b,c)},pagedContentContainer:"#"+g.pagedcontentwrapperid,pagedContentPagingEvent:g.pagedcontentpagingevent,pagedContentPagedEvent:g.pagedcontentpagedevent,transition:g.configuration.Transition,transitionDuration:"undefined"===
typeof g.configuration.TransitionDuration?200:parseInt(g.configuration.TransitionDuration,10)}));b(h).evolutionPager(f)}}})(jQuery);
(function(b){b.telligent.evolution.ui.components.rate={setup:function(){},add:function(m,h){var g=b.extend({},{isReadOnly:"true"===h.readonly,value:parseFloat(h.initialvalue),ratingCount:parseFloat(h.initialcount)});g.value*=b.fn.evolutionStarRating.defaults.maxRating;g.onRate=function(f){h.contentid&&h.contenttypeid&&(f/=b.fn.evolutionStarRating.defaults.maxRating,f={ContentId:h.contentid,ContentTypeId:h.contenttypeid,Value:f},h.ratingtypeid&&(f.TypeId=h.ratingtypeid),b.telligent.evolution.post({url:b.telligent.evolution.site.getBaseUrl()+
"api.ashx/v2/ratings.json",data:f,success:function(f){f={ContentId:h.contentid};h.ratingtypeid&&(f.TypeId=h.ratingtypeid);b.telligent.evolution.get({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/rateditem.json",data:f,success:function(c){c&&c.RatedItem&&c.RatedItem.AverageValue?b(m).evolutionStarRating("option",{value:c.RatedItem.AverageValue*b.fn.evolutionStarRating.defaults.maxRating,ratingCount:c.RatedItem.Count}):b(m).evolutionStarRating("option",{value:0,ratingCount:0})}})}}))};0==
g.ratingCount&&g.isReadOnly||b(m).evolutionStarRating(g)}}})(jQuery);
(function(b){var m=b.telligent.evolution.template.compile('<% foreach(properties, function(property) { %> <li class="property-item"><%= property %></li> <% }); %> '),h=function(g,f){b.telligent.evolution.get({url:g,dataType:"json",success:function(b){b&&f(m(b))}})};b.telligent.evolution.ui.components.searchresult={setup:function(){},add:function(b,f){if(f.detailsurl){var k=null,c=b.find("ul.details"),a=c.html();b.bind("mouseenter",function(a){null!==k?c.html(k):h(f.detailsurl,function(a){k=a;c.html(k)})}).bind("mouseleave",
function(b){c.html(a)})}}}})(jQuery);
(function(b){var m=function(h,g,f){var k=b(f);k.html("");if(h){var c=!0;b.each(h.split(/,/),function(a,d){var e=b.trim(d);e&&(c?c=!1:k.append(", "),g?k.append(b("<a>").attr("rel","nofollow tag").attr("href",g.replace(/{tag}/g,b.telligent.evolution.url.encodePathComponent(b.telligent.evolution.html.decode(e)))).text(e)):k.append(e))})}};b.telligent.evolution.ui.components.tag={setup:function(){},add:function(h,g){var f=jQuery("<span></span>");b(h).append(f);m(g.tags,g.urlformat,f);var k=null;"true"!==
g.readonly&&(k=b('<a href="javascript:void(0);" class="internal-link edit-tags"></a>'),b(h).append(k),k.evolutionInlineTagEditor({allTags:b.grep(g.selectabletags.split(","),function(b){return b}),currentTags:b.grep(g.tags.split(","),function(b){return b}),onSave:function(c,a){var d={Tags:c&&0<c.length?c.join(","):"",ContentId:g.contentid,ContentTypeId:g.contenttypeid};g.tagtypeid&&(d.TypeId=g.tagtypeid);b.telligent.evolution.put({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/contenttags.json",
data:d,success:function(b){m(d.Tags,g.urlformat,f);a()}})}}))}}})(jQuery);
(function(b){var m=function(){return{add:function(a,c,e,f,g,k){a={ContentId:a,ContentTypeId:c,Body:f};"undefined"!==typeof e&&null!==e&&(a.CommentTypeId=e);b.telligent.evolution.post({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/comments.json",data:a,cache:!1,success:g,error:k})},del:function(a,c,e){b.telligent.evolution.del({url:b.telligent.evolution.site.getBaseUrl()+"api.ashx/v2/comments/{CommentId}.json",data:{CommentId:a},cache:!1,success:c,error:e})}}}(),h=function(a,c){b.telligent.evolution.get({url:a,
cache:!1,success:function(a){c(a)}})},g=function(a){var c=a.content.find(".content-item.action.likes");b.telligent.evolution.messaging.subscribe("ui.like",function(b){if(b.contentId!==a.contentId||"undefined"!==typeof a.typeId&&(""!==a.typeId&&"00000000-0000-0000-0000-000000000000"!==a.typeId)&&b.typeId!==a.typeId){var f=a.content.find('li.comment[data-commentid="'+b.contentId+'"][data-contenttypeid="'+b.contentTypeId+'"]');0<b.count?f.addClass("with-likes"):f.removeClass("with-likes")}else 0<b.count?
c.removeClass("without-likes").addClass("with-likes"):c.removeClass("with-likes").addClass("without-likes")})},f=function(a){a.content.find(".internal-link.comment").bind("click",function(b){b.preventDefault();a.content.find(".comment-form").show().find("textarea").focus()});a.content.off("focus",".comment-form textarea").on("focus",".comment-form textarea",function(c){a.content.find(".comment-form").addClass("with-avatar");c=b(c.target);c.data("theater_composer_inited")||(c.data("theater_composer_inited",
!0),c.evolutionComposer({plugins:["mentions","hashtags"]}),c.evolutionComposer("onkeydown",function(c){13===c.which&&(c=b(c.target).evolutionComposer("val"),0<b.trim(c).length&&(a.content.find(".comment-form textarea").attr("disabled",!0).blur(),m.add(a.contentId,a.contentTypeId,a.typeId,c,function(a){b.evolutionTheater.refresh(k);b.telligent.evolution.messaging.publish("activity.commentadded",a)},function(b){a.content.find(".comment-form textarea").evolutionComposer("val","").trigger("keydown").trigger("keyup").removeAttr("disabled").closest(".comment-form").removeClass("with-avatar")})));
return!0}))});a.content.delegate(".comment-form textarea","blur",function(b){a.content.find(".comment-form").removeClass("with-avatar")})},k=function(a,c){var e=b("<div></div>").html(c).find("ul.content-list.comments");a.find("ul.content-list.comments").replaceWith(e)},c=function(a){a.content.find(".content-item.comment").bind("evolutionModerateLinkClicked",function(a,c){var f=b(this).data("commentid");m.del(f,function(a){b.evolutionTheater.refresh(k);b.telligent.evolution.messaging.publish("activity.commentremoved",
a)},function(a){})})};b.telligent.evolution.ui.components.theater={setup:function(){},add:function(a,d){a=b(a);a.bind("click",function(a){a.preventDefault();b.evolutionTheater.show({content:function(a){h(d.theaterurl,a)},nextContent:function(a){var b=a.find("a[data-nexttheaterurl]").data("nexttheaterurl");if(b&&0<b.length)return function(a){h(b,a)}},previousContent:function(a){var b=a.find("a[data-previoustheaterurl]").data("previoustheaterurl");if(b&&0<b.length)return function(a){h(b,a)}},loaded:function(a){var d;
d=b(a);a=d.find(".activity-story");d={content:d,story:a};null!==a&&b.extend(d,{contentId:a.data("contentid"),contentTypeId:a.data("contenttypeid"),typeId:a.data("typeid")});g(d);f(d);c(d)}})})}}})(jQuery);
(function(b){b.telligent.evolution.ui.components.webpreview={setup:function(){},add:function(m,h){var g=h.configuration.url,f,k;"undefined"!==typeof h.configuration.maximagewidth&&(f=h.configuration.maximagewidth);"undefined"!==typeof h.configuration.maximageheight&&(k=h.configuration.maximageheight);b.telligent.evolution.preview.load(g,{maxImageWidth:f,maxImageHeight:k,success:function(c){c&&(c=b.telligent.evolution.preview.render(c,{template:b.telligent.evolution.preview.defaults.template}),"undefined"!==
typeof c&&(null!==c&&0<c.length)&&m.replaceWith(c))}})}}})(jQuery);
(function(b,m){var h=function(b,c,a,d,e){if(!b)return b;var f=/(?:\.config|\.ascx|\.asax|\.cs|\.vb)$/i.test(b);return b.replace(c,function(c,g,h){if(" "==c)return a;if("."!=c||f||h==b.length-1||"."==b.substr(h+1,1)){g=[];g[g.length]=e;for(h=0;h<c.length;h++){var m=c.charCodeAt(h).toString(16)+"",v=m.length;4==v?(g.push(m.substr(2,2).toUpperCase()),g.push(m.substr(0,2).toUpperCase())):3==v?(g.push(m.substr(1,2).toUpperCase()),g.push("0"),g.push(m.substr(0,1).toUpperCase())):2==v&&(g.push(m.toUpperCase()),
g.push("00"))}g[g.length]=e;return g.join("")}return d})},g=function(b,c,a,d){return b?b.replace(c,function(b,c,f){if(1==b.length){if(b==a)return" ";if(b==d)return"."}else{b=b.substr(1,b.length-2);if(0!=b.length%4)return"";c=[];for(f=0;f<b.length;f+=4)c[c.length]=String.fromCharCode(parseInt(b.substr(f+2,2)+b.substr(f,2),16));return c.join("")}}):b},f={parseQuery:function(f){var c=f.split("?"),a={};f=(1<c.length?c[1]:f).split("#")[0].split("&");b.each(f,function(b,c){c=c.split("=");2===c.length&&
(a[c[0]]=decodeURIComponent(c[1].replace(/\+/gi," ")))});return a},serializeQuery:function(f){f=f||{};var c=[];b.each(f,function(a,b){c[c.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)});return c.join("&")},modify:function(g){g=b.extend({url:m.location.href,query:null,hash:m.location.hash,protocol:m.location.protocol},g);var c=[g.url.split("?")[0].split("#")[0]],a;"string"===typeof g.query&&(g.query=f.parseQuery(g.query));(a=f.serializeQuery(b.extend(f.parseQuery(g.url),g.query)))&&0<a.length&&
(c[c.length]="?"+a);g.hash&&0<g.hash.length&&(c[c.length]=(0!==g.hash.indexOf("#")?"#":"")+g.hash);return c.join("")},hashData:function(g,c){if("undefined"===typeof g){g={};var a=m.location.href.split("#"),d="";2<a.length&&(b.each(a,function(a,b){0<a&&(1<a&&(d+="#"),d+=b)}),a=[a[0],d]);2===a.length&&(g=f.parseQuery(a[1]));return g}c||(g=b.extend(f.hashData(),g));m.location.href=m.location.href.split("#")[0]+"#"+f.serializeQuery(g)},encode:function(b){return encodeURIComponent(b)},decode:function(b){return decodeURIComponent(b)},
encodePathComponent:function(b){return h(b,/([^A-Za-z0-9 \.]+|\.| )/g,"+","-","_")},decodePathComponent:function(b){return g(b,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|\-|\+)/ig,"+","-")},encodeFileComponent:function(b){return h(b,/([^A-Za-z0-9 \.]+|\.| )/g,"-",".","_")},decodeFileComponent:function(b){return g(b,/((?:_(?:[0-9a-f][0-9a-f][0-9a-f][0-9a-f])+_)|_|\-)/ig,"-",".")}};b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.url=f})(jQuery,
window);
(function(b){var m={},h=function(f){return this.each(function(){var c={settings:b.extend({},b.fn.evolutionUserFileTextBox.defaults,f||{}),internal:{state:this,preview:null,select:null,remove:null}},a=b("<div></div>").attr("class",c.settings.cssClass);c.internal.preview=b("<div></div>").attr("class",c.settings.previewCssClass);a.append(c.internal.preview);c.internal.select=b('<input type="button" />').val(c.settings.selectText).click(function(){g(c);return!1});a.append(c.internal.select);c.internal.remove=b('<input type="button" />').val(c.settings.removeText).click(function(){c.internal.preview.html(c.settings.noFileText);
b(c.internal.state).val("");return!1});a.append(c.internal.remove);b(this).val()?c.internal.preview.html(c.settings.initialPreviewHtml):c.internal.preview.html(c.settings.noFileText);b(this).data("evolutionUserFileTextBox",c).before(a).hide()})},g=function(g){var c=g.settings.userFilesBrowseModalUrl;"~/"==c.substr(0,2)&&(c=b.telligent.evolution.site.getBaseUrl()+c.substr(2));window.Telligent_Modal?window.Telligent_Modal.Open(c,620,450,function(a){f(g,a)}):b.glowModal&&b.glowModal(c,{width:620,height:450,
onClose:function(a){f(g,a)}})},f=function(f,c){c&&(3==c.length&&c[0]&&c[1])&&(f.internal.preview.html(c[2]),b(f.internal.state).val(c[1]))};b.fn.evolutionUserFileTextBox=function(f){if(f in m)return m[f].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof f&&f)b.error("Method "+f+" does not exist on jQuery.fn.evolutionUserFileTextBox");else return h.apply(this,arguments)};b.extend(b.fn.evolutionUserFileTextBox,{defaults:{removeText:"",selectText:"",noFileText:"",initialPreviewHtml:"",
cssClass:"user-file-url",previewCssClass:"user-file-url-preview",userFilesBrowseModalUrl:"~/utility/userfilesbrowse.aspx"}})})(jQuery);
(function(b,m){b.telligent||(b.telligent={});b.telligent.evolution||(b.telligent.evolution={});b.telligent.evolution.validation={registerExtensions:function(h){b.validator&&(b.validator.addMethod("passwordvalid",function(b,f){return this.optional(f)||b.match(h.passwordRegex)},h.passwordInvalidMessage),b.validator.addMethod("email",function(b,f){return this.optional(f)||b.match(RegExp(h.emailRegex))},h.emailInvalidMessage),b.validator.addMethod("url",function(g,f){return this.optional(f)||g.match(h.urlRegex)?
!0:("http://"+g).match(h.urlRegex)?(b(f).val("http://"+g),!0):!1},h.urlInvalidMessage),b.validator.addMethod("emails",function(b,f){for(var k=b.split(/[;,]/),c=!0,a=RegExp(h.emailRegex),d=0;d<k.length;d++)jQuery.trim(k[d]).match(a)||(c=!1);return this.optional(f)||c},h.emailsInvalidMessage),b.validator.addMethod("username",function(b,f){return this.optional(f)||b.match(h.usernameRegex)},h.usernameInvalidMessage),b.validator.addMethod("usernameexists",function(g,f,h){if(this.optional(f))return"dependency-mismatch";
var c=this.previousValue(f);this.settings.messages[f.name]||(this.settings.messages[f.name]={});c.originalMessage=this.settings.messages[f.name].remote;this.settings.messages[f.name].remote=c.message;h="string"==typeof h&&{url:h}||h;var a=b.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsUsernameAvailable";h.url&&(a=h.url);if(c.old!==g){c.old=g;var d=this;this.startRequest(f);var e='{"username":"'+g+'","elementName":"'+f.name+'"}';b.telligent.evolution.post({url:a,
dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(a){f=d.findByName(a.d.ElementName)[0];d.settings.messages[f.name].remote=c.originalMessage;var l=!0===a.d.IsValid;if(l){var h=d.formSubmitted;d.prepareElement(f);d.formSubmitted=h;d.successList.push(f);d.showErrors()}else h={},a=c.message=a.d.ErrorMessage||d.defaultMessage(f,"usernameexists"),h[f.name]=b.isFunction(a)?e(g):a,d.showErrors(h);c.valid=l;d.stopRequest(f,l)}});return"pending"}return this.pending[f.name]?
"pending":c.valid},void 0),b.validator.addMethod("emailexists",function(g,f,h){if(this.optional(f))return"dependency-mismatch";var c=this.previousValue(f);this.settings.messages[f.name]||(this.settings.messages[f.name]={});c.originalMessage=this.settings.messages[f.name].remote;this.settings.messages[f.name].remote=c.message;h="string"==typeof h&&{url:h}||h;var a=b.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsEmailAvailable";h.url&&(a=h.url);if(c.old!==g){c.old=
g;var d=this;this.startRequest(f);var e='{"email":"'+g+'","elementName":"'+f.name+'"}';b.telligent.evolution.post({url:a,dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(a){f=d.findByName(a.d.ElementName)[0];d.settings.messages[f.name].remote=c.originalMessage;var l=!0===a.d.IsValid;if(l){var h=d.formSubmitted;d.prepareElement(f);d.formSubmitted=h;d.successList.push(f);d.showErrors()}else h={},a=c.message=a.d.ErrorMessage||d.defaultMessage(f,"emailexists"),h[f.name]=
b.isFunction(a)?e(g):a,d.showErrors(h);c.valid=l;d.stopRequest(f,l)}});return"pending"}return this.pending[f.name]?"pending":c.valid},void 0),b.validator.addMethod("groupnameexists",function(g,f,h){if(this.optional(f))return"dependency-mismatch";var c=encodeURIComponent(b.trim(g));if(0==c.length)return!0;var a=this.previousValue(f);this.settings.messages[f.name]||(this.settings.messages[f.name]={});a.originalMessage=this.settings.messages[f.name].remote;this.settings.messages[f.name].remote=a.message;
h=h.getParentId();c='{"groupName":"'+c+'","parentGroupId":'+h+',"elementName":"'+f.name+'"}';if(a.old!==c){a.old=c;var d=this;this.startRequest(f);h=b.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsGroupNameAvailable";b.telligent.evolution.post({url:h,dataType:"json",contentType:"application/json; charset=utf-8",data:c,success:function(c){f=d.findByName(c.d.ElementName)[0];d.settings.messages[f.name].remote=a.originalMessage;var h=!0===c.d.IsValid;if(h){var l=d.formSubmitted;
d.prepareElement(f);d.formSubmitted=l;d.successList.push(f);d.showErrors()}else l={},c=a.message=c.d.ErrorMessage||d.defaultMessage(f,"groupnameexists"),l[f.name]=b.isFunction(c)?message(g):c,d.showErrors(l);a.valid=h;d.stopRequest(f,h)}});return"pending"}return this.pending[f.name]?"pending":a.valid},void 0),b.validator.addMethod("wikipageexists",function(g,f,h){if(this.optional(f))return"dependency-mismatch";var c=encodeURIComponent(b.trim(g));if(0==c.length)return!0;var a=this.previousValue(f);
this.settings.messages[f.name]||(this.settings.messages[f.name]={});a.originalMessage=this.settings.messages[f.name].remote;this.settings.messages[f.name].remote=a.message;h='{"pageName":"'+c+'","wikiId":'+h.wikiId+',"pageId":'+h.pageId+',"parentPageId":'+h.parentPageId()+',"elementName":"'+f.name+'"}';if(a.old!==h){a.old=h;var d=this;this.startRequest(f);c=b.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsWikiPageNameAvailable";b.telligent.evolution.post({url:c,dataType:"json",
contentType:"application/json; charset=utf-8",data:h,success:function(c){f=d.findByName(c.d.ElementName)[0];d.settings.messages[f.name].remote=a.originalMessage;var h=!0===c.d.IsValid;if(h){var l=d.formSubmitted;d.prepareElement(f);d.formSubmitted=l;d.successList.push(f);d.showErrors()}else l={},c=a.message=c.d.ErrorMessage||d.defaultMessage(f,"wikipageexists"),l[f.name]=b.isFunction(c)?message(g):c,d.showErrors(l);a.valid=h;d.stopRequest(f,h)}});return"pending"}return this.pending[f.name]?"pending":
a.valid},void 0),b.validator.addMethod("mailinglistnameexists",function(g,f,h){if(""==b.trim(g))return this.optional(f);var c=this.previousValue(f);this.settings.messages[f.name]||(this.settings.messages[f.name]={});c.originalMessage=this.settings.messages[f.name].remote;this.settings.messages[f.name].remote=c.message;h="string"==typeof h&&{url:h}||h;var a=b.telligent.evolution.site.getBaseUrl()+"Utility/Validation/Core_Validator.asmx/IsMailingListNameAvailable";h.url&&(a=h.url);if(c.old!==g){c.old=
g;var d=this;this.startRequest(f);var e='{"mailingListName":"'+g+'","elementName":"'+f.name+'"}';b.telligent.evolution.post({url:a,dataType:"json",contentType:"application/json; charset=utf-8",data:e,success:function(a){f=d.findByName(a.d.ElementName)[0];d.settings.messages[f.name].remote=c.originalMessage;var l=!0===a.d.IsValid;if(l){var h=d.formSubmitted;d.prepareElement(f);d.formSubmitted=h;d.successList.push(f);d.showErrors()}else h={},a=c.message=a.d.ErrorMessage||d.defaultMessage(f,"mailinglistnameexists"),
h[f.name]=b.isFunction(a)?e(g):a,d.showErrors(h);c.valid=l;d.stopRequest(f,l)}});return"pending"}return this.pending[f.name]?"pending":c.valid},void 0))}}})(jQuery,window);
(function(b){var m={addField:function(a,c,d,e){var f=this.data("evolutionValidation");if("undefined"!==typeof f){f.internal.fields[f.internal.fields.length]={selector:a,messageSelector:d,isValid:!0,context:e,initialized:!1};a=b(a);a.data("_evolutionValidation",f).data("_evolutionValidationFieldIndex",f.internal.fields.length-1).data("_evolutionValidationOldValue","$$$$$NULL$$$$$").rules("add",c);try{a.keydown(function(){if(f.internal.hasAttemptedSubmit){window.clearTimeout(f.internal.keyPressValidationHandle);
var a=this;f.internal.keyPressValidationHandle=window.setTimeout(function(){k(f,b(a))},499)}})}catch(g){}a.blur(function(){k(f,b(this))})}return this},addCustomValidation:function(b,c,d,e,f){var g=this.data("evolutionValidation");if("undefined"!==typeof g){var h=g.internal.customValidations.length;g.internal.customValidations[h]={id:b,validationFunction:c,message:d,messageSelector:e,isValid:!0,context:f,initialized:!1};return function(){return a(g,h)}}},isValid:function(){for(var c=this.data("evolutionValidation"),
d=0;d<c.internal.fields.length;d++)c.internal.fields[d].initialized||k(c,b(c.internal.fields[d].selector));for(d=0;d<c.internal.customValidations.length;d++)c.internal.customValidations[d].initialized||a(c,d);return f(c)},validate:function(){for(var c=this.data("evolutionValidation"),d=0;d<c.internal.fields.length;d++)k(c,b(c.internal.fields[d].selector));for(d=0;d<c.internal.customValidations.length;d++)a(c,d);return m.isValid.apply(b(c.internal.state),[])},validateField:function(a){try{var c=this.data("evolutionValidation");
b(a).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");return k(c,b(a))}catch(d){}},validateCustom:function(b){for(var c=this.data("evolutionValidation"),d=0;d<c.internal.customValidations.length;d++)if(c.internal.customValidations[d].id==b)return a(c,d);return!0},reset:function(){for(var a=this.data("evolutionValidation"),c=0;c<a.internal.customValidations.length;c++)b(a.internal.customValidations[c].messageSelector).hide(),a.internal.customValidations[c].isValid=!0,a.internal.customValidations[c].initialized=
!1;for(c=0;c<a.internal.fields.length;c++)b(a.internal.fields[c].messageSelector).hide(),a.internal.fields[c].errorMessage=null,a.internal.fields[c].isValid=!0,a.internal.fields[c].initialized=!1,b(a.internal.fields[c].selector).data("_evolutionValidationOldValue","$$$$$NULL$$$$$");a.internal.submitButtonClicked=!1;a.internal.hasAttemptedSubmit=!1;window.clearTimeout(a.internal.initialValidationHandle);a.internal.initialValidationHandle=window.setTimeout(function(){g(a)},249)}},h=function(a){return this.each(function(){var c=
{settings:b.extend({},b.fn.evolutionValidation.defaults,a||{}),internal:{state:this,submitButtonClicked:!1,hasAttemptedSubmit:!1,fields:[],customValidations:[],initialValidationHandle:null}};b(this).data("evolutionValidation",c);b(this).click(function(a){return d(c,a)});this._isValid=function(){return d(c,{})};window.clearTimeout(c.internal.initialValidationHandle);c.internal.initialValidationHandle=window.setTimeout(function(){g(c)},499)})},g=function(a){window.clearTimeout(a.internal.initialValidationHandle);
try{var d=!1;if(!0===a.settings.validateOnLoad)d=!0;else if(!1!==a.settings.validateOnLoad)for(var f=0;f<a.internal.fields.length;f++){var h=b(a.internal.fields[f].selector),k=h.attr("type");if("checkbox"!=k&&"radio"!=k&&"select"!=k&&"submit"!=k&&"button"!=k&&"reset"!=k&&""!=c(a,h)){d=!0;break}}if(d){a.internal.hasAttemptedSubmit=!0;var v=m.validate.apply(b(a.internal.state));e(a);if(a.settings.onValidated)a.settings.onValidated(v,!1,null)}else if(!a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!0,
!1,null)}catch(s){a.internal.initialValidationHandle=window.setTimeout(function(){g(a)},499)}},f=function(a){for(var b=0;b<a.internal.fields.length;b++)if(!a.internal.fields[b].isValid)return!1;for(b=0;b<a.internal.customValidations.length;b++)if(!a.internal.customValidations[b].isValid)return!1;return!0},k=function(a,b){var d=c(a,b);if(d!=b.data("_evolutionValidationOldValue"))return b.data("_evolutionValidationOldValue",d),b.valid();d=b.data("_evolutionValidationFieldIndex");return 0>d||d>=a.internal.fields.length?
!1:a.internal.fields[d].isValid},c=function(a,b){return"checkbox"==b.attr("type")||"radio"==b.attr("type")?b.get(0).checked?b.val():"":b.val()},a=function(a,c){if(0>c||c>=a.internal.customValidations.length)return!0;var d=a.internal.customValidations[c].validationFunction();a.internal.customValidations[c].initialized=!0;if(!0===d){a.internal.customValidations[c].isValid=!0;b(a.internal.customValidations[c].messageSelector).hide();if(f(a)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!0,
a.internal.submitButtonClicked,a.internal.customValidations[c].context);return!0}d=f(a);a.internal.customValidations[c].isValid=!1;a.internal.hasAttemptedSubmit&&b(a.internal.customValidations[c].messageSelector).html(a.internal.customValidations[c].message).show();if((a.internal.submitButtonClicked||d)&&a.internal.hasAttemptedSubmit&&a.settings.onValidated)a.settings.onValidated(!1,a.internal.submitButtonClicked,a.internal.customValidations[c].context);return!1},d=function(a,c){var d=!a.internal.hasAttemptedSubmit;
a.internal.hasAttemptedSubmit=!0;a.internal.submitButtonClicked=!0;m.validate.apply(b(a.internal.state),[]);var f=m.isValid.apply(b(a.internal.state),[]);d&&!f&&e(a);d=!0;f&&a.settings.onSuccessfulClick&&(d=a.settings.onSuccessfulClick(c));a.internal.submitButtonClicked=!1;!f&&c&&(c.cancelBubble=!0,c.returnValue=!1);return f&&!1!==d},e=function(a){for(var c=0;c<a.internal.fields.length;c++)a.internal.fields[c].isValid||null==a.internal.fields[c].errorMessage||(b(a.internal.fields[c].messageSelector).html(a.internal.fields[c].errorMessage).show(),
a.internal.fields[c].errorMessage=null);for(c=0;c<a.internal.customValidations.length;c++)a.internal.customValidations[c].isValid||b(a.internal.customValidations[c].messageSelector).html(a.internal.customValidations[c].message).show()};b.fn.evolutionValidation=function(a){if(a in m)return m[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.fn.evolutionValidation");else return h.apply(this,arguments)};b.extend(b.fn.evolutionValidation,
{defaults:{validateOnLoad:null,onValidated:null,onSuccessfulClick:null}});b(document).ready(function(){b("form").validate({errorPlacement:function(a,c){var d=b(c).data("_evolutionValidation");if(d){var e=parseInt(b(c).data("_evolutionValidationFieldIndex"),10);0>e||e>=d.internal.fields.length||(d.internal.hasAttemptedSubmit?b(d.internal.fields[e].messageSelector).html(a).show():d.internal.fields[e].errorMessage=a)}},highlight:function(a,c,d){if(c=b(a).data("_evolutionValidation"))if(d=f(c),a=b(a).data("_evolutionValidationFieldIndex"),
!(0>a||a>=c.internal.fields.length)&&(c.internal.fields[a].isValid=!1,c.internal.fields[a].initialized=!0,(c.internal.submitButtonClicked||d)&&c.internal.hasAttemptedSubmit&&c.settings.onValidated))c.settings.onValidated(!1,c.internal.submitButtonClicked,c.internal.fields[a].context)},unhighlight:function(a,c,d){if(c=b(a).data("_evolutionValidation"))if(a=b(a).data("_evolutionValidationFieldIndex"),!(0>a||a>=c.internal.fields.length)&&(c.internal.fields[a].isValid=!0,c.internal.fields[a].initialized=
!0,f(c)&&c.internal.hasAttemptedSubmit&&c.settings.onValidated))c.settings.onValidated(!0,c.internal.submitButtonClicked,c.internal.fields[a].context)},onsubmit:!1,onkeyup:!1,onfocusout:!1})})})(jQuery);function Telligent_Validation(b,m){this._jq=$(b);m.onValidatedFunction&&(m.onValidated=m.onValidatedFunction);m.onSuccessfulClickFunction&&(m.onSuccessfulClick=m.onSuccessfulClickFunction);this._jq.evolutionValidation(m)}
Telligent_Validation.prototype.AddField=function(b,m,h,g){this._jq.evolutionValidation("addField",b,m,h,g)};Telligent_Validation.prototype.AddCustomValidation=function(b,m,h,g,f){return this._jq.evolutionValidation("addCustomValidation",b,m,h,g,f)};Telligent_Validation.prototype.IsValid=function(){return this._jq.evolutionValidation("isValid")};Telligent_Validation.prototype.Validate=function(){return this._jq.evolutionValidation("validate")};
Telligent_Validation.prototype.ValidateField=function(b){return this._jq.evolutionValidation("validateField",b)};Telligent_Validation.prototype.ValidateCustom=function(b){return this._jq.evolutionValidation("validateCustom",b)};
